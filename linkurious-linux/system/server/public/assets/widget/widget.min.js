"use strict";var LK=Object.create(null);(function(a){function b(a,b){var c=document.createElement("p");c.className="autocomplete_dropdown_item btn",c.tabIndex=b,"nodes"===LK.searchType?(c.appendChild(document.createTextNode("Show edges")),c.onclick=function(){LK.search("edges")},c.addEventListener("keydown",function(a){switch(a.which){case 13:LK.search("edges"),LK.dom.$("result-list__dropdown").firstChild.focus();break;case 38:this.previousSibling?this.previousSibling.focus():this.parentNode.lastChild.focus();break;case 40:case 9:this.parentNode.firstChild.focus();break;default:LK.dom.$("result-list__input").focus()}a.preventDefault(),9!=a.which&&a.stopPropagation()})):(c.appendChild(document.createTextNode("Show nodes")),c.onclick=function(){LK.search("nodes")},c.addEventListener("keydown",function(a){switch(a.which){case 13:LK.search("nodes"),LK.dom.$("result-list__dropdown").firstChild.focus();break;case 38:this.previousSibling?this.previousSibling.focus():this.parentNode.lastChild.focus();break;case 40:case 9:this.parentNode.firstChild.focus();break;default:LK.dom.$("result-list__input").focus()}a.preventDefault(),9!=a.which&&a.stopPropagation()})),a.appendChild(c)}function c(){function a(){n.refresh({skipIndexation:!0}),r.draw()}var b=!1;n.renderers[0].bind("render",function(){b||(b=!0,setTimeout(a,1300),setTimeout(a,2e3))})}function d(a,b,c){var b=b||"",c=c||"",d='<iframe src="'+a+'" width="100%" height="330" frameborder="0"  webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe><p><a href="'+a+'" target="_blank">'+b+'</a> on <a href="https://linkurio.us" target="_blank">Linkurious</a>.</p>';return c.length&&(d+="<p>"+c+"</p>"),d}function e(a,b){return"string"==typeof a&&b.test(a)}function f(a,b,c){return b.href=a,c.test(b.pathname)}function g(a,b){a.mustacheProperties=[],a.mustacheCategories=[];var c=/^(\\\\.+|((https?|ftp|file):)?\/\/[a-z0-9][\.a-z0-9\-]*[a-z0-9](:\d{1,5})?(\/[^\s]*)?)$/i,d=/\.(gif|jpe?g|tiff|png|bmp|svg)$/i;if(a.data){var g,h,i=document.createElement("a");for(var j in a.data.properties)a.data.properties.hasOwnProperty(j)&&(g=a.data.properties[j],h=!1,e(g,c)&&(h="url",f(g,i,d)&&(h="image")),a.mustacheProperties.push({key:j,value:g,text:!h,url:"url"===h,image:"image"===h}));if("node"===b)for(var j in a.data.categories)a.data.categories.hasOwnProperty(j)&&a.mustacheCategories.push(a.data.categories[j]);else a.mustacheCategories=[a.data.type]}return a}function h(a,b){return a=a.trim().toLowerCase(),b.map(function(b){return{item:b,score:i(a,(b.label||"").trim().toLowerCase(),3)}}).filter(function(a){return a.score!=Number.POSITIVE_INFINITY}).sort(function(a,b){return a.score-b.score})}function i(a,b,c){var d,e,f,g=b.length,h=a.length,i=-a.length+1,j=c||10,k=.01;if(h>g)return Number.POSITIVE_INFINITY;if(h===g)return a===b?-1:Number.POSITIVE_INFINITY;if(1==h)return i=b.indexOf(a),0>i?Number.POSITIVE_INFINITY:i;a:for(e=0,f=0;h>e;e++){for(d=a.charCodeAt(e);g>f;){if(i+=k,k&&i>j)return Number.POSITIVE_INFINITY;if(b.charCodeAt(f++)===d){k=1;continue a}}return Number.POSITIVE_INFINITY}return i}function j(){var a=this.dataset.id;return o.dropNodes(),o.dropEdges(),o.addNodes(a),LK.closeTooltip(),LK.clearSearch(),LK.locateNode(a,{onComplete:function(){LK.openNodeTooltip(n.graph.nodes(a))}}),!1}function k(){var a=this.dataset.id;return o.dropNodes(),o.dropEdges(),o.addEdges(a),LK.closeTooltip(),LK.clearSearch(),LK.locateEdge(a,{onComplete:function(){LK.openEdgeTooltip(n.graph.edges(a))}}),!1}function l(a){return function(a){if(""==a)return{};for(var b={},c=0;c<a.length;++c){var d=a[c].split("=");2==d.length&&(b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," ")))}return b}(a.split("&"))}function m(a){a.preventDefault(),a.stopPropagation();for(var b=0;b<a.dataTransfer.files.length;b++){var c=a.dataTransfer.files[b],d=new FileReader(c);"gexf"===c.name.slice(-4)?(d.onload=function(a){p.reset();var b=new DOMParser,c=b.parseFromString(a.target.result,"text/xml");sigma.parsers.gexf(c,n,function(){n.graph.nodes().forEach(function(a){a.size=a.size||1,a.color=a.color||"#ddd"}),n.refresh(),u.center()}),LK.dom.hide("#drag-overlay")},d.readAsText(c)):"json"===c.name.slice(-4)?(d.onload=function(a){var b=JSON.parse(a.target.result);b.nodes?(n.graph.clear(),p.reset(),n.graph.read(b),n.refresh(),u.center()):LK.setDesign(b.styles,b.palette),LK.dom.hide("#drag-overlay")},d.readAsText(c)):console.error("Wrong file type.")}}if("undefined"==typeof sigma)throw"sigma is not declared";var n,o,p,q,r,s,t,u,v,w,x,y=!1,z=5,A=l(location.search.substr(1)),B={poweredByHTML:'<img src="/assets/img/favicon-16x16.png" width="16" height="16"> Linkurious',poweredByURL:"https://linkurio.us",defaultEdgeType:"tapered",font:"robotoregular",defaultLabelColor:"#000",defaultLabelSize:11,labelThreshold:5,labelAlignment:"center",defaultEdgeLabelSize:11,edgeLabelThreshold:4,labelHoverShadow:"",edgeLabelHoverShadow:"",maxNodeLabelLineLength:35,defaultNodeColor:"#999999",nodeBorderColor:"default",hoverFontStyle:"bold",nodeHoverBorderSize:2,defaultNodeHoverBorderColor:"#ffffff",nodeActiveColor:"node",defaultNodeActiveColor:"#999999",nodeActiveLevel:3,nodeActiveBorderSize:2,nodeActiveOuterBorderSize:4,defaultNodeActiveBorderColor:"#ffffff",defaultNodeActiveOuterBorderColor:"#f65565",nodeHoverLevel:1,edgeColor:"default",defaultEdgeColor:"#a9a9a9",edgeHoverExtremities:!0,edgeHoverLevel:1,activeFontStyle:"bold",edgeActiveColor:"default",defaultEdgeActiveColor:"#f65565",edgeActiveLevel:3,nodeHaloSize:25,edgeHaloSize:20,nodeHaloColor:"#ffffff",edgeHaloColor:"#ffffff",nodeHaloStroke:!0,nodeHaloStrokeColor:"#a9a9a9",nodeHaloStrokeWidth:.5,imgCrossOrigin:"anonymous",legendBorderWidth:.5,legendBorderRadius:4,legendBorderColor:"#999999",minNodeSize:5,maxNodeSize:5,minEdgeSize:2,maxEdgeSize:2,zoomingRatio:1.382,doubleClickZoomingRatio:1.7,zoomMin:.1,zoomMax:10,doubleClickZoomDuration:200,clickToFocus:!0,autoRescale:["nodeSize","edgeSize"],doubleClickEnabled:!0,enableEdgeHovering:!0,edgeHoverPrecision:10,approximateLabelWidth:!0,nodesPowRatio:.8,edgesPowRatio:.8,animationsTime:1e3},C={node:{show:"clickNode",hide:"clickStage",cssClass:"sigma-tooltip",position:"top",autoadjust:!0},edge:{show:"clickEdge",hide:"clickStage",cssClass:"sigma-tooltip",position:"top",autoadjust:!0}},D={minNodeSize:5,maxNodeSize:15,minEdgeSize:2,maxEdgeSize:6,nodeBorderColor:"node",nodeBorderSize:1,defaultNodeBorderColor:"#fff",nodeOuterBorderSize:1},E=Object.create(null);LK.content={},LK.widget=function(){if(!y){y=!0,w=LK.dom.$("graph-canvas"),n=new sigma({renderer:{container:w,type:"canvas"},settings:B}),"string"!=typeof widgetData&&widgetData.content?(LK.content=widgetData.content,n.graph.read(LK.content.graph),sigma.canvas.edges.autoCurve(n),n.renderers[0].poweredBy(),LK.content.mode&&"geo"===LK.content.mode&&n.graph.hasLatLngCoordinates()?LK.enableGeoMode():n.refresh()):A.graph&&sigma.parsers.json(A.graph,n,function(){sigma.canvas.edges.autoCurve(n),LK.content.mode&&"geo"===LK.content.mode&&n.graph.hasLatLngCoordinates()?LK.enableGeoMode():n.refresh()}),LK.content&&LK.content.mode&&"geo"!==!LK.content.mode&&n.graph.hasLatLngCoordinates()||sigma.plugins.keyboard(n,n.renderers[0],{zoomingRatio:1.3}),p=sigma.plugins.design(n),r=sigma.plugins.legend(n),r.setVisibility(!1),LK.content&&LK.content.styles&&LK.content.palette&&LK.setDesign(LK.content.styles,LK.content.palette),o=sigma.plugins.activeState(n),q=new sigma.plugins.dragNodes(n,n.renderers[0],o),s=sigma.plugins.select(n,o,n.renderers[0]);var a=800;u=sigma.plugins.locate(n,{animation:{node:{duration:a},edge:{duration:a},center:{duration:a}},padding:{top:60,right:20,bottom:20,left:20},focusOut:!1,zoomDef:.3}),n.graph.nodes().length&&u.center();var b=function(){var a=[],b=[];o.nodes().forEach(function(c){a=a.concat(n.graph.adjacentNodes(c.id)),b=b.concat(n.graph.adjacentEdges(c.id,{withHidden:!1}))}),a.concat(o.nodes()),o.edges().forEach(function(b){a.push(n.graph.nodes(b.source)),a.push(n.graph.nodes(b.target))}),n.renderers[0].halo({nodes:a,edges:b})};n.renderers[0].bind("render",function(){b()}),o.bind("activeNodes",function(){b()}),o.bind("activeEdges",function(){b()});var e=LK.dom.$("tooltip-node").innerHTML;Mustache.parse(e),C.node.template=e,C.node.renderer=function(a,b){return a=g(a,"node"),Mustache.render(b,a)};var f=LK.dom.$("tooltip-edge").innerHTML;if(Mustache.parse(f),C.edge.template=f,C.edge.renderer=function(a,b){return a=g(a,"edge"),Mustache.render(b,a)},t=sigma.plugins.tooltips(n,n.renderers[0],C),n.bind("hovers",function(a){a.data.enter.nodes.length?-1==w.className.indexOf("hoverNodes")&&(w.className+=" hoverNodes"):a.data.enter.edges.length?-1==w.className.indexOf("hoverEdges")&&(w.className+=" hoverEdges"):(a.data.leave.nodes.length||a.data.leave.edges.length)&&(w.className=w.className.replace(" hoverNodes",""),w.className=w.className.replace(" hoverEdges",""))}),LK.sigma=n,LK.leafletMap=x,LK.plugins={activeState:o,dragNodesListener:q,design:p,locate:u,select:s,tooltips:t,legend:r,leaflet:v},A.cb&&"function"==typeof window.parent[A.cb]&&window.parent[A.cb](),widgetData.title&&(document.title=widgetData.title+" - Linkurious Widget"),LK.content){if(LK.content.description){var h=LK.dom.all("meta[name=description]")[0];h&&h.parentNode.removeChild(h),h=document.createElement("meta"),h.name="description",h.content=LK.content.description,LK.dom.all("head")[0].appendChild(h)}widgetData.url&&(LK.dom.$("url").value=widgetData.url),widgetData.url&&(LK.dom.$("code").value=d(widgetData.url,widgetData.title,LK.content.description))}return LK.toggleLegend=function(){r.setVisibility(!r.visible)},LK.showLegend=function(){r.setVisibility(!0)},LK.hideLegend=function(){r.setVisibility(!1)},LK.updateUI(),c(),!0}},LK.openNodeTooltip=function(a){var b="renderer1:";t.open(a,C.node,a[b+"x"],a[b+"y"])},LK.openEdgeTooltip=function(a){var b="renderer1:",c=n.graph.nodes(a.source),d=n.graph.nodes(a.target),e=.5*(c[b+"x"]+d[b+"x"]),f=.5*(c[b+"y"]+d[b+"y"]);t.open(a,C.edge,e,f)},LK.closeTooltip=function(){t.close()},LK.searchType="nodes",LK.search=function(a){LK.searchType=a||LK.searchType;var c=LK.dom.$("result-list__input").value;if(c.length){var d,e,f,g,i,l=100;for(i=LK.dom.$("result-list__dropdown");i.lastChild;)i.removeChild(i.lastChild);if("nodes"===LK.searchType){for(d=h(c,n.graph.nodes().filter(function(a){return!a.hidden})).slice(0,z).map(function(a){return f=document.createElement("p"),f.dataset.id=a.item.id,f.className="autocomplete_dropdown_item",f.tabIndex=l++,f.onclick=j,f.addEventListener("keydown",function(a){switch(a.which){case 13:j.apply(this);break;case 38:this.previousSibling?this.previousSibling.focus():this.parentNode.lastChild.focus();break;case 40:this.nextSibling?this.nextSibling.focus():this.parentNode.firstChild.focus();break;case 9:break;default:LK.dom.$("result-list__input").focus()}9!=a.which&&(a.preventDefault(),a.stopPropagation())}),f.appendChild(document.createTextNode(a.item.label)),f}),g=0;g<d.length;g++)i.appendChild(d[g]);d.length||(f=document.createElement("p"),f.className="autocomplete_dropdown_item",f.tabIndex=l++,f.appendChild(document.createTextNode("0 nodes found.")),i.appendChild(f))}if("edges"===LK.searchType){for(e=h(c,n.graph.edges().filter(function(a){return!a.hidden&&!n.graph.nodes(a.source).hidden&&!n.graph.nodes(a.target).hidden})).slice(0,z).map(function(a){return f=document.createElement("p"),f.dataset.id=a.item.id,f.className="autocomplete_dropdown_item",f.tabIndex=l++,f.onclick=k,f.addEventListener("keydown",function(a){switch(a.which){case 13:k.apply(this);break;case 38:this.previousSibling?this.previousSibling.focus():this.parentNode.lastChild.focus();break;case 40:this.nextSibling?this.nextSibling.focus():this.parentNode.firstChild.focus();break;case 9:break;default:LK.dom.$("result-list__input").focus()}9!=a.which&&(a.preventDefault(),a.stopPropagation())}),f.appendChild(document.createTextNode(a.item.label)),f}),g=0;g<e.length;g++)i.appendChild(e[g]);e.length||(f=document.createElement("p"),f.className="autocomplete_dropdown_item",f.tabIndex=l++,f.appendChild(document.createTextNode("0 edges found.")),i.appendChild(f))}b(i,l++),LK.dom.show("#autocomplete__reset"),LK.dom.show("#result-list__dropdown")}else LK.clearSearch()},LK.clearSearch=function(){LK.dom.hide("#autocomplete__reset"),LK.dom.hide("#result-list__dropdown"),LK.dom.$("result-list__input").value="",LK.dom.$("result-list__input").focus();for(var a=LK.dom.$("result-list__dropdown");a.lastChild;)a.removeChild(a.lastChild)},document.getElementById("result-list__input").addEventListener("keydown",function(a){13==a.which&&(LK.dom.$("result-list__dropdown").children.length&&(LK.dom.$("result-list__dropdown").firstChild.focus(),LK.dom.$("result-list__dropdown").firstChild.click()),a.preventDefault(),a.stopPropagation()),LK.dom.$("result-list__dropdown").children.length&&(9!=a.which&&40!=a.which||(LK.dom.$("result-list__dropdown").firstChild.focus(),a.preventDefault()),a.stopPropagation())},!1),LK.toggleLayout=function(){var a=LK.dom.$("viewController-layout").children[0];if(sigma.layouts.isForceLinkRunning())sigma.layouts.stopForceLink(),a.className=a.className.replace("fa-pause","fa-play");else{var b=n.graph.nodes().length,c=2,d=b>250?2*b/100:2.5;if(c=b>50?2.5:b>10?5:b>3?10:b>2?30:50,!b)return;sigma.layouts.configForceLink(n,{autoStop:!0,background:!0,maxIterations:1500,avgDistanceThreshold:1e-5,linLogMode:!0,barnesHutOptimize:b>1e3,easing:"cubicInOut",scalingRatio:c,gravity:d,randomize:"locally",randomizeFactor:30,alignNodeSiblings:b>3,nodeSiblingsScale:8,nodeSiblingsAngleMin:.3}).bind("interpolate stop",function(){a.className=a.className.replace("fa-pause","fa-play")}),a.className=a.className.replace("fa-play","fa-pause"),sigma.layouts.startForceLink()}},LK.setDesign=function(a,b){p.clear(),p.setPalette(b),p.setStyles(a),a.nodes&&a.nodes.icon?n.settings("labelAlignment","right"):n.settings("labelAlignment",""),p.apply(),r.draw()},LK.locateNode=function(a,b){v&&v.isEnabled()?v.fitBounds({nodeIds:a,onComplete:b.onComplete}):u.nodes(a,b)},LK.locateEdge=function(a,b){v&&v.isEnabled()?v.fitBounds({edgeIds:a}):u.edges(a,b)},LK.zoomOut=function(){v&&v.isEnabled()?v.zoomOut():sigma.utils.zoomTo(n.camera,0,0,n.settings("zoomingRatio"),{duration:300})},LK.zoomIn=function(){v&&v.isEnabled()?v.zoomIn():sigma.utils.zoomTo(n.camera,0,0,1/n.settings("zoomingRatio"),{duration:300})},LK.zoomCenter=function(){v&&v.isEnabled()?v.fitBounds():sigma.utils.zoomTo(n.camera,0,0,1,{duration:300})},LK.fullscreen=function(){sigma.plugins.fullScreen({container:document.body})},LK.share=function(){LK.dom.show("#share-overlay")},LK.closeShareOverlay=function(){LK.dom.hide("#share-overlay")},LK.dom={$:function(a){return document.getElementById(a)},all:function(a){return document.querySelectorAll(a)},removeClass:function(a,b){for(var c=document.querySelectorAll(a),d=c.length,e=0;d>e;e++){var f=c[e];f.className=f.className.replace(b,"")}},addClass:function(a,b){for(var c=document.querySelectorAll(a),d=c.length,e=0;d>e;e++){var f=c[e];-1==f.className.indexOf(b)&&(f.className+=" "+b)}},show:function(a){this.removeClass(a,"hidden")},hide:function(a){this.addClass(a,"hidden")},toggle:function(a,b){for(var b=b||"hidden",c=document.querySelectorAll(a),d=c.length,e=0;d>e;e++){var f=c[e];-1!==f.className.indexOf(b)?f.className=f.className.replace(b,""):f.className+=" "+b}}},LK.updateUI=function(){"forceui"in A&&(LK.dom.addClass("#searchbar","always-opaque"),LK.dom.addClass("#viewController","always-opaque")),"ui"in A?(-1!=A.ui.indexOf("search")&&LK.dom.show("#searchbar"),-1!=A.ui.indexOf("share")&&LK.dom.show("#viewController-share"),-1!=A.ui.indexOf("layout")&&LK.dom.show("#viewController-layout"),-1!=A.ui.indexOf("fullscreen")&&LK.dom.show("#viewController-fullscreen"),-1!=A.ui.indexOf("zoom")&&(LK.dom.show("#viewController-zoomin"),LK.dom.show("#viewController-zoomout")),-1!==A.ui.indexOf("legend")&&(LK.dom.show("#viewController-legend"),r.setVisibility(!0)),-1!==A.ui.indexOf("geo")&&LK.dom.show("#viewController-geo")):"ui"in LK.content?(LK.content.ui.search&&LK.dom.show("#searchbar"),LK.content.ui.share&&LK.dom.show("#viewController-share"),LK.content.ui.layout&&LK.dom.show("#viewController-layout"),LK.content.ui.fullscreen&&LK.dom.show("#viewController-fullscreen"),LK.content.ui.zoom&&(LK.dom.show("#viewController-zoomin"),LK.dom.show("#viewController-zoomout")),LK.content.ui.legend&&(LK.dom.show("#viewController-legend"),r.setVisibility(!0)),LK.content.ui.geo&&LK.dom.show("#viewController-geo")):(LK.dom.show("#searchbar"),LK.dom.show("#viewController-geo"),LK.dom.show("#viewController-legend"),LK.dom.show("#viewController-share"),LK.dom.show("#viewController-layout"),LK.dom.show("#viewController-fullscreen"),LK.dom.show("#viewController-zoomin"),LK.dom.show("#viewController-zoomout"))},LK.closeDragOverlay=function(){LK.dom.hide("#drag-overlay")},document.ondragover=function(a){return a.dataTransfer.dropEffect="copy",LK.dom.show("#drag-overlay"),!1},document.ondrop=m,document.getElementById("drop-zone-graph").ondragover=function(a){LK.dom.addClass("#drop-zone-graph","dragover")},document.getElementById("drop-zone-graph").ondragleave=function(a){LK.dom.removeClass("#drop-zone-graph","dragover")},document.getElementById("drop-zone-graph").ondrop=m,document.getElementById("drop-zone-design").ondragover=function(a){LK.dom.addClass("#drop-zone-design","dragover")},document.getElementById("drop-zone-design").ondragleave=function(a){LK.dom.removeClass("#drop-zone-design","dragover")},document.getElementById("drop-zone-design").ondrop=m,LK.enableGeoMode=function(){if(!x){var a,b,c=[],d=0,e={},f={};if(!LK.content||!LK.content.mapLayers||!Array.isArray(LK.content.mapLayers))return;LK.content.mapLayers.forEach(function(b){if(b){var g={detectRetina:!0,reuseTiles:!0,id:b.id,accessToken:b.accessToken,attribution:b.attribution,minZoom:b.minZoom,maxZoom:b.maxZoom};b.subdomains&&(g.subdomains=b.subdomains);var h=L.tileLayer(b.urlTemplate,g);a=a||h,c.push(h),b.name&&(d++,b.overlay?e[b.name]=h:f[b.name]=h)}}),x=L.map("leaflet-container",{layers:c,zoomControl:!1,attributionControl:!1,scrollWheelZoom:"center",doubleClickZoom:"center",bounceAtZoomLimits:!1,keyboard:!1}),b=L.control.attribution({prefix:'<img src="/assets/img/favicon-16x16.png" width="16" height="16"> <a href="https://linkurio.us/" target="_blank">Linkurious</a>'}),b.addTo(x),d>1&&(b.removeAttribution(a.attribution),L.control.layers(f,e,{position:"topright"}).addTo(x))}v||(n.refresh({skipIndexation:!0}),v=sigma.plugins.leaflet(n,x,{easing:"cubicInOut",duration:800})),Object.keys(D).forEach(function(a){E[a]=n.settings(a),n.settings(a,D[a])}),v.fitBounds(),v.enable(),q&&v.bindDragListener(q),sigma.plugins.killKeyboard(n),LK.dom.hide(".sigma-poweredby")},LK.disableGeoMode=function(){v&&v.isEnabled()&&(Object.keys(E).forEach(function(a){n.settings(a,E[a])}),E=Object.create(null),v.bind("disabled",function(){u.center(),v.unbind("disabled",this)}),v.disable(),sigma.plugins.keyboard(n,n.renderers[0],{zoomingRatio:1.3,autofocus:!1}),LK.dom.show(".sigma-poweredby"))},LK.toggleGeoMode=function(){v&&v.isEnabled()?LK.disableGeoMode():LK.enableGeoMode(),LK.search()},document.addEventListener("DOMContentLoaded",function(){LK.widget()})}).call(this);