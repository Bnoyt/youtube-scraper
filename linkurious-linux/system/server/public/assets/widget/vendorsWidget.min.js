
//no 'use strict'
!function(a,b){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):(a.Mustache={},b(a.Mustache))}(this,function(a){function b(a){return"function"==typeof a}function c(a){return p(a)?"array":typeof a}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"==typeof a&&b in a}function f(a,b){return q.call(a,b)}function g(a){return!f(r,a)}function h(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return s[a]})}function i(b,c){function e(){if(r&&!s)for(;q.length;)delete o[q.pop()];else q=[];r=!1,s=!1}function f(a){if("string"==typeof a&&(a=a.split(u,2)),!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);h=new RegExp(d(a[0])+"\\s*"),i=new RegExp("\\s*"+d(a[1])),m=new RegExp("\\s*"+d("}"+a[1]))}if(!b)return[];var h,i,m,n=[],o=[],q=[],r=!1,s=!1;f(c||a.tags);for(var y,z,A,B,C,D,E=new l(b);!E.eos();){if(y=E.pos,A=E.scanUntil(h))for(var F=0,G=A.length;G>F;++F)B=A.charAt(F),g(B)?q.push(o.length):s=!0,o.push(["text",B,y,y+1]),y+=1,"\n"===B&&e();if(!E.scan(h))break;if(r=!0,z=E.scan(x)||"name",E.scan(t),"="===z?(A=E.scanUntil(v),E.scan(v),E.scanUntil(i)):"{"===z?(A=E.scanUntil(m),E.scan(w),E.scanUntil(i),z="&"):A=E.scanUntil(i),!E.scan(i))throw new Error("Unclosed tag at "+E.pos);if(C=[z,A,y,E.pos],o.push(C),"#"===z||"^"===z)n.push(C);else if("/"===z){if(D=n.pop(),!D)throw new Error('Unopened section "'+A+'" at '+y);if(D[1]!==A)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else"name"===z||"{"===z||"&"===z?s=!0:"="===z&&f(A)}if(D=n.pop())throw new Error('Unclosed section "'+D[1]+'" at '+E.pos);return k(j(o))}function j(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function k(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function l(a){this.string=a,this.tail=a,this.pos=0}function m(a,b){this.view=a,this.cache={".":this.view},this.parent=b}function n(){this.cache={}}var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=RegExp.prototype.test,r=/\S/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},t=/\s*/,u=/\s+/,v=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},l.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},m.prototype.push=function(a){return new m(a,this)},m.prototype.lookup=function(a){var c,d=this.cache;if(d.hasOwnProperty(a))c=d[a];else{for(var f,g,h=this,i=!1;h;){if(a.indexOf(".")>0)for(c=h.view,f=a.split("."),g=0;null!=c&&g<f.length;)g===f.length-1&&(i=e(c,f[g])),c=c[f[g++]];else c=h.view[a],i=e(h.view,a);if(i)break;h=h.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},n.prototype.clearCache=function(){this.cache={}},n.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=i(a,b)),d},n.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof m?b:new m(b);return this.renderTokens(d,e,c,a)},n.prototype.renderTokens=function(a,b,c,d){for(var e,f,g,h="",i=0,j=a.length;j>i;++i)g=void 0,e=a[i],f=e[0],"#"===f?g=this.renderSection(e,b,c,d):"^"===f?g=this.renderInverted(e,b,c,d):">"===f?g=this.renderPartial(e,b,c,d):"&"===f?g=this.unescapedValue(e,b):"name"===f?g=this.escapedValue(e,b):"text"===f&&(g=this.rawValue(e)),void 0!==g&&(h+=g);return h},n.prototype.renderSection=function(a,c,d,e){function f(a){return g.render(a,c,d)}var g=this,h="",i=c.lookup(a[1]);if(i){if(p(i))for(var j=0,k=i.length;k>j;++j)h+=this.renderTokens(a[4],c.push(i[j]),d,e);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)h+=this.renderTokens(a[4],c.push(i),d,e);else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,e.slice(a[3],a[5]),f),null!=i&&(h+=i)}else h+=this.renderTokens(a[4],c,d,e);return h}},n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);return!e||p(e)&&0===e.length?this.renderTokens(a[4],b,c,d):void 0},n.prototype.renderPartial=function(a,c,d){if(d){var e=b(d)?d(a[1]):d[a[1]];return null!=e?this.renderTokens(this.parse(e),c,d,e):void 0}},n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);return null!=c?c:void 0},n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);return null!=d?a.escape(d):void 0},n.prototype.rawValue=function(a){return a[1]},a.name="mustache.js",a.version="2.2.1",a.tags=["{{","}}"];var y=new n;a.clearCache=function(){return y.clearCache()},a.parse=function(a,b){return y.parse(a,b)},a.render=function(a,b,d){if("string"!=typeof a)throw new TypeError('Invalid template! Template should be a "string" but "'+c(a)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(a,b,d)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);return b(f)?void f(g):g},a.escape=h,a.Scanner=l,a.Context=m,a.Writer=n}),!function(a,b,c){var d=a.L,e={};e.version="0.7.7","object"==typeof module&&"object"==typeof module.exports?module.exports=e:"function"==typeof define&&define.amd&&define(e),e.noConflict=function(){return a.L=d,this},a.L=e,e.Util={extend:function(a){var b,c,d,e,f=Array.prototype.slice.call(arguments,1);for(c=0,d=f.length;d>c;c++){e=f[c]||{};for(b in e)e.hasOwnProperty(b)&&(a[b]=e[b])}return a},bind:function(a,b){var c=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(b,c||arguments)}},stamp:function(){var a=0,b="_leaflet_id";return function(c){return c[b]=c[b]||++a,c[b]}}(),invokeEach:function(a,b,c){var d,e;if("object"==typeof a){e=Array.prototype.slice.call(arguments,3);for(d in a)b.apply(c,[d,a[d]].concat(e));return!0}return!1},limitExecByInterval:function(a,b,c){var d,e;return function f(){var g=arguments;return d?void(e=!0):(d=!0,setTimeout(function(){d=!1,e&&(f.apply(c,g),e=!1)},b),void a.apply(c,g))}},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return e.Util.trim(a).split(/\s+/)},setOptions:function(a,b){return a.options=e.extend({},a.options,b),a.options},getParamString:function(a,b,c){var d=[];for(var e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(b&&-1!==b.indexOf("?")?"&":"?")+d.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,d){var e=b[d];if(e===c)throw new Error("No value provided for variable "+a);return"function"==typeof e&&(e=e(b)),e})},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function b(b){var c,d,e=["webkit","moz","o","ms"];for(c=0;c<e.length&&!d;c++)d=a[e[c]+b];return d}function c(b){var c=+new Date,e=Math.max(0,16-(c-d));return d=c+e,a.setTimeout(b,e)}var d=0,f=a.requestAnimationFrame||b("RequestAnimationFrame")||c,g=a.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(b){a.clearTimeout(b)};e.Util.requestAnimFrame=function(b,d,g,h){return b=e.bind(b,d),g&&f===c?void b():f.call(a,b,h)},e.Util.cancelAnimFrame=function(b){b&&g.call(a,b)}}(),e.extend=e.Util.extend,e.bind=e.Util.bind,e.stamp=e.Util.stamp,e.setOptions=e.Util.setOptions,e.Class=function(){},e.Class.extend=function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},c=function(){};c.prototype=this.prototype;var d=new c;d.constructor=b,b.prototype=d;for(var f in this)this.hasOwnProperty(f)&&"prototype"!==f&&(b[f]=this[f]);a.statics&&(e.extend(b,a.statics),delete a.statics),a.includes&&(e.Util.extend.apply(null,[d].concat(a.includes)),delete a.includes),a.options&&d.options&&(a.options=e.extend({},d.options,a.options)),e.extend(d,a),d._initHooks=[];var g=this;return b.__super__=g.prototype,d.callInitHooks=function(){if(!this._initHooksCalled){g.prototype.callInitHooks&&g.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=d._initHooks.length;b>a;a++)d._initHooks[a].call(this)}},b},e.Class.include=function(a){e.extend(this.prototype,a)},e.Class.mergeOptions=function(a){e.extend(this.prototype.options,a)},e.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c)};var f="_leaflet_events";e.Mixin={},e.Mixin.Events={addEventListener:function(a,b,c){if(e.Util.invokeEach(a,this.addEventListener,this,b,c))return this;var d,g,h,i,j,k,l,m=this[f]=this[f]||{},n=c&&c!==this&&e.stamp(c);for(a=e.Util.splitWords(a),d=0,g=a.length;g>d;d++)h={action:b,context:c||this},i=a[d],n?(j=i+"_idx",k=j+"_len",l=m[j]=m[j]||{},l[n]||(l[n]=[],m[k]=(m[k]||0)+1),l[n].push(h)):(m[i]=m[i]||[],m[i].push(h));return this},hasEventListeners:function(a){var b=this[f];return!!b&&(a in b&&b[a].length>0||a+"_idx"in b&&b[a+"_idx_len"]>0)},removeEventListener:function(a,b,c){if(!this[f])return this;if(!a)return this.clearAllEventListeners();if(e.Util.invokeEach(a,this.removeEventListener,this,b,c))return this;var d,g,h,i,j,k,l,m,n,o=this[f],p=c&&c!==this&&e.stamp(c);for(a=e.Util.splitWords(a),d=0,g=a.length;g>d;d++)if(h=a[d],k=h+"_idx",l=k+"_len",m=o[k],b){if(i=p&&m?m[p]:o[h]){for(j=i.length-1;j>=0;j--)i[j].action!==b||c&&i[j].context!==c||(n=i.splice(j,1),n[0].action=e.Util.falseFn);c&&m&&0===i.length&&(delete m[p],o[l]--)}}else delete o[h],delete o[k],delete o[l];return this},clearAllEventListeners:function(){return delete this[f],this},fireEvent:function(a,b){if(!this.hasEventListeners(a))return this;var c,d,g,h,i,j=e.Util.extend({},b,{type:a,target:this}),k=this[f];if(k[a])for(c=k[a].slice(),d=0,g=c.length;g>d;d++)c[d].action.call(c[d].context,j);h=k[a+"_idx"];for(i in h)if(c=h[i].slice())for(d=0,g=c.length;g>d;d++)c[d].action.call(c[d].context,j);return this},addOneTimeEventListener:function(a,b,c){if(e.Util.invokeEach(a,this.addOneTimeEventListener,this,b,c))return this;var d=e.bind(function(){this.removeEventListener(a,b,c).removeEventListener(a,d,c)},this);return this.addEventListener(a,b,c).addEventListener(a,d,c)}},e.Mixin.Events.on=e.Mixin.Events.addEventListener,e.Mixin.Events.off=e.Mixin.Events.removeEventListener,e.Mixin.Events.once=e.Mixin.Events.addOneTimeEventListener,e.Mixin.Events.fire=e.Mixin.Events.fireEvent,function(){var d="ActiveXObject"in a,f=d&&!b.addEventListener,g=navigator.userAgent.toLowerCase(),h=-1!==g.indexOf("webkit"),i=-1!==g.indexOf("chrome"),j=-1!==g.indexOf("phantom"),k=-1!==g.indexOf("android"),l=-1!==g.search("android [23]"),m=-1!==g.indexOf("gecko"),n=typeof orientation!=c+"",o=!a.PointerEvent&&a.MSPointerEvent,p=a.PointerEvent&&a.navigator.pointerEnabled||o,q="devicePixelRatio"in a&&a.devicePixelRatio>1||"matchMedia"in a&&a.matchMedia("(min-resolution:144dpi)")&&a.matchMedia("(min-resolution:144dpi)").matches,r=b.documentElement,s=d&&"transition"in r.style,t="WebKitCSSMatrix"in a&&"m11"in new a.WebKitCSSMatrix&&!l,u="MozPerspective"in r.style,v="OTransition"in r.style,w=!a.L_DISABLE_3D&&(s||t||u||v)&&!j,x=!a.L_NO_TOUCH&&!j&&(p||"ontouchstart"in a||a.DocumentTouch&&b instanceof a.DocumentTouch);e.Browser={ie:d,ielt9:f,webkit:h,gecko:m&&!h&&!a.opera&&!d,android:k,android23:l,chrome:i,ie3d:s,webkit3d:t,gecko3d:u,opera3d:v,any3d:w,mobile:n,mobileWebkit:n&&h,mobileWebkit3d:n&&t,mobileOpera:n&&a.opera,touch:x,msPointer:o,pointer:p,retina:q}}(),e.Point=function(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},add:function(a){return this.clone()._add(e.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(e.point(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(a){a=e.point(a);var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},equals:function(a){return a=e.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=e.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+e.Util.formatNum(this.x)+", "+e.Util.formatNum(this.y)+")"}},e.point=function(a,b,d){return a instanceof e.Point?a:e.Util.isArray(a)?new e.Point(a[0],a[1]):a===c||null===a?a:new e.Point(a,b,d)},e.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])},e.Bounds.prototype={extend:function(a){return a=e.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new e.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new e.Point(this.min.x,this.max.y)},getTopRight:function(){return new e.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return a="number"==typeof a[0]||a instanceof e.Point?e.point(a):e.bounds(a),a instanceof e.Bounds?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=e.bounds(a);var b=this.min,c=this.max,d=a.min,f=a.max,g=f.x>=b.x&&d.x<=c.x,h=f.y>=b.y&&d.y<=c.y;return g&&h},isValid:function(){return!(!this.min||!this.max)}},e.bounds=function(a,b){return!a||a instanceof e.Bounds?a:new e.Bounds(a,b)},e.Transformation=function(a,b,c,d){this._a=a,this._b=b,this._c=c,this._d=d},e.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new e.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}},e.DomUtil={get:function(a){return"string"==typeof a?b.getElementById(a):a},getStyle:function(a,c){var d=a.style[c];if(!d&&a.currentStyle&&(d=a.currentStyle[c]),(!d||"auto"===d)&&b.defaultView){var e=b.defaultView.getComputedStyle(a,null);d=e?e[c]:null}return"auto"===d?null:d},getViewportOffset:function(a){var c,d=0,f=0,g=a,h=b.body,i=b.documentElement;do{if(d+=g.offsetTop||0,f+=g.offsetLeft||0,d+=parseInt(e.DomUtil.getStyle(g,"borderTopWidth"),10)||0,f+=parseInt(e.DomUtil.getStyle(g,"borderLeftWidth"),10)||0,c=e.DomUtil.getStyle(g,"position"),g.offsetParent===h&&"absolute"===c)break;if("fixed"===c){d+=h.scrollTop||i.scrollTop||0,f+=h.scrollLeft||i.scrollLeft||0;break}if("relative"===c&&!g.offsetLeft){var j=e.DomUtil.getStyle(g,"width"),k=e.DomUtil.getStyle(g,"max-width"),l=g.getBoundingClientRect();("none"!==j||"none"!==k)&&(f+=l.left+g.clientLeft),d+=l.top+(h.scrollTop||i.scrollTop||0);break}g=g.offsetParent}while(g);g=a;do{if(g===h)break;d-=g.scrollTop||0,f-=g.scrollLeft||0,g=g.parentNode}while(g);return new e.Point(f,d)},documentIsLtr:function(){return e.DomUtil._docIsLtrCached||(e.DomUtil._docIsLtrCached=!0,e.DomUtil._docIsLtr="ltr"===e.DomUtil.getStyle(b.body,"direction")),e.DomUtil._docIsLtr},create:function(a,c,d){var e=b.createElement(a);return e.className=c,d&&d.appendChild(e),e},hasClass:function(a,b){if(a.classList!==c)return a.classList.contains(b);var d=e.DomUtil._getClass(a);return d.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(d)},addClass:function(a,b){if(a.classList!==c)for(var d=e.Util.splitWords(b),f=0,g=d.length;g>f;f++)a.classList.add(d[f]);else if(!e.DomUtil.hasClass(a,b)){var h=e.DomUtil._getClass(a);e.DomUtil._setClass(a,(h?h+" ":"")+b)}},removeClass:function(a,b){a.classList!==c?a.classList.remove(b):e.DomUtil._setClass(a,e.Util.trim((" "+e.DomUtil._getClass(a)+" ").replace(" "+b+" "," ")))},_setClass:function(a,b){a.className.baseVal===c?a.className=b:a.className.baseVal=b},_getClass:function(a){return a.className.baseVal===c?a.className:a.className.baseVal},setOpacity:function(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=a.filters.item(d)}catch(e){if(1===b)return}b=Math.round(100*b),c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:"+d+"(opacity="+b+")"}},testProp:function(a){for(var c=b.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1},getTranslateString:function(a){var b=e.Browser.webkit3d,c="translate"+(b?"3d":"")+"(",d=(b?",0":"")+")";return c+a.x+"px,"+a.y+"px"+d},getScaleString:function(a,b){var c=e.DomUtil.getTranslateString(b.add(b.multiplyBy(-1*a))),d=" scale("+a+") ";return c+d},setPosition:function(a,b,c){a._leaflet_pos=b,!c&&e.Browser.any3d?a.style[e.DomUtil.TRANSFORM]=e.DomUtil.getTranslateString(b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos}},e.DomUtil.TRANSFORM=e.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),e.DomUtil.TRANSITION=e.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),e.DomUtil.TRANSITION_END="webkitTransition"===e.DomUtil.TRANSITION||"OTransition"===e.DomUtil.TRANSITION?e.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in b)e.extend(e.DomUtil,{disableTextSelection:function(){e.DomEvent.on(a,"selectstart",e.DomEvent.preventDefault)},enableTextSelection:function(){e.DomEvent.off(a,"selectstart",e.DomEvent.preventDefault)}});else{var c=e.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);e.extend(e.DomUtil,{disableTextSelection:function(){if(c){var a=b.documentElement.style;this._userSelect=a[c],a[c]="none"}},enableTextSelection:function(){c&&(b.documentElement.style[c]=this._userSelect,delete this._userSelect)}})}e.extend(e.DomUtil,{disableImageDrag:function(){e.DomEvent.on(a,"dragstart",e.DomEvent.preventDefault)},enableImageDrag:function(){e.DomEvent.off(a,"dragstart",e.DomEvent.preventDefault)}})}(),e.LatLng=function(a,b,d){if(a=parseFloat(a),b=parseFloat(b),isNaN(a)||isNaN(b))throw new Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=a,this.lng=b,d!==c&&(this.alt=parseFloat(d))},e.extend(e.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),e.LatLng.prototype={equals:function(a){if(!a)return!1;a=e.latLng(a);var b=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return b<=e.LatLng.MAX_MARGIN},toString:function(a){return"LatLng("+e.Util.formatNum(this.lat,a)+", "+e.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){a=e.latLng(a);var b=6378137,c=e.LatLng.DEG_TO_RAD,d=(a.lat-this.lat)*c,f=(a.lng-this.lng)*c,g=this.lat*c,h=a.lat*c,i=Math.sin(d/2),j=Math.sin(f/2),k=i*i+j*j*Math.cos(g)*Math.cos(h);return 2*b*Math.atan2(Math.sqrt(k),Math.sqrt(1-k))},wrap:function(a,b){var c=this.lng;return a=a||-180,b=b||180,c=(c+b)%(b-a)+(a>c||c===b?b:a),new e.LatLng(this.lat,c)}},e.latLng=function(a,b){return a instanceof e.LatLng?a:e.Util.isArray(a)?"number"==typeof a[0]||"string"==typeof a[0]?new e.LatLng(a[0],a[1],a[2]):null:a===c||null===a?a:"object"==typeof a&&"lat"in a?new e.LatLng(a.lat,"lng"in a?a.lng:a.lon):b===c?null:new e.LatLng(a,b)},e.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])},e.LatLngBounds.prototype={extend:function(a){if(!a)return this;var b=e.latLng(a);return a=null!==b?b:e.latLngBounds(a),a instanceof e.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng)):(this._southWest=new e.LatLng(a.lat,a.lng),this._northEast=new e.LatLng(a.lat,a.lng)):a instanceof e.LatLngBounds&&(this.extend(a._southWest),this.extend(a._northEast)),this},pad:function(a){var b=this._southWest,c=this._northEast,d=Math.abs(b.lat-c.lat)*a,f=Math.abs(b.lng-c.lng)*a;return new e.LatLngBounds(new e.LatLng(b.lat-d,b.lng-f),new e.LatLng(c.lat+d,c.lng+f))},getCenter:function(){return new e.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new e.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new e.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof e.LatLng?e.latLng(a):e.latLngBounds(a);var b,c,d=this._southWest,f=this._northEast;return a instanceof e.LatLngBounds?(b=a.getSouthWest(),c=a.getNorthEast()):b=c=a,b.lat>=d.lat&&c.lat<=f.lat&&b.lng>=d.lng&&c.lng<=f.lng},intersects:function(a){a=e.latLngBounds(a);var b=this._southWest,c=this._northEast,d=a.getSouthWest(),f=a.getNorthEast(),g=f.lat>=b.lat&&d.lat<=c.lat,h=f.lng>=b.lng&&d.lng<=c.lng;return g&&h},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a){return a?(a=e.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},e.latLngBounds=function(a,b){return!a||a instanceof e.LatLngBounds?a:new e.LatLngBounds(a,b)},e.Projection={},e.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var b=e.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,a.lat),-c),f=a.lng*b,g=d*b;return g=Math.log(Math.tan(Math.PI/4+g/2)),new e.Point(f,g)},unproject:function(a){var b=e.LatLng.RAD_TO_DEG,c=a.x*b,d=(2*Math.atan(Math.exp(a.y))-Math.PI/2)*b;return new e.LatLng(d,c)}},e.Projection.LonLat={project:function(a){return new e.Point(a.lng,a.lat)},unproject:function(a){return new e.LatLng(a.y,a.x)}},e.CRS={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),d=this.transformation.untransform(a,c);return this.projection.unproject(d)},project:function(a){return this.projection.project(a)},scale:function(a){return 256*Math.pow(2,a)},getSize:function(a){var b=this.scale(a);return e.point(b,b)}},e.CRS.Simple=e.extend({},e.CRS,{projection:e.Projection.LonLat,transformation:new e.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)}}),e.CRS.EPSG3857=e.extend({},e.CRS,{code:"EPSG:3857",projection:e.Projection.SphericalMercator,transformation:new e.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(a){var b=this.projection.project(a),c=6378137;return b.multiplyBy(c)}}),e.CRS.EPSG900913=e.extend({},e.CRS.EPSG3857,{code:"EPSG:900913"}),e.CRS.EPSG4326=e.extend({},e.CRS,{code:"EPSG:4326",projection:e.Projection.LonLat,transformation:new e.Transformation(1/360,.5,-1/360,.5)}),e.Map=e.Class.extend({includes:e.Mixin.Events,options:{crs:e.CRS.EPSG3857,fadeAnimation:e.DomUtil.TRANSITION&&!e.Browser.android23,trackResize:!0,markerZoomAnimation:e.DomUtil.TRANSITION&&e.Browser.any3d},initialize:function(a,b){b=e.setOptions(this,b),this._initContainer(a),this._initLayout(),this._onResize=e.bind(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.center&&b.zoom!==c&&this.setView(e.latLng(b.center),b.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(b.layers)},setView:function(a,b){return b=b===c?this.getZoom():b,this._resetView(e.latLng(a),this._limitZoom(b)),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=this._limitZoom(a),this)},zoomIn:function(a,b){return this.setZoom(this._zoom+(a||1),b)},zoomOut:function(a,b){return this.setZoom(this._zoom-(a||1),b)},setZoomAround:function(a,b,c){var d=this.getZoomScale(b),f=this.getSize().divideBy(2),g=a instanceof e.Point?a:this.latLngToContainerPoint(a),h=g.subtract(f).multiplyBy(1-1/d),i=this.containerPointToLatLng(f.add(h));return this.setView(i,b,{zoom:c})},fitBounds:function(a,b){b=b||{},a=a.getBounds?a.getBounds():e.latLngBounds(a);var c=e.point(b.paddingTopLeft||b.padding||[0,0]),d=e.point(b.paddingBottomRight||b.padding||[0,0]),f=this.getBoundsZoom(a,!1,c.add(d));f=b.maxZoom?Math.min(b.maxZoom,f):f;var g=d.subtract(c).divideBy(2),h=this.project(a.getSouthWest(),f),i=this.project(a.getNorthEast(),f),j=this.unproject(h.add(i).divideBy(2).add(g),f);return this.setView(j,f,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a){return this.fire("movestart"),this._rawPanBy(e.point(a)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(a){return a=e.latLngBounds(a),this.options.maxBounds=a,a?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(a,b){var c=this.getCenter(),d=this._limitCenter(c,this._zoom,a);return c.equals(d)?this:this.panTo(d,b)},addLayer:function(a){var b=e.stamp(a);return this._layers[b]?this:(this._layers[b]=a,!a.options||isNaN(a.options.maxZoom)&&isNaN(a.options.minZoom)||(this._zoomBoundLayers[b]=a,this._updateZoomLevels()),this.options.zoomAnimation&&e.TileLayer&&a instanceof e.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,a.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(a),this)},removeLayer:function(a){var b=e.stamp(a);return this._layers[b]?(this._loaded&&a.onRemove(this),delete this._layers[b],this._loaded&&this.fire("layerremove",{layer:a}),this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels()),this.options.zoomAnimation&&e.TileLayer&&a instanceof e.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,a.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(a){return a?e.stamp(a)in this._layers:!1},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},invalidateSize:function(a){if(!this._loaded)return this;a=e.extend({animate:!1,pan:!0},a===!0?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var c=this.getSize(),d=b.divideBy(2).round(),f=c.divideBy(2).round(),g=d.subtract(f);return g.x||g.y?(a.animate&&a.pan?this.panBy(g):(a.pan&&this._rawPanBy(g),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(e.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(a){this._container._leaflet=c}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),c=this.unproject(a.getTopRight());return new e.LatLngBounds(b,c)},getMinZoom:function(){return this.options.minZoom===c?this._layersMinZoom===c?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===c?this._layersMaxZoom===c?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=e.latLngBounds(a);var d,f=this.getMinZoom()-(b?1:0),g=this.getMaxZoom(),h=this.getSize(),i=a.getNorthWest(),j=a.getSouthEast(),k=!0;c=e.point(c||[0,0]);do f++,d=this.project(j,f).subtract(this.project(i,f)).add(c),k=b?d.x<h.x||d.y<h.y:h.contains(d);while(k&&g>=f);return k&&b?null:b?f:f-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new e.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var a=this._getTopLeftPoint();return new e.Bounds(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a){var b=this.options.crs;return b.scale(a)/b.scale(this._zoom)},getScaleZoom:function(a){return this._zoom+Math.log(a)/Math.LN2},project:function(a,b){return b=b===c?this._zoom:b,this.options.crs.latLngToPoint(e.latLng(a),b)},unproject:function(a,b){return b=b===c?this._zoom:b,this.options.crs.pointToLatLng(e.point(a),b)},layerPointToLatLng:function(a){var b=e.point(a).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(a){var b=this.project(e.latLng(a))._round();return b._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(a){return e.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return e.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var b=this.containerPointToLayerPoint(e.point(a));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(e.latLng(a)))},mouseEventToContainerPoint:function(a){return e.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var b=this._container=e.DomUtil.get(a);if(!b)throw new Error("Map container not found.");if(b._leaflet)throw new Error("Map container is already initialized.");b._leaflet=!0},_initLayout:function(){var a=this._container;e.DomUtil.addClass(a,"leaflet-container"+(e.Browser.touch?" leaflet-touch":"")+(e.Browser.retina?" leaflet-retina":"")+(e.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var b=e.DomUtil.getStyle(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),a.shadowPane=this._createPane("leaflet-shadow-pane"),a.overlayPane=this._createPane("leaflet-overlay-pane"),a.markerPane=this._createPane("leaflet-marker-pane"),a.popupPane=this._createPane("leaflet-popup-pane");var b=" leaflet-zoom-hide";this.options.markerZoomAnimation||(e.DomUtil.addClass(a.markerPane,b),
e.DomUtil.addClass(a.shadowPane,b),e.DomUtil.addClass(a.popupPane,b))},_createPane:function(a,b){return e.DomUtil.create("div",a,b||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(a){a=a?e.Util.isArray(a)?a:[a]:[];for(var b=0,c=a.length;c>b;b++)this.addLayer(a[b])},_resetView:function(a,b,c,d){var f=this._zoom!==b;d||(this.fire("movestart"),f&&this.fire("zoomstart")),this._zoom=b,this._initialCenter=a,this._initialTopLeftPoint=this._getNewTopLeftPoint(a),c?this._initialTopLeftPoint._add(this._getMapPanePos()):e.DomUtil.setPosition(this._mapPane,new e.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var g=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!c}),g&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(f||d)&&this.fire("zoomend"),this.fire("moveend",{hard:!c})},_rawPanBy:function(a){e.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var a,b=1/0,d=-(1/0),e=this._getZoomSpan();for(a in this._zoomBoundLayers){var f=this._zoomBoundLayers[a];isNaN(f.options.minZoom)||(b=Math.min(b,f.options.minZoom)),isNaN(f.options.maxZoom)||(d=Math.max(d,f.options.maxZoom))}a===c?this._layersMaxZoom=this._layersMinZoom=c:(this._layersMaxZoom=d,this._layersMinZoom=b),e!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(b){if(e.DomEvent){b=b||"on",e.DomEvent[b](this._container,"click",this._onMouseClick,this);var c,d,f=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(c=0,d=f.length;d>c;c++)e.DomEvent[b](this._container,f[c],this._fireMouseEvent,this);this.options.trackResize&&e.DomEvent[b](a,"resize",this._onResize,this)}},_onResize:function(){e.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=e.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(a){!this._loaded||!a._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||e.DomEvent._skipped(a)||(this.fire("preclick"),this._fireMouseEvent(a))},_fireMouseEvent:function(a){if(this._loaded&&!e.DomEvent._skipped(a)){var b=a.type;if(b="mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,this.hasEventListeners(b)){"contextmenu"===b&&e.DomEvent.preventDefault(a);var c=this.mouseEventToContainerPoint(a),d=this.containerPointToLayerPoint(c),f=this.layerPointToLatLng(d);this.fire(b,{latlng:f,layerPoint:d,containerPoint:c,originalEvent:a})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var a=0,b=this._handlers.length;b>a;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,this):this.on("load",a,b),this},_layerAdd:function(a){a.onAdd(this),this.fire("layeradd",{layer:a})},_getMapPanePos:function(){return e.DomUtil.getPosition(this._mapPane)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._round()},_latLngToNewLayerPoint:function(a,b,c){var d=this._getNewTopLeftPoint(c,b).add(this._getMapPanePos());return this.project(a,b)._subtract(d)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;var d=this.project(a,b),f=this.getSize().divideBy(2),g=new e.Bounds(d.subtract(f),d.add(f)),h=this._getBoundsOffset(g,c,b);return this.unproject(d.add(h),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),d=new e.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(d,b))},_getBoundsOffset:function(a,b,c){var d=this.project(b.getNorthWest(),c).subtract(a.min),f=this.project(b.getSouthEast(),c).subtract(a.max),g=this._rebound(d.x,-f.x),h=this._rebound(d.y,-f.y);return new e.Point(g,h)},_rebound:function(a,b){return a+b>0?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom();return Math.max(b,Math.min(c,a))}}),e.map=function(a,b){return new e.Map(a,b)},e.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(a){var b=e.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,a.lat),-c),f=this.R_MAJOR,g=this.R_MINOR,h=a.lng*b*f,i=d*b,j=g/f,k=Math.sqrt(1-j*j),l=k*Math.sin(i);l=Math.pow((1-l)/(1+l),.5*k);var m=Math.tan(.5*(.5*Math.PI-i))/l;return i=-f*Math.log(m),new e.Point(h,i)},unproject:function(a){for(var b,c=e.LatLng.RAD_TO_DEG,d=this.R_MAJOR,f=this.R_MINOR,g=a.x*c/d,h=f/d,i=Math.sqrt(1-h*h),j=Math.exp(-a.y/d),k=Math.PI/2-2*Math.atan(j),l=15,m=1e-7,n=l,o=.1;Math.abs(o)>m&&--n>0;)b=i*Math.sin(k),o=Math.PI/2-2*Math.atan(j*Math.pow((1-b)/(1+b),.5*i))-k,k+=o;return new e.LatLng(k*c,g)}},e.CRS.EPSG3395=e.extend({},e.CRS,{code:"EPSG:3395",projection:e.Projection.Mercator,transformation:function(){var a=e.Projection.Mercator,b=a.R_MAJOR,c=.5/(Math.PI*b);return new e.Transformation(c,.5,-c,.5)}()}),e.TileLayer=e.Class.extend({includes:e.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:e.Browser.mobile,updateWhenIdle:e.Browser.mobile},initialize:function(a,b){b=e.setOptions(this,b),b.detectRetina&&e.Browser.retina&&b.maxZoom>0&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomOffset++,b.minZoom>0&&b.minZoom--,this.options.maxZoom--),b.bounds&&(b.bounds=e.latLngBounds(b.bounds)),this._url=a;var c=this.options.subdomains;"string"==typeof c&&(this.options.subdomains=c.split(""))},onAdd:function(a){this._map=a,this._animated=a._zoomAnimated,this._initContainer(),a.on({viewreset:this._reset,moveend:this._update},this),this._animated&&a.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=e.Util.limitExecByInterval(this._update,150,this),a.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this._container.parentNode.removeChild(this._container),a.off({viewreset:this._reset,moveend:this._update},this),this._animated&&a.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||a.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var a=this._map._panes.tilePane;return this._container&&(a.appendChild(this._container),this._setAutoZIndex(a,Math.max)),this},bringToBack:function(){var a=this._map._panes.tilePane;return this._container&&(a.insertBefore(this._container,a.firstChild),this._setAutoZIndex(a,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==c&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a,b){var c,d,e,f=a.children,g=-b(1/0,-(1/0));for(d=0,e=f.length;e>d;d++)f[d]!==this._container&&(c=parseInt(f[d].style.zIndex,10),isNaN(c)||(g=b(g,c)));this.options.zIndex=this._container.style.zIndex=(isFinite(g)?g:0)+b(1,-1)},_updateOpacity:function(){var a,b=this._tiles;if(e.Browser.ielt9)for(a in b)e.DomUtil.setOpacity(b[a],this.options.opacity);else e.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var a=this._map._panes.tilePane;if(!this._container){if(this._container=e.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var b="leaflet-tile-container";this._bgBuffer=e.DomUtil.create("div",b,this._container),this._tileContainer=e.DomUtil.create("div",b,this._container)}else this._tileContainer=this._container;a.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(a){for(var b in this._tiles)this.fire("tileunload",{tile:this._tiles[b]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&a&&a.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var a=this._map,b=a.getZoom()+this.options.zoomOffset,c=this.options.maxNativeZoom,d=this.options.tileSize;return c&&b>c&&(d=Math.round(a.getZoomScale(b)/a.getZoomScale(c)*d)),d},_update:function(){if(this._map){var a=this._map,b=a.getPixelBounds(),c=a.getZoom(),d=this._getTileSize();if(!(c>this.options.maxZoom||c<this.options.minZoom)){var f=e.bounds(b.min.divideBy(d)._floor(),b.max.divideBy(d)._floor());this._addTilesFromCenterOut(f),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(f)}}},_addTilesFromCenterOut:function(a){var c,d,f,g=[],h=a.getCenter();for(c=a.min.y;c<=a.max.y;c++)for(d=a.min.x;d<=a.max.x;d++)f=new e.Point(d,c),this._tileShouldBeLoaded(f)&&g.push(f);var i=g.length;if(0!==i){g.sort(function(a,b){return a.distanceTo(h)-b.distanceTo(h)});var j=b.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=i,d=0;i>d;d++)this._addTile(g[d],j);this._tileContainer.appendChild(j)}},_tileShouldBeLoaded:function(a){if(a.x+":"+a.y in this._tiles)return!1;var b=this.options;if(!b.continuousWorld){var c=this._getWrapTileNum();if(b.noWrap&&(a.x<0||a.x>=c.x)||a.y<0||a.y>=c.y)return!1}if(b.bounds){var d=this._getTileSize(),e=a.multiplyBy(d),f=e.add([d,d]),g=this._map.unproject(e),h=this._map.unproject(f);if(b.continuousWorld||b.noWrap||(g=g.wrap(),h=h.wrap()),!b.bounds.intersects([g,h]))return!1}return!0},_removeOtherTiles:function(a){var b,c,d,e;for(e in this._tiles)b=e.split(":"),c=parseInt(b[0],10),d=parseInt(b[1],10),(c<a.min.x||c>a.max.x||d<a.min.y||d>a.max.y)&&this._removeTile(e)},_removeTile:function(a){var b=this._tiles[a];this.fire("tileunload",{tile:b,url:b.src}),this.options.reuseTiles?(e.DomUtil.removeClass(b,"leaflet-tile-loaded"),this._unusedTiles.push(b)):b.parentNode===this._tileContainer&&this._tileContainer.removeChild(b),e.Browser.android||(b.onload=null,b.src=e.Util.emptyImageUrl),delete this._tiles[a]},_addTile:function(a,b){var c=this._getTilePos(a),d=this._getTile();e.DomUtil.setPosition(d,c,e.Browser.chrome),this._tiles[a.x+":"+a.y]=d,this._loadTile(d,a),d.parentNode!==this._tileContainer&&b.appendChild(d)},_getZoomForUrl:function(){var a=this.options,b=this._map.getZoom();return a.zoomReverse&&(b=a.maxZoom-b),b+=a.zoomOffset,a.maxNativeZoom?Math.min(b,a.maxNativeZoom):b},_getTilePos:function(a){var b=this._map.getPixelOrigin(),c=this._getTileSize();return a.multiplyBy(c).subtract(b)},getTileUrl:function(a){return e.Util.template(this._url,e.extend({s:this._getSubdomain(a),z:a.z,x:a.x,y:a.y},this.options))},_getWrapTileNum:function(){var a=this._map.options.crs,b=a.getSize(this._map.getZoom());return b.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(a){var b=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(a.x=(a.x%b.x+b.x)%b.x),this.options.tms&&(a.y=b.y-a.y-1),a.z=this._getZoomForUrl()},_getSubdomain:function(a){var b=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[b]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var a=this._unusedTiles.pop();return this._resetTile(a),a}return this._createTile()},_resetTile:function(){},_createTile:function(){var a=e.DomUtil.create("img","leaflet-tile");return a.style.width=a.style.height=this._getTileSize()+"px",a.galleryimg="no",a.onselectstart=a.onmousemove=e.Util.falseFn,e.Browser.ielt9&&this.options.opacity!==c&&e.DomUtil.setOpacity(a,this.options.opacity),e.Browser.mobileWebkit3d&&(a.style.WebkitBackfaceVisibility="hidden"),a},_loadTile:function(a,b){a._layer=this,a.onload=this._tileOnLoad,a.onerror=this._tileOnError,this._adjustTilePoint(b),a.src=this.getTileUrl(b),this.fire("tileloadstart",{tile:a,url:a.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&e.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(e.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var a=this._layer;this.src!==e.Util.emptyImageUrl&&(e.DomUtil.addClass(this,"leaflet-tile-loaded"),a.fire("tileload",{tile:this,url:this.src})),a._tileLoaded()},_tileOnError:function(){var a=this._layer;a.fire("tileerror",{tile:this,url:this.src});var b=a.options.errorTileUrl;b&&(this.src=b),a._tileLoaded()}}),e.tileLayer=function(a,b){return new e.TileLayer(a,b)},e.TileLayer.WMS=e.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,b){this._url=a;var c=e.extend({},this.defaultWmsParams),d=b.tileSize||this.options.tileSize;b.detectRetina&&e.Browser.retina?c.width=c.height=2*d:c.width=c.height=d;for(var f in b)this.options.hasOwnProperty(f)||"crs"===f||(c[f]=b[f]);this.wmsParams=c,e.setOptions(this,b)},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,e.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._map,c=this.options.tileSize,d=a.multiplyBy(c),f=d.add([c,c]),g=this._crs.project(b.unproject(d,a.z)),h=this._crs.project(b.unproject(f,a.z)),i=this._wmsVersion>=1.3&&this._crs===e.CRS.EPSG4326?[h.y,g.x,g.y,h.x].join(","):[g.x,h.y,h.x,g.y].join(","),j=e.Util.template(this._url,{s:this._getSubdomain(a)});return j+e.Util.getParamString(this.wmsParams,j,!0)+"&BBOX="+i},setParams:function(a,b){return e.extend(this.wmsParams,a),b||this.redraw(),this}}),e.tileLayer.wms=function(a,b){return new e.TileLayer.WMS(a,b)},e.TileLayer.Canvas=e.TileLayer.extend({options:{async:!1},initialize:function(a){e.setOptions(this,a)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var a in this._tiles)this._redrawTile(this._tiles[a]);return this},_redrawTile:function(a){this.drawTile(a,a._tilePoint,this._map._zoom)},_createTile:function(){var a=e.DomUtil.create("canvas","leaflet-tile");return a.width=a.height=this.options.tileSize,a.onselectstart=a.onmousemove=e.Util.falseFn,a},_loadTile:function(a,b){a._layer=this,a._tilePoint=b,this._redrawTile(a),this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}}),e.tileLayer.canvas=function(a){return new e.TileLayer.Canvas(a)},e.ImageOverlay=e.Class.extend({includes:e.Mixin.Events,options:{opacity:1},initialize:function(a,b,c){this._url=a,this._bounds=e.latLngBounds(b),e.setOptions(this,c)},onAdd:function(a){this._map=a,this._image||this._initImage(),a._panes.overlayPane.appendChild(this._image),a.on("viewreset",this._reset,this),a.options.zoomAnimation&&e.Browser.any3d&&a.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image),a.off("viewreset",this._reset,this),a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var a=this._map._panes.overlayPane;return this._image&&a.insertBefore(this._image,a.firstChild),this},setUrl:function(a){this._url=a,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=e.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&e.Browser.any3d?e.DomUtil.addClass(this._image,"leaflet-zoom-animated"):e.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),e.extend(this._image,{galleryimg:"no",onselectstart:e.Util.falseFn,onmousemove:e.Util.falseFn,onload:e.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(a){var b=this._map,c=this._image,d=b.getZoomScale(a.zoom),f=this._bounds.getNorthWest(),g=this._bounds.getSouthEast(),h=b._latLngToNewLayerPoint(f,a.zoom,a.center),i=b._latLngToNewLayerPoint(g,a.zoom,a.center)._subtract(h),j=h._add(i._multiplyBy(.5*(1-1/d)));c.style[e.DomUtil.TRANSFORM]=e.DomUtil.getTranslateString(j)+" scale("+d+") "},_reset:function(){var a=this._image,b=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),c=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(b);e.DomUtil.setPosition(a,b),a.style.width=c.x+"px",a.style.height=c.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){e.DomUtil.setOpacity(this._image,this.options.opacity)}}),e.imageOverlay=function(a,b,c){return new e.ImageOverlay(a,b,c)},e.Icon=e.Class.extend({options:{className:""},initialize:function(a){e.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d;return d=b&&"IMG"===b.tagName?this._createImg(c,b):this._createImg(c),this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c,d=this.options,f=e.point(d[b+"Size"]);c="shadow"===b?e.point(d.shadowAnchor||d.iconAnchor):e.point(d.iconAnchor),!c&&f&&(c=f.divideBy(2,!0)),a.className="leaflet-marker-"+b+" "+d.className,c&&(a.style.marginLeft=-c.x+"px",a.style.marginTop=-c.y+"px"),f&&(a.style.width=f.x+"px",a.style.height=f.y+"px")},_createImg:function(a,c){return c=c||b.createElement("img"),c.src=a,c},_getIconUrl:function(a){return e.Browser.retina&&this.options[a+"RetinaUrl"]?this.options[a+"RetinaUrl"]:this.options[a+"Url"]}}),e.icon=function(a){return new e.Icon(a)},e.Icon.Default=e.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(a){var b=a+"Url";if(this.options[b])return this.options[b];e.Browser.retina&&"icon"===a&&(a+="-2x");var c=e.Icon.Default.imagePath;if(!c)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return c+"/marker-"+a+".png"}}),e.Icon.Default.imagePath=function(){var a,c,d,e,f,g=b.getElementsByTagName("script"),h=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(a=0,c=g.length;c>a;a++)if(d=g[a].src,e=d.match(h))return f=d.split(h)[0],(f?f+"/":"")+"images"}(),e.Marker=e.Class.extend({includes:e.Mixin.Events,options:{icon:new e.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(a,b){e.setOptions(this,b),this._latlng=e.latLng(a)},onAdd:function(a){this._map=a,a.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),a.options.zoomAnimation&&a.options.markerZoomAnimation&&a.on("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),a.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=e.latLng(a),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update(),this},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var a=this.options,b=this._map,c=b.options.zoomAnimation&&b.options.markerZoomAnimation,d=c?"leaflet-zoom-animated":"leaflet-zoom-hide",f=a.icon.createIcon(this._icon),g=!1;f!==this._icon&&(this._icon&&this._removeIcon(),g=!0,a.title&&(f.title=a.title),a.alt&&(f.alt=a.alt)),e.DomUtil.addClass(f,d),a.keyboard&&(f.tabIndex="0"),this._icon=f,this._initInteraction(),a.riseOnHover&&e.DomEvent.on(f,"mouseover",this._bringToFront,this).on(f,"mouseout",this._resetZIndex,this);var h=a.icon.createShadow(this._shadow),i=!1;h!==this._shadow&&(this._removeShadow(),i=!0),h&&e.DomUtil.addClass(h,d),this._shadow=h,a.opacity<1&&this._updateOpacity();var j=this._map._panes;g&&j.markerPane.appendChild(this._icon),h&&i&&j.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&e.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(a){e.DomUtil.setPosition(this._icon,a),this._shadow&&e.DomUtil.setPosition(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.clickable){var a=this._icon,b=["dblclick","mousedown","mouseover","mouseout","contextmenu"];e.DomUtil.addClass(a,"leaflet-clickable"),e.DomEvent.on(a,"click",this._onMouseClick,this),e.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var c=0;c<b.length;c++)e.DomEvent.on(a,b[c],this._fireMouseEvent,this);e.Handler.MarkerDrag&&(this.dragging=new e.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(a){var b=this.dragging&&this.dragging.moved();(this.hasEventListeners(a.type)||b)&&e.DomEvent.stopPropagation(a),b||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(a.type,{originalEvent:a,latlng:this._latlng})},_onKeyPress:function(a){13===a.keyCode&&this.fire("click",{originalEvent:a,latlng:this._latlng})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a,latlng:this._latlng}),"contextmenu"===a.type&&this.hasEventListeners(a.type)&&e.DomEvent.preventDefault(a),"mousedown"!==a.type?e.DomEvent.stopPropagation(a):e.DomEvent.preventDefault(a)},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){e.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&e.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),e.marker=function(a,b){return new e.Marker(a,b)},e.DivIcon=e.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(a){var c=a&&"DIV"===a.tagName?a:b.createElement("div"),d=this.options;return d.html!==!1?c.innerHTML=d.html:c.innerHTML="",d.bgPos&&(c.style.backgroundPosition=-d.bgPos.x+"px "+-d.bgPos.y+"px"),this._setIconStyles(c,"icon"),c},createShadow:function(){return null}}),e.divIcon=function(a){return new e.DivIcon(a)},e.Map.mergeOptions({closePopupOnClick:!0}),e.Popup=e.Class.extend({includes:e.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(a,b){e.setOptions(this,a),this._source=b,this._animated=e.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(a){this._map=a,this._container||this._initLayout();var b=a.options.fadeAnimation;b&&e.DomUtil.setOpacity(this._container,0),a._panes.popupPane.appendChild(this._container),a.on(this._getEvents(),this),this.update(),b&&e.DomUtil.setOpacity(this._container,1),this.fire("open"),a.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(a){return a.addLayer(this),this},openOn:function(a){return a.openPopup(this),this},onRemove:function(a){a._panes.popupPane.removeChild(this._container),e.Util.falseFn(this._container.offsetWidth),a.off(this._getEvents(),this),a.options.fadeAnimation&&e.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),a.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=e.latLng(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var a={viewreset:this._updatePosition};return this._animated&&(a.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a,b="leaflet-popup",c=b+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),d=this._container=e.DomUtil.create("div",c);this.options.closeButton&&(a=this._closeButton=e.DomUtil.create("a",b+"-close-button",d),a.href="#close",a.innerHTML="&#215;",e.DomEvent.disableClickPropagation(a),e.DomEvent.on(a,"click",this._onCloseButtonClick,this));var f=this._wrapper=e.DomUtil.create("div",b+"-content-wrapper",d);e.DomEvent.disableClickPropagation(f),this._contentNode=e.DomUtil.create("div",b+"-content",f),e.DomEvent.disableScrollPropagation(this._contentNode),e.DomEvent.on(f,"contextmenu",e.DomEvent.stopPropagation),this._tipContainer=e.DomUtil.create("div",b+"-tip-container",d),this._tip=e.DomUtil.create("div",b+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="",b.whiteSpace="nowrap";var c=a.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),b.width=c+1+"px",b.whiteSpace="",b.height="";var d=a.offsetHeight,f=this.options.maxHeight,g="leaflet-popup-scrolled";f&&d>f?(b.height=f+"px",e.DomUtil.addClass(a,g)):e.DomUtil.removeClass(a,g),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=this._animated,c=e.point(this.options.offset);b&&e.DomUtil.setPosition(this._container,a),this._containerBottom=-c.y-(b?0:a.y),this._containerLeft=-Math.round(this._containerWidth/2)+c.x+(b?0:a.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);e.DomUtil.setPosition(this._container,b)},_adjustPan:function(){if(this.options.autoPan){var a=this._map,b=this._container.offsetHeight,c=this._containerWidth,d=new e.Point(this._containerLeft,-b-this._containerBottom);this._animated&&d._add(e.DomUtil.getPosition(this._container));var f=a.layerPointToContainerPoint(d),g=e.point(this.options.autoPanPadding),h=e.point(this.options.autoPanPaddingTopLeft||g),i=e.point(this.options.autoPanPaddingBottomRight||g),j=a.getSize(),k=0,l=0;f.x+c+i.x>j.x&&(k=f.x+c-j.x+i.x),f.x-k-h.x<0&&(k=f.x-h.x),f.y+b+i.y>j.y&&(l=f.y+b-j.y+i.y),f.y-l-h.y<0&&(l=f.y-h.y),(k||l)&&a.fire("autopanstart").panBy([k,l])}},_onCloseButtonClick:function(a){this._close(),e.DomEvent.stop(a)}}),e.popup=function(a,b){return new e.Popup(a,b)},e.Map.include({openPopup:function(a,b,c){if(this.closePopup(),!(a instanceof e.Popup)){var d=a;a=new e.Popup(c).setLatLng(b).setContent(d)}return a._isOpen=!0,this._popup=a,this.addLayer(a)},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&(this.removeLayer(a),a._isOpen=!1),this}}),e.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(a,b){var c=e.point(this.options.icon.options.popupAnchor||[0,0]);return c=c.add(e.Popup.prototype.options.offset),b&&b.offset&&(c=c.add(b.offset)),b=e.extend({offset:c},b),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),a instanceof e.Popup?(e.setOptions(a,b),this._popup=a,a._source=this):this._popup=new e.Popup(b,this).setContent(a),this},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(a){this._popup.setLatLng(a.latlng)}}),e.LayerGroup=e.Class.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;c>b;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var b=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(a){return a?a in this._layers||this.getLayerId(a)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(a){var b,c,d=Array.prototype.slice.call(arguments,1);for(b in this._layers)c=this._layers[b],c[a]&&c[a].apply(c,d);return this},onAdd:function(a){this._map=a,this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a),this._map=null},addTo:function(a){return a.addLayer(this),this},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];for(var b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return e.stamp(a)}}),e.layerGroup=function(a){return new e.LayerGroup(a)},e.FeatureGroup=e.LayerGroup.extend({includes:e.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(a){return this.hasLayer(a)?this:("on"in a&&a.on(e.FeatureGroup.EVENTS,this._propagateEvent,this),e.LayerGroup.prototype.addLayer.call(this,a),this._popupContent&&a.bindPopup&&a.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),"off"in a&&a.off(e.FeatureGroup.EVENTS,this._propagateEvent,this),
e.LayerGroup.prototype.removeLayer.call(this,a),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:a})):this},bindPopup:function(a,b){return this._popupContent=a,this._popupOptions=b,this.invoke("bindPopup",a,b)},openPopup:function(a){for(var b in this._layers){this._layers[b].openPopup(a);break}return this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new e.LatLngBounds;return this.eachLayer(function(b){a.extend(b instanceof e.Marker?b.getLatLng():b.getBounds())}),a},_propagateEvent:function(a){a=e.extend({layer:a.target,target:this},a),this.fire(a.type,a)}}),e.featureGroup=function(a){return new e.FeatureGroup(a)},e.Path=e.Class.extend({includes:[e.Mixin.Events],statics:{CLIP_PADDING:function(){var b=e.Browser.mobile?1280:2e3,c=(b/Math.max(a.outerWidth,a.outerHeight)-1)/2;return Math.max(0,Math.min(.5,c))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(a){e.setOptions(this,a)},onAdd:function(a){this._map=a,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),a.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){a._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,e.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),a.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(a){return e.setOptions(this,a),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),e.Map.include({_updatePathViewport:function(){var a=e.Path.CLIP_PADDING,b=this.getSize(),c=e.DomUtil.getPosition(this._mapPane),d=c.multiplyBy(-1)._subtract(b.multiplyBy(a)._round()),f=d.add(b.multiplyBy(1+2*a)._round());this._pathViewport=new e.Bounds(d,f)}}),e.Path.SVG_NS="http://www.w3.org/2000/svg",e.Browser.svg=!(!b.createElementNS||!b.createElementNS(e.Path.SVG_NS,"svg").createSVGRect),e.Path=e.Path.extend({statics:{SVG:e.Browser.svg},bringToFront:function(){var a=this._map._pathRoot,b=this._container;return b&&a.lastChild!==b&&a.appendChild(b),this},bringToBack:function(){var a=this._map._pathRoot,b=this._container,c=a.firstChild;return b&&c!==b&&a.insertBefore(b,c),this},getPathString:function(){},_createElement:function(a){return b.createElementNS(e.Path.SVG_NS,a)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&e.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var a=this.getPathString();a||(a="M0 0"),this._path.setAttribute("d",a)},_initEvents:function(){if(this.options.clickable){(e.Browser.svg||!e.Browser.vml)&&e.DomUtil.addClass(this._path,"leaflet-clickable"),e.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],b=0;b<a.length;b++)e.DomEvent.on(this._container,a[b],this._fireMouseEvent,this)}},_onMouseClick:function(a){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(a)},_fireMouseEvent:function(a){if(this._map&&this.hasEventListeners(a.type)){var b=this._map,c=b.mouseEventToContainerPoint(a),d=b.containerPointToLayerPoint(c),f=b.layerPointToLatLng(d);this.fire(a.type,{latlng:f,layerPoint:d,containerPoint:c,originalEvent:a}),"contextmenu"===a.type&&e.DomEvent.preventDefault(a),"mousemove"!==a.type&&e.DomEvent.stopPropagation(a)}}}),e.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=e.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&e.Browser.any3d?(e.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):e.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(a){var b=this.getZoomScale(a.zoom),c=this._getCenterOffset(a.center)._multiplyBy(-b)._add(this._pathViewport.min);this._pathRoot.style[e.DomUtil.TRANSFORM]=e.DomUtil.getTranslateString(c)+" scale("+b+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,b=a.min,c=a.max,d=c.x-b.x,f=c.y-b.y,g=this._pathRoot,h=this._panes.overlayPane;e.Browser.mobileWebkit&&h.removeChild(g),e.DomUtil.setPosition(g,b),g.setAttribute("width",d),g.setAttribute("height",f),g.setAttribute("viewBox",[b.x,b.y,d,f].join(" ")),e.Browser.mobileWebkit&&h.appendChild(g)}}}),e.Path.include({bindPopup:function(a,b){return a instanceof e.Popup?this._popup=a:((!this._popup||b)&&(this._popup=new e.Popup(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(a){return this._popup&&(a=a||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:a})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(a){this._popup.setLatLng(a.latlng),this._map.openPopup(this._popup)}}),e.Browser.vml=!e.Browser.svg&&function(){try{var a=b.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&"object"==typeof c.adj}catch(d){return!1}}(),e.Path=e.Browser.svg||!e.Browser.vml?e.Path:e.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return b.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return b.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var a=this._container=this._createElement("shape");e.DomUtil.addClass(a,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&e.DomUtil.addClass(a,"leaflet-clickable"),a.coordsize="1 1",this._path=this._createElement("path"),a.appendChild(this._path),this._map._pathRoot.appendChild(a)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var a=this._stroke,b=this._fill,c=this.options,d=this._container;d.stroked=c.stroke,d.filled=c.fill,c.stroke?(a||(a=this._stroke=this._createElement("stroke"),a.endcap="round",d.appendChild(a)),a.weight=c.weight+"px",a.color=c.color,a.opacity=c.opacity,c.dashArray?a.dashStyle=e.Util.isArray(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):a.dashStyle="",c.lineCap&&(a.endcap=c.lineCap.replace("butt","flat")),c.lineJoin&&(a.joinstyle=c.lineJoin)):a&&(d.removeChild(a),this._stroke=null),c.fill?(b||(b=this._fill=this._createElement("fill"),d.appendChild(b)),b.color=c.fillColor||c.color,b.opacity=c.fillOpacity):b&&(d.removeChild(b),this._fill=null)},_updatePath:function(){var a=this._container.style;a.display="none",this._path.v=this.getPathString()+" ",a.display=""}}),e.Map.include(e.Browser.svg||!e.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var a=this._pathRoot=b.createElement("div");a.className="leaflet-vml-container",this._panes.overlayPane.appendChild(a),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),e.Browser.canvas=function(){return!!b.createElement("canvas").getContext}(),e.Path=e.Path.SVG&&!a.L_PREFER_CANVAS||!e.Browser.canvas?e.Path:e.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(a){return e.setOptions(this,a),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(a){a.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!e.Path._updateRequest&&(e.Path._updateRequest=e.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){e.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var a=this.options;a.stroke&&(this._ctx.lineWidth=a.weight,this._ctx.strokeStyle=a.color),a.fill&&(this._ctx.fillStyle=a.fillColor||a.color),a.lineCap&&(this._ctx.lineCap=a.lineCap),a.lineJoin&&(this._ctx.lineJoin=a.lineJoin)},_drawPath:function(){var a,b,c,d,f,g;for(this._ctx.beginPath(),a=0,c=this._parts.length;c>a;a++){for(b=0,d=this._parts[a].length;d>b;b++)f=this._parts[a][b],g=(0===b?"move":"line")+"To",this._ctx[g](f.x,f.y);this instanceof e.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var a=this._ctx,b=this.options;this._drawPath(),a.save(),this._updateStyle(),b.fill&&(a.globalAlpha=b.fillOpacity,a.fill(b.fillRule||"evenodd")),b.stroke&&(a.globalAlpha=b.opacity,a.stroke()),a.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(a){this._containsPoint(a.layerPoint)&&this.fire(a.type,a)},_onMouseMove:function(a){this._map&&!this._map._animatingZoom&&(this._containsPoint(a.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",a)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",a)))}}),e.Map.include(e.Path.SVG&&!a.L_PREFER_CANVAS||!e.Browser.canvas?{}:{_initPathRoot:function(){var a,c=this._pathRoot;c||(c=this._pathRoot=b.createElement("canvas"),c.style.position="absolute",a=this._canvasCtx=c.getContext("2d"),a.lineCap="round",a.lineJoin="round",this._panes.overlayPane.appendChild(c),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,b=a.min,c=a.max.subtract(b),d=this._pathRoot;e.DomUtil.setPosition(d,b),d.width=c.x,d.height=c.y,d.getContext("2d").translate(-b.x,-b.y)}}}),e.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,c),a=this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var d=a.length,e=typeof Uint8Array!=c+""?Uint8Array:Array,f=new e(d);f[0]=f[d-1]=1,this._simplifyDPStep(a,f,b,0,d-1);var g,h=[];for(g=0;d>g;g++)f[g]&&h.push(a[g]);return h},_simplifyDPStep:function(a,b,c,d,e){var f,g,h,i=0;for(g=d+1;e-1>=g;g++)h=this._sqClosestPointOnSegment(a[g],a[d],a[e],!0),h>i&&(f=g,i=h);i>c&&(b[f]=1,this._simplifyDPStep(a,b,c,d,f),this._simplifyDPStep(a,b,c,f,e))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,e=0,f=a.length;f>d;d++)this._sqDist(a[d],a[e])>b&&(c.push(a[d]),e=d);return f-1>e&&c.push(a[f-1]),c},clipSegment:function(a,b,c,d){var e,f,g,h=d?this._lastCode:this._getBitCode(a,c),i=this._getBitCode(b,c);for(this._lastCode=i;;){if(!(h|i))return[a,b];if(h&i)return!1;e=h||i,f=this._getEdgeIntersection(a,b,e,c),g=this._getBitCode(f,c),e===h?(a=f,h=g):(b=f,i=g)}},_getEdgeIntersection:function(a,b,c,d){var f=b.x-a.x,g=b.y-a.y,h=d.min,i=d.max;return 8&c?new e.Point(a.x+f*(i.y-a.y)/g,i.y):4&c?new e.Point(a.x+f*(h.y-a.y)/g,h.y):2&c?new e.Point(i.x,a.y+g*(i.x-a.x)/f):1&c?new e.Point(h.x,a.y+g*(h.x-a.x)/f):void 0},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,b,c,d){var f,g=b.x,h=b.y,i=c.x-g,j=c.y-h,k=i*i+j*j;return k>0&&(f=((a.x-g)*i+(a.y-h)*j)/k,f>1?(g=c.x,h=c.y):f>0&&(g+=i*f,h+=j*f)),i=a.x-g,j=a.y-h,d?i*i+j*j:new e.Point(g,h)}},e.Polyline=e.Path.extend({initialize:function(a,b){e.Path.prototype.initialize.call(this,b),this._latlngs=this._convertLatLngs(a)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;b>a;a++)this._originalPoints[a]=this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=0,b=this._parts.length,c="";b>a;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._latlngs=this._convertLatLngs(a),this.redraw()},addLatLng:function(a){return this._latlngs.push(e.latLng(a)),this.redraw()},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),a},closestLayerPoint:function(a){for(var b,c,d=1/0,f=this._parts,g=null,h=0,i=f.length;i>h;h++)for(var j=f[h],k=1,l=j.length;l>k;k++){b=j[k-1],c=j[k];var m=e.LineUtil._sqClosestPointOnSegment(a,b,c,!0);d>m&&(d=m,g=e.LineUtil._sqClosestPointOnSegment(a,b,c))}return g&&(g.distance=Math.sqrt(d)),g},getBounds:function(){return new e.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(a,b){var c,d,f=b?a:[];for(c=0,d=a.length;d>c;c++){if(e.Util.isArray(a[c])&&"number"!=typeof a[c][0])return;f[c]=e.latLng(a[c])}return f},_initEvents:function(){e.Path.prototype._initEvents.call(this)},_getPathPartStr:function(a){for(var b,c=e.Path.VML,d=0,f=a.length,g="";f>d;d++)b=a[d],c&&b._round(),g+=(d?"L":"M")+b.x+" "+b.y;return g},_clipPoints:function(){var a,b,c,d=this._originalPoints,f=d.length;if(this.options.noClip)return void(this._parts=[d]);this._parts=[];var g=this._parts,h=this._map._pathViewport,i=e.LineUtil;for(a=0,b=0;f-1>a;a++)c=i.clipSegment(d[a],d[a+1],h,a),c&&(g[b]=g[b]||[],g[b].push(c[0]),(c[1]!==d[a+1]||a===f-2)&&(g[b].push(c[1]),b++))},_simplifyPoints:function(){for(var a=this._parts,b=e.LineUtil,c=0,d=a.length;d>c;c++)a[c]=b.simplify(a[c],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),e.Path.prototype._updatePath.call(this))}}),e.polyline=function(a,b){return new e.Polyline(a,b)},e.PolyUtil={},e.PolyUtil.clipPolygon=function(a,b){var c,d,f,g,h,i,j,k,l,m=[1,4,2,8],n=e.LineUtil;for(d=0,j=a.length;j>d;d++)a[d]._code=n._getBitCode(a[d],b);for(g=0;4>g;g++){for(k=m[g],c=[],d=0,j=a.length,f=j-1;j>d;f=d++)h=a[d],i=a[f],h._code&k?i._code&k||(l=n._getEdgeIntersection(i,h,k,b),l._code=n._getBitCode(l,b),c.push(l)):(i._code&k&&(l=n._getEdgeIntersection(i,h,k,b),l._code=n._getBitCode(l,b),c.push(l)),c.push(h));a=c}return a},e.Polygon=e.Polyline.extend({options:{fill:!0},initialize:function(a,b){e.Polyline.prototype.initialize.call(this,a,b),this._initWithHoles(a)},_initWithHoles:function(a){var b,c,d;if(a&&e.Util.isArray(a[0])&&"number"!=typeof a[0][0])for(this._latlngs=this._convertLatLngs(a[0]),this._holes=a.slice(1),b=0,c=this._holes.length;c>b;b++)d=this._holes[b]=this._convertLatLngs(this._holes[b]),d[0].equals(d[d.length-1])&&d.pop();a=this._latlngs,a.length>=2&&a[0].equals(a[a.length-1])&&a.pop()},projectLatlngs:function(){if(e.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var a,b,c,d;for(a=0,c=this._holes.length;c>a;a++)for(this._holePoints[a]=[],b=0,d=this._holes[a].length;d>b;b++)this._holePoints[a][b]=this._map.latLngToLayerPoint(this._holes[a][b])}},setLatLngs:function(a){return a&&e.Util.isArray(a[0])&&"number"!=typeof a[0][0]?(this._initWithHoles(a),this.redraw()):e.Polyline.prototype.setLatLngs.call(this,a)},_clipPoints:function(){var a=this._originalPoints,b=[];if(this._parts=[a].concat(this._holePoints),!this.options.noClip){for(var c=0,d=this._parts.length;d>c;c++){var f=e.PolyUtil.clipPolygon(this._parts[c],this._map._pathViewport);f.length&&b.push(f)}this._parts=b}},_getPathPartStr:function(a){var b=e.Polyline.prototype._getPathPartStr.call(this,a);return b+(e.Browser.svg?"z":"x")}}),e.polygon=function(a,b){return new e.Polygon(a,b)},function(){function a(a){return e.FeatureGroup.extend({initialize:function(a,b){this._layers={},this._options=b,this.setLatLngs(a)},setLatLngs:function(b){var c=0,d=b.length;for(this.eachLayer(function(a){d>c?a.setLatLngs(b[c++]):this.removeLayer(a)},this);d>c;)this.addLayer(new a(b[c++],this._options));return this},getLatLngs:function(){var a=[];return this.eachLayer(function(b){a.push(b.getLatLngs())}),a}})}e.MultiPolyline=a(e.Polyline),e.MultiPolygon=a(e.Polygon),e.multiPolyline=function(a,b){return new e.MultiPolyline(a,b)},e.multiPolygon=function(a,b){return new e.MultiPolygon(a,b)}}(),e.Rectangle=e.Polygon.extend({initialize:function(a,b){e.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=e.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}}),e.rectangle=function(a,b){return new e.Rectangle(a,b)},e.Circle=e.Path.extend({initialize:function(a,b,c){e.Path.prototype.initialize.call(this,c),this._latlng=e.latLng(a),this._mRadius=b},options:{fill:!0},setLatLng:function(a){return this._latlng=e.latLng(a),this.redraw()},setRadius:function(a){return this._mRadius=a,this.redraw()},projectLatlngs:function(){var a=this._getLngRadius(),b=this._latlng,c=this._map.latLngToLayerPoint([b.lat,b.lng-a]);this._point=this._map.latLngToLayerPoint(b),this._radius=Math.max(this._point.x-c.x,1)},getBounds:function(){var a=this._getLngRadius(),b=this._mRadius/40075017*360,c=this._latlng;return new e.LatLngBounds([c.lat-b,c.lng-a],[c.lat+b,c.lng+a])},getLatLng:function(){return this._latlng},getPathString:function(){var a=this._point,b=this._radius;return this._checkIfEmpty()?"":e.Browser.svg?"M"+a.x+","+(a.y-b)+"A"+b+","+b+",0,1,1,"+(a.x-.1)+","+(a.y-b)+" z":(a._round(),b=Math.round(b),"AL "+a.x+","+a.y+" "+b+","+b+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(e.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var a=this._map._pathViewport,b=this._radius,c=this._point;return c.x-b>a.max.x||c.y-b>a.max.y||c.x+b<a.min.x||c.y+b<a.min.y}}),e.circle=function(a,b,c){return new e.Circle(a,b,c)},e.CircleMarker=e.Circle.extend({options:{radius:10,weight:2},initialize:function(a,b){e.Circle.prototype.initialize.call(this,a,null,b),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){e.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(a){return e.Circle.prototype.setLatLng.call(this,a),this._popup&&this._popup._isOpen&&this._popup.setLatLng(a),this},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius}}),e.circleMarker=function(a,b){return new e.CircleMarker(a,b)},e.Polyline.include(e.Path.CANVAS?{_containsPoint:function(a,b){var c,d,f,g,h,i,j,k=this.options.weight/2;for(e.Browser.touch&&(k+=10),c=0,g=this._parts.length;g>c;c++)for(j=this._parts[c],d=0,h=j.length,f=h-1;h>d;f=d++)if((b||0!==d)&&(i=e.LineUtil.pointToSegmentDistance(a,j[f],j[d]),k>=i))return!0;return!1}}:{}),e.Polygon.include(e.Path.CANVAS?{_containsPoint:function(a){var b,c,d,f,g,h,i,j,k=!1;if(e.Polyline.prototype._containsPoint.call(this,a,!0))return!0;for(f=0,i=this._parts.length;i>f;f++)for(b=this._parts[f],g=0,j=b.length,h=j-1;j>g;h=g++)c=b[g],d=b[h],c.y>a.y!=d.y>a.y&&a.x<(d.x-c.x)*(a.y-c.y)/(d.y-c.y)+c.x&&(k=!k);return k}}:{}),e.Circle.include(e.Path.CANVAS?{_drawPath:function(){var a=this._point;this._ctx.beginPath(),this._ctx.arc(a.x,a.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(a){var b=this._point,c=this.options.stroke?this.options.weight/2:0;return a.distanceTo(b)<=this._radius+c}}:{}),e.CircleMarker.include(e.Path.CANVAS?{_updateStyle:function(){e.Path.prototype._updateStyle.call(this)}}:{}),e.GeoJSON=e.FeatureGroup.extend({initialize:function(a,b){e.setOptions(this,b),this._layers={},a&&this.addData(a)},addData:function(a){var b,c,d,f=e.Util.isArray(a)?a:a.features;if(f){for(b=0,c=f.length;c>b;b++)d=f[b],(d.geometries||d.geometry||d.features||d.coordinates)&&this.addData(f[b]);return this}var g=this.options;if(!g.filter||g.filter(a)){var h=e.GeoJSON.geometryToLayer(a,g.pointToLayer,g.coordsToLatLng,g);return h.feature=e.GeoJSON.asFeature(a),h.defaultOptions=h.options,this.resetStyle(h),g.onEachFeature&&g.onEachFeature(a,h),this.addLayer(h)}},resetStyle:function(a){var b=this.options.style;b&&(e.Util.extend(a.options,a.defaultOptions),this._setLayerStyle(a,b))},setStyle:function(a){this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature)),a.setStyle&&a.setStyle(b)}}),e.extend(e.GeoJSON,{geometryToLayer:function(a,b,c,d){var f,g,h,i,j="Feature"===a.type?a.geometry:a,k=j.coordinates,l=[];switch(c=c||this.coordsToLatLng,j.type){case"Point":return f=c(k),b?b(a,f):new e.Marker(f);case"MultiPoint":for(h=0,i=k.length;i>h;h++)f=c(k[h]),l.push(b?b(a,f):new e.Marker(f));return new e.FeatureGroup(l);case"LineString":return g=this.coordsToLatLngs(k,0,c),new e.Polyline(g,d);case"Polygon":if(2===k.length&&!k[1].length)throw new Error("Invalid GeoJSON object.");return g=this.coordsToLatLngs(k,1,c),new e.Polygon(g,d);case"MultiLineString":return g=this.coordsToLatLngs(k,1,c),new e.MultiPolyline(g,d);case"MultiPolygon":return g=this.coordsToLatLngs(k,2,c),new e.MultiPolygon(g,d);case"GeometryCollection":for(h=0,i=j.geometries.length;i>h;h++)l.push(this.geometryToLayer({geometry:j.geometries[h],type:"Feature",properties:a.properties},b,c,d));return new e.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(a){return new e.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){var d,e,f,g=[];for(e=0,f=a.length;f>e;e++)d=b?this.coordsToLatLngs(a[e],b-1,c):(c||this.coordsToLatLng)(a[e]),g.push(d);return g},latLngToCoords:function(a){var b=[a.lng,a.lat];return a.alt!==c&&b.push(a.alt),b},latLngsToCoords:function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(e.GeoJSON.latLngToCoords(a[c]));return b},getFeature:function(a,b){return a.feature?e.extend({},a.feature,{geometry:b}):e.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var g={toGeoJSON:function(){return e.GeoJSON.getFeature(this,{type:"Point",coordinates:e.GeoJSON.latLngToCoords(this.getLatLng())})}};e.Marker.include(g),e.Circle.include(g),e.CircleMarker.include(g),e.Polyline.include({toGeoJSON:function(){return e.GeoJSON.getFeature(this,{type:"LineString",coordinates:e.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),e.Polygon.include({toGeoJSON:function(){var a,b,c,d=[e.GeoJSON.latLngsToCoords(this.getLatLngs())];if(d[0].push(d[0][0]),this._holes)for(a=0,b=this._holes.length;b>a;a++)c=e.GeoJSON.latLngsToCoords(this._holes[a]),c.push(c[0]),d.push(c);return e.GeoJSON.getFeature(this,{type:"Polygon",coordinates:d})}}),function(){function a(a){return function(){var b=[];return this.eachLayer(function(a){b.push(a.toGeoJSON().geometry.coordinates)}),e.GeoJSON.getFeature(this,{type:a,coordinates:b})}}e.MultiPolyline.include({toGeoJSON:a("MultiLineString")}),e.MultiPolygon.include({toGeoJSON:a("MultiPolygon")}),e.LayerGroup.include({toGeoJSON:function(){var b,c=this.feature&&this.feature.geometry,d=[];if(c&&"MultiPoint"===c.type)return a("MultiPoint").call(this);var f=c&&"GeometryCollection"===c.type;return this.eachLayer(function(a){a.toGeoJSON&&(b=a.toGeoJSON(),d.push(f?b.geometry:e.GeoJSON.asFeature(b)))}),f?e.GeoJSON.getFeature(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}})}(),e.geoJson=function(a,b){return new e.GeoJSON(a,b)},e.DomEvent={addListener:function(a,b,c,d){var f,g,h,i=e.stamp(c),j="_leaflet_"+b+i;return a[j]?this:(f=function(b){return c.call(d||a,b||e.DomEvent._getEvent())},e.Browser.pointer&&0===b.indexOf("touch")?this.addPointerListener(a,b,f,i):(e.Browser.touch&&"dblclick"===b&&this.addDoubleTapListener&&this.addDoubleTapListener(a,f,i),"addEventListener"in a?"mousewheel"===b?(a.addEventListener("DOMMouseScroll",f,!1),a.addEventListener(b,f,!1)):"mouseenter"===b||"mouseleave"===b?(g=f,h="mouseenter"===b?"mouseover":"mouseout",f=function(b){return e.DomEvent._checkMouse(a,b)?g(b):void 0},a.addEventListener(h,f,!1)):"click"===b&&e.Browser.android?(g=f,f=function(a){return e.DomEvent._filterClick(a,g)},a.addEventListener(b,f,!1)):a.addEventListener(b,f,!1):"attachEvent"in a&&a.attachEvent("on"+b,f),a[j]=f,this))},removeListener:function(a,b,c){var d=e.stamp(c),f="_leaflet_"+b+d,g=a[f];return g?(e.Browser.pointer&&0===b.indexOf("touch")?this.removePointerListener(a,b,d):e.Browser.touch&&"dblclick"===b&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,d):"removeEventListener"in a?"mousewheel"===b?(a.removeEventListener("DOMMouseScroll",g,!1),a.removeEventListener(b,g,!1)):"mouseenter"===b||"mouseleave"===b?a.removeEventListener("mouseenter"===b?"mouseover":"mouseout",g,!1):a.removeEventListener(b,g,!1):"detachEvent"in a&&a.detachEvent("on"+b,g),a[f]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,e.DomEvent._skipped(a),this},disableScrollPropagation:function(a){var b=e.DomEvent.stopPropagation;return e.DomEvent.on(a,"mousewheel",b).on(a,"MozMousePixelScroll",b)},disableClickPropagation:function(a){for(var b=e.DomEvent.stopPropagation,c=e.Draggable.START.length-1;c>=0;c--)e.DomEvent.on(a,e.Draggable.START[c],b);return e.DomEvent.on(a,"click",e.DomEvent._fakeStop).on(a,"dblclick",b)},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return e.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){if(!b)return new e.Point(a.clientX,a.clientY);var c=b.getBoundingClientRect();return new e.Point(a.clientX-c.left-b.clientLeft,a.clientY-c.top-b.clientTop)},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/120),a.detail&&(b=-a.detail/3),b},_skipEvents:{},_fakeStop:function(a){e.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,b},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(d){return!1}return c!==a},_getEvent:function(){var b=a.event;if(!b)for(var c=arguments.callee.caller;c&&(b=c.arguments[0],!b||a.Event!==b.constructor);)c=c.caller;return b},_filterClick:function(a,b){var c=a.timeStamp||a.originalEvent.timeStamp,d=e.DomEvent._lastClick&&c-e.DomEvent._lastClick;return d&&d>100&&500>d||a.target._simulatedClick&&!a._simulated?void e.DomEvent.stop(a):(e.DomEvent._lastClick=c,b(a))}},e.DomEvent.on=e.DomEvent.addListener,e.DomEvent.off=e.DomEvent.removeListener,e.Draggable=e.Class.extend({includes:e.Mixin.Events,statics:{START:e.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b){this._element=a,this._dragStartTarget=b||a},enable:function(){if(!this._enabled){for(var a=e.Draggable.START.length-1;a>=0;a--)e.DomEvent.on(this._dragStartTarget,e.Draggable.START[a],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var a=e.Draggable.START.length-1;a>=0;a--)e.DomEvent.off(this._dragStartTarget,e.Draggable.START[a],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(a){if(this._moved=!1,!a.shiftKey&&(1===a.which||1===a.button||a.touches)&&(e.DomEvent.stopPropagation(a),!e.Draggable._disabled&&(e.DomUtil.disableImageDrag(),e.DomUtil.disableTextSelection(),!this._moving))){var c=a.touches?a.touches[0]:a;this._startPoint=new e.Point(c.clientX,c.clientY),this._startPos=this._newPos=e.DomUtil.getPosition(this._element),e.DomEvent.on(b,e.Draggable.MOVE[a.type],this._onMove,this).on(b,e.Draggable.END[a.type],this._onUp,this)}},_onMove:function(a){if(a.touches&&a.touches.length>1)return void(this._moved=!0);var c=a.touches&&1===a.touches.length?a.touches[0]:a,d=new e.Point(c.clientX,c.clientY),f=d.subtract(this._startPoint);(f.x||f.y)&&(e.Browser.touch&&Math.abs(f.x)+Math.abs(f.y)<3||(e.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=e.DomUtil.getPosition(this._element).subtract(f),e.DomUtil.addClass(b.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,e.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,e.Util.cancelAnimFrame(this._animRequest),this._animRequest=e.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),e.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){e.DomUtil.removeClass(b.body,"leaflet-dragging"),this._lastTarget&&(e.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in e.Draggable.MOVE)e.DomEvent.off(b,e.Draggable.MOVE[a],this._onMove).off(b,e.Draggable.END[a],this._onUp);e.DomUtil.enableImageDrag(),e.DomUtil.enableTextSelection(),this._moved&&this._moving&&(e.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),e.Handler=e.Class.extend({initialize:function(a){this._map=a},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),e.Map.mergeOptions({dragging:!0,inertia:!e.Browser.android23,inertiaDeceleration:3400,
inertiaMaxSpeed:1/0,inertiaThreshold:e.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),e.Map.Drag=e.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new e.Draggable(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),a.on("viewreset",this._onViewReset,this),a.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var a=this._map;a._panAnim&&a._panAnim.stop(),a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var a=this._lastTime=+new Date,b=this._lastPos=this._draggable._newPos;this._positions.push(b),this._times.push(a),a-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var a=this._map.getSize()._divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(a).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,f=(d+b+c)%a-b-c,g=Math.abs(e+c)<Math.abs(f+c)?e:f;this._draggable._newPos.x=g},_onDragEnd:function(a){var b=this._map,c=b.options,d=+new Date-this._lastTime,f=!c.inertia||d>c.inertiaThreshold||!this._positions[0];if(b.fire("dragend",a),f)b.fire("moveend");else{var g=this._lastPos.subtract(this._positions[0]),h=(this._lastTime+d-this._times[0])/1e3,i=c.easeLinearity,j=g.multiplyBy(i/h),k=j.distanceTo([0,0]),l=Math.min(c.inertiaMaxSpeed,k),m=j.multiplyBy(l/k),n=l/(c.inertiaDeceleration*i),o=m.multiplyBy(-n/2).round();o.x&&o.y?(o=b._limitOffset(o,b.options.maxBounds),e.Util.requestAnimFrame(function(){b.panBy(o,{duration:n,easeLinearity:i,noMoveStart:!0})})):b.fire("moveend")}}}),e.Map.addInitHook("addHandler","dragging",e.Map.Drag),e.Map.mergeOptions({doubleClickZoom:!0}),e.Map.DoubleClickZoom=e.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom()+(a.originalEvent.shiftKey?-1:1);"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,c)}}),e.Map.addInitHook("addHandler","doubleClickZoom",e.Map.DoubleClickZoom),e.Map.mergeOptions({scrollWheelZoom:!0}),e.Map.ScrollWheelZoom=e.Handler.extend({addHooks:function(){e.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),e.DomEvent.on(this._map._container,"MozMousePixelScroll",e.DomEvent.preventDefault),this._delta=0},removeHooks:function(){e.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),e.DomEvent.off(this._map._container,"MozMousePixelScroll",e.DomEvent.preventDefault)},_onWheelScroll:function(a){var b=e.DomEvent.getWheelDelta(a);this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var c=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(e.bind(this._performZoom,this),c),e.DomEvent.preventDefault(a),e.DomEvent.stopPropagation(a)},_performZoom:function(){var a=this._map,b=this._delta,c=a.getZoom();b=b>0?Math.ceil(b):Math.floor(b),b=Math.max(Math.min(b,4),-4),b=a._limitZoom(c+b)-c,this._delta=0,this._startTime=null,b&&("center"===a.options.scrollWheelZoom?a.setZoom(c+b):a.setZoomAround(this._lastMousePos,c+b))}}),e.Map.addInitHook("addHandler","scrollWheelZoom",e.Map.ScrollWheelZoom),e.extend(e.DomEvent,{_touchstart:e.Browser.msPointer?"MSPointerDown":e.Browser.pointer?"pointerdown":"touchstart",_touchend:e.Browser.msPointer?"MSPointerUp":e.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,c,d){function f(a){var b;if(e.Browser.pointer?(o.push(a.pointerId),b=o.length):b=a.touches.length,!(b>1)){var c=Date.now(),d=c-(h||c);i=a.touches?a.touches[0]:a,j=d>0&&k>=d,h=c}}function g(a){if(e.Browser.pointer){var b=o.indexOf(a.pointerId);if(-1===b)return;o.splice(b,1)}if(j){if(e.Browser.pointer){var d,f={};for(var g in i)d=i[g],"function"==typeof d?f[g]=d.bind(i):f[g]=d;i=f}i.type="dblclick",c(i),h=null}}var h,i,j=!1,k=250,l="_leaflet_",m=this._touchstart,n=this._touchend,o=[];a[l+m+d]=f,a[l+n+d]=g;var p=e.Browser.pointer?b.documentElement:a;return a.addEventListener(m,f,!1),p.addEventListener(n,g,!1),e.Browser.pointer&&p.addEventListener(e.DomEvent.POINTER_CANCEL,g,!1),this},removeDoubleTapListener:function(a,c){var d="_leaflet_";return a.removeEventListener(this._touchstart,a[d+this._touchstart+c],!1),(e.Browser.pointer?b.documentElement:a).removeEventListener(this._touchend,a[d+this._touchend+c],!1),e.Browser.pointer&&b.documentElement.removeEventListener(e.DomEvent.POINTER_CANCEL,a[d+this._touchend+c],!1),this}}),e.extend(e.DomEvent,{POINTER_DOWN:e.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:e.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:e.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:e.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(a,b,c,d){switch(b){case"touchstart":return this.addPointerListenerStart(a,b,c,d);case"touchend":return this.addPointerListenerEnd(a,b,c,d);case"touchmove":return this.addPointerListenerMove(a,b,c,d);default:throw"Unknown touch event type"}},addPointerListenerStart:function(a,c,d,f){var g="_leaflet_",h=this._pointers,i=function(a){"mouse"!==a.pointerType&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&e.DomEvent.preventDefault(a);for(var b=!1,c=0;c<h.length;c++)if(h[c].pointerId===a.pointerId){b=!0;break}b||h.push(a),a.touches=h.slice(),a.changedTouches=[a],d(a)};if(a[g+"touchstart"+f]=i,a.addEventListener(this.POINTER_DOWN,i,!1),!this._pointerDocumentListener){var j=function(a){for(var b=0;b<h.length;b++)if(h[b].pointerId===a.pointerId){h.splice(b,1);break}};b.documentElement.addEventListener(this.POINTER_UP,j,!1),b.documentElement.addEventListener(this.POINTER_CANCEL,j,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(a,b,c,d){function e(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons){for(var b=0;b<g.length;b++)if(g[b].pointerId===a.pointerId){g[b]=a;break}a.touches=g.slice(),a.changedTouches=[a],c(a)}}var f="_leaflet_",g=this._pointers;return a[f+"touchmove"+d]=e,a.addEventListener(this.POINTER_MOVE,e,!1),this},addPointerListenerEnd:function(a,b,c,d){var e="_leaflet_",f=this._pointers,g=function(a){for(var b=0;b<f.length;b++)if(f[b].pointerId===a.pointerId){f.splice(b,1);break}a.touches=f.slice(),a.changedTouches=[a],c(a)};return a[e+"touchend"+d]=g,a.addEventListener(this.POINTER_UP,g,!1),a.addEventListener(this.POINTER_CANCEL,g,!1),this},removePointerListener:function(a,b,c){var d="_leaflet_",e=a[d+b+c];switch(b){case"touchstart":a.removeEventListener(this.POINTER_DOWN,e,!1);break;case"touchmove":a.removeEventListener(this.POINTER_MOVE,e,!1);break;case"touchend":a.removeEventListener(this.POINTER_UP,e,!1),a.removeEventListener(this.POINTER_CANCEL,e,!1)}return this}}),e.Map.mergeOptions({touchZoom:e.Browser.touch&&!e.Browser.android23,bounceAtZoomLimits:!0}),e.Map.TouchZoom=e.Handler.extend({addHooks:function(){e.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){e.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===a.touches.length&&!c._animatingZoom&&!this._zooming){var d=c.mouseEventToLayerPoint(a.touches[0]),f=c.mouseEventToLayerPoint(a.touches[1]),g=c._getCenterLayerPoint();this._startCenter=d.add(f)._divideBy(2),this._startDist=d.distanceTo(f),this._moved=!1,this._zooming=!0,this._centerOffset=g.subtract(this._startCenter),c._panAnim&&c._panAnim.stop(),e.DomEvent.on(b,"touchmove",this._onTouchMove,this).on(b,"touchend",this._onTouchEnd,this),e.DomEvent.preventDefault(a)}},_onTouchMove:function(a){var b=this._map;if(a.touches&&2===a.touches.length&&this._zooming){var c=b.mouseEventToLayerPoint(a.touches[0]),d=b.mouseEventToLayerPoint(a.touches[1]);this._scale=c.distanceTo(d)/this._startDist,this._delta=c._add(d)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(b.options.bounceAtZoomLimits||!(b.getZoom()===b.getMinZoom()&&this._scale<1||b.getZoom()===b.getMaxZoom()&&this._scale>1))&&(this._moved||(e.DomUtil.addClass(b._mapPane,"leaflet-touching"),b.fire("movestart").fire("zoomstart"),this._moved=!0),e.Util.cancelAnimFrame(this._animRequest),this._animRequest=e.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),e.DomEvent.preventDefault(a))}},_updateOnMove:function(){var a=this._map,b=this._getScaleOrigin(),c=a.layerPointToLatLng(b),d=a.getScaleZoom(this._scale);a._animateZoom(c,d,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var a=this._map;this._zooming=!1,e.DomUtil.removeClass(a._mapPane,"leaflet-touching"),e.Util.cancelAnimFrame(this._animRequest),e.DomEvent.off(b,"touchmove",this._onTouchMove).off(b,"touchend",this._onTouchEnd);var c=this._getScaleOrigin(),d=a.layerPointToLatLng(c),f=a.getZoom(),g=a.getScaleZoom(this._scale)-f,h=g>0?Math.ceil(g):Math.floor(g),i=a._limitZoom(f+h),j=a.getZoomScale(i)/this._scale;a._animateZoom(d,i,c,j)},_getScaleOrigin:function(){var a=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(a)}}),e.Map.addInitHook("addHandler","touchZoom",e.Map.TouchZoom),e.Map.mergeOptions({tap:!0,tapTolerance:15}),e.Map.Tap=e.Handler.extend({addHooks:function(){e.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){e.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(e.DomEvent.preventDefault(a),this._fireClick=!0,a.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var c=a.touches[0],d=c.target;this._startPos=this._newPos=new e.Point(c.clientX,c.clientY),d.tagName&&"a"===d.tagName.toLowerCase()&&e.DomUtil.addClass(d,"leaflet-active"),this._holdTimeout=setTimeout(e.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1e3),e.DomEvent.on(b,"touchmove",this._onMove,this).on(b,"touchend",this._onUp,this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),e.DomEvent.off(b,"touchmove",this._onMove,this).off(b,"touchend",this._onUp,this),this._fireClick&&a&&a.changedTouches){var c=a.changedTouches[0],d=c.target;d&&d.tagName&&"a"===d.tagName.toLowerCase()&&e.DomUtil.removeClass(d,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",c)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){var b=a.touches[0];this._newPos=new e.Point(b.clientX,b.clientY)},_simulateEvent:function(c,d){var e=b.createEvent("MouseEvents");e._simulated=!0,d.target._simulatedClick=!0,e.initMouseEvent(c,!0,!0,a,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(e)}}),e.Browser.touch&&!e.Browser.pointer&&e.Map.addInitHook("addHandler","tap",e.Map.Tap),e.Map.mergeOptions({boxZoom:!0}),e.Map.BoxZoom=e.Handler.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._moved=!1},addHooks:function(){e.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){e.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(a){return this._moved=!1,!a.shiftKey||1!==a.which&&1!==a.button?!1:(e.DomUtil.disableTextSelection(),e.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(a),void e.DomEvent.on(b,"mousemove",this._onMouseMove,this).on(b,"mouseup",this._onMouseUp,this).on(b,"keydown",this._onKeyDown,this))},_onMouseMove:function(a){this._moved||(this._box=e.DomUtil.create("div","leaflet-zoom-box",this._pane),e.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var b=this._startLayerPoint,c=this._box,d=this._map.mouseEventToLayerPoint(a),f=d.subtract(b),g=new e.Point(Math.min(d.x,b.x),Math.min(d.y,b.y));e.DomUtil.setPosition(c,g),this._moved=!0,c.style.width=Math.max(0,Math.abs(f.x)-4)+"px",c.style.height=Math.max(0,Math.abs(f.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),e.DomUtil.enableTextSelection(),e.DomUtil.enableImageDrag(),e.DomEvent.off(b,"mousemove",this._onMouseMove).off(b,"mouseup",this._onMouseUp).off(b,"keydown",this._onKeyDown)},_onMouseUp:function(a){this._finish();var b=this._map,c=b.mouseEventToLayerPoint(a);if(!this._startLayerPoint.equals(c)){var d=new e.LatLngBounds(b.layerPointToLatLng(this._startLayerPoint),b.layerPointToLatLng(c));b.fitBounds(d),b.fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(a){27===a.keyCode&&this._finish()}}),e.Map.addInitHook("addHandler","boxZoom",e.Map.BoxZoom),e.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),e.Map.Keyboard=e.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(a){this._map=a,this._setPanOffset(a.options.keyboardPanOffset),this._setZoomOffset(a.options.keyboardZoomOffset)},addHooks:function(){var a=this._map._container;-1===a.tabIndex&&(a.tabIndex="0"),e.DomEvent.on(a,"focus",this._onFocus,this).on(a,"blur",this._onBlur,this).on(a,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var a=this._map._container;e.DomEvent.off(a,"focus",this._onFocus,this).off(a,"blur",this._onBlur,this).off(a,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var c=b.body,d=b.documentElement,e=c.scrollTop||d.scrollTop,f=c.scrollLeft||d.scrollLeft;this._map._container.focus(),a.scrollTo(f,e)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(a){var b,c,d=this._panKeys={},e=this.keyCodes;for(b=0,c=e.left.length;c>b;b++)d[e.left[b]]=[-1*a,0];for(b=0,c=e.right.length;c>b;b++)d[e.right[b]]=[a,0];for(b=0,c=e.down.length;c>b;b++)d[e.down[b]]=[0,a];for(b=0,c=e.up.length;c>b;b++)d[e.up[b]]=[0,-1*a]},_setZoomOffset:function(a){var b,c,d=this._zoomKeys={},e=this.keyCodes;for(b=0,c=e.zoomIn.length;c>b;b++)d[e.zoomIn[b]]=a;for(b=0,c=e.zoomOut.length;c>b;b++)d[e.zoomOut[b]]=-a},_addHooks:function(){e.DomEvent.on(b,"keydown",this._onKeyDown,this)},_removeHooks:function(){e.DomEvent.off(b,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){var b=a.keyCode,c=this._map;if(b in this._panKeys){if(c._panAnim&&c._panAnim._inProgress)return;c.panBy(this._panKeys[b]),c.options.maxBounds&&c.panInsideBounds(c.options.maxBounds)}else{if(!(b in this._zoomKeys))return;c.setZoom(c.getZoom()+this._zoomKeys[b])}e.DomEvent.stop(a)}}),e.Map.addInitHook("addHandler","keyboard",e.Map.Keyboard),e.Handler.MarkerDrag=e.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new e.Draggable(a,a)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),e.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),e.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var a=this._marker,b=a._shadow,c=e.DomUtil.getPosition(a._icon),d=a._map.layerPointToLatLng(c);b&&e.DomUtil.setPosition(b,c),a._latlng=d,a.fire("move",{latlng:d}).fire("drag")},_onDragEnd:function(a){this._marker.fire("moveend").fire("dragend",a)}}),e.Control=e.Class.extend({options:{position:"topright"},initialize:function(a){e.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition(),d=a._controlCorners[c];return e.DomUtil.addClass(b,"leaflet-control"),-1!==c.indexOf("bottom")?d.insertBefore(b,d.firstChild):d.appendChild(b),this},removeFrom:function(a){var b=this.getPosition(),c=a._controlCorners[b];return c.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(a),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),e.control=function(a){return new e.Control(a)},e.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.removeFrom(this),this},_initControlPos:function(){function a(a,f){var g=c+a+" "+c+f;b[a+f]=e.DomUtil.create("div",g,d)}var b=this._controlCorners={},c="leaflet-",d=this._controlContainer=e.DomUtil.create("div",c+"control-container",this._container);a("top","left"),a("top","right"),a("bottom","left"),a("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),e.Control.Zoom=e.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b="leaflet-control-zoom",c=e.DomUtil.create("div",b+" leaflet-bar");return this._map=a,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,b+"-in",c,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,b+"-out",c,this._zoomOut,this),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(a){this._map.zoomIn(a.shiftKey?3:1)},_zoomOut:function(a){this._map.zoomOut(a.shiftKey?3:1)},_createButton:function(a,b,c,d,f,g){var h=e.DomUtil.create("a",c,d);h.innerHTML=a,h.href="#",h.title=b;var i=e.DomEvent.stopPropagation;return e.DomEvent.on(h,"click",i).on(h,"mousedown",i).on(h,"dblclick",i).on(h,"click",e.DomEvent.preventDefault).on(h,"click",f,g).on(h,"click",this._refocusOnMap,g),h},_updateDisabled:function(){var a=this._map,b="leaflet-disabled";e.DomUtil.removeClass(this._zoomInButton,b),e.DomUtil.removeClass(this._zoomOutButton,b),a._zoom===a.getMinZoom()&&e.DomUtil.addClass(this._zoomOutButton,b),a._zoom===a.getMaxZoom()&&e.DomUtil.addClass(this._zoomInButton,b)}}),e.Map.mergeOptions({zoomControl:!0}),e.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new e.Control.Zoom,this.addControl(this.zoomControl))}),e.control.zoom=function(a){return new e.Control.Zoom(a)},e.Control.Attribution=e.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){e.setOptions(this,a),this._attributions={}},onAdd:function(a){this._container=e.DomUtil.create("div","leaflet-control-attribution"),e.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());return a.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(a){a.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):void 0},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):void 0},_update:function(){if(this._map){var a=[];for(var b in this._attributions)this._attributions[b]&&a.push(b);var c=[];this.options.prefix&&c.push(this.options.prefix),a.length&&c.push(a.join(", ")),this._container.innerHTML=c.join(" | ")}},_onLayerAdd:function(a){a.layer.getAttribution&&this.addAttribution(a.layer.getAttribution())},_onLayerRemove:function(a){a.layer.getAttribution&&this.removeAttribution(a.layer.getAttribution())}}),e.Map.mergeOptions({attributionControl:!0}),e.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new e.Control.Attribution).addTo(this))}),e.control.attribution=function(a){return new e.Control.Attribution(a)},e.Control.Scale=e.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(a){this._map=a;var b="leaflet-control-scale",c=e.DomUtil.create("div",b),d=this.options;return this._addScales(d,b,c),a.on(d.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=e.DomUtil.create("div",b+"-line",c)),a.imperial&&(this._iScale=e.DomUtil.create("div",b+"-line",c))},_update:function(){var a=this._map.getBounds(),b=a.getCenter().lat,c=6378137*Math.PI*Math.cos(b*Math.PI/180),d=c*(a.getNorthEast().lng-a.getSouthWest().lng)/180,e=this._map.getSize(),f=this.options,g=0;e.x>0&&(g=d*(f.maxWidth/e.x)),this._updateScales(f,g)},_updateScales:function(a,b){a.metric&&b&&this._updateMetric(b),a.imperial&&b&&this._updateImperial(b)},_updateMetric:function(a){var b=this._getRoundNum(a);this._mScale.style.width=this._getScaleWidth(b/a)+"px",this._mScale.innerHTML=1e3>b?b+" m":b/1e3+" km"},_updateImperial:function(a){var b,c,d,e=3.2808399*a,f=this._iScale;e>5280?(b=e/5280,c=this._getRoundNum(b),f.style.width=this._getScaleWidth(c/b)+"px",f.innerHTML=c+" mi"):(d=this._getRoundNum(e),f.style.width=this._getScaleWidth(d/e)+"px",f.innerHTML=d+" ft")},_getScaleWidth:function(a){return Math.round(this.options.maxWidth*a)-10},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1),c=a/b;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,b*c}}),e.control.scale=function(a){return new e.Control.Scale(a)},e.Control.Layers=e.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(a,b,c){e.setOptions(this,c),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var d in a)this._addLayer(a[d],d);for(d in b)this._addLayer(b[d],d,!0)},onAdd:function(a){return this._initLayout(),this._update(),a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._update(),this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._update(),this},removeLayer:function(a){var b=e.stamp(a);return delete this._layers[b],this._update(),this},_initLayout:function(){var a="leaflet-control-layers",b=this._container=e.DomUtil.create("div",a);b.setAttribute("aria-haspopup",!0),e.Browser.touch?e.DomEvent.on(b,"click",e.DomEvent.stopPropagation):e.DomEvent.disableClickPropagation(b).disableScrollPropagation(b);var c=this._form=e.DomUtil.create("form",a+"-list");if(this.options.collapsed){e.Browser.android||e.DomEvent.on(b,"mouseover",this._expand,this).on(b,"mouseout",this._collapse,this);var d=this._layersLink=e.DomUtil.create("a",a+"-toggle",b);d.href="#",d.title="Layers",e.Browser.touch?e.DomEvent.on(d,"click",e.DomEvent.stop).on(d,"click",this._expand,this):e.DomEvent.on(d,"focus",this._expand,this),e.DomEvent.on(c,"click",function(){setTimeout(e.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=e.DomUtil.create("div",a+"-base",c),this._separator=e.DomUtil.create("div",a+"-separator",c),this._overlaysList=e.DomUtil.create("div",a+"-overlays",c),b.appendChild(c)},_addLayer:function(a,b,c){var d=e.stamp(a);this._layers[d]={layer:a,name:b,overlay:c},this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var a,b,c=!1,d=!1;for(a in this._layers)b=this._layers[a],this._addItem(b),d=d||b.overlay,c=c||!b.overlay;this._separator.style.display=d&&c?"":"none"}},_onLayerChange:function(a){var b=this._layers[e.stamp(a.layer)];if(b){this._handlingClick||this._update();var c=b.overlay?"layeradd"===a.type?"overlayadd":"overlayremove":"layeradd"===a.type?"baselayerchange":null;c&&this._map.fire(c,b)}},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"';c&&(d+=' checked="checked"'),d+="/>";var e=b.createElement("div");return e.innerHTML=d,e.firstChild},_addItem:function(a){var c,d=b.createElement("label"),f=this._map.hasLayer(a.layer);a.overlay?(c=b.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=f):c=this._createRadioElement("leaflet-base-layers",f),c.layerId=e.stamp(a.layer),e.DomEvent.on(c,"click",this._onInputClick,this);var g=b.createElement("span");g.innerHTML=" "+a.name,d.appendChild(c),d.appendChild(g);var h=a.overlay?this._overlaysList:this._baseLayersList;return h.appendChild(d),d},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),e=d.length;for(this._handlingClick=!0,a=0;e>a;a++)b=d[a],c=this._layers[b.layerId],b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){e.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),e.control.layers=function(a,b,c){return new e.Control.Layers(a,b,c)},e.PosAnimation=e.Class.extend({includes:e.Mixin.Events,run:function(a,b,c,d){this.stop(),this._el=a,this._inProgress=!0,this._newPos=b,this.fire("start"),a.style[e.DomUtil.TRANSITION]="all "+(c||.25)+"s cubic-bezier(0,0,"+(d||.5)+",1)",e.DomEvent.on(a,e.DomUtil.TRANSITION_END,this._onTransitionEnd,this),e.DomUtil.setPosition(a,b),e.Util.falseFn(a.offsetWidth),this._stepTimer=setInterval(e.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(e.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),e.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var a=this._getPos();return a?(this._el._leaflet_pos=a,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var b,c,d,f=this._el,g=a.getComputedStyle(f);if(e.Browser.any3d){if(d=g[e.DomUtil.TRANSFORM].match(this._transformRe),!d)return;b=parseFloat(d[1]),c=parseFloat(d[2])}else b=parseFloat(g.left),c=parseFloat(g.top);return new e.Point(b,c,!0)},_onTransitionEnd:function(){e.DomEvent.off(this._el,e.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[e.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),e.Map.include({setView:function(a,b,d){if(b=b===c?this._zoom:this._limitZoom(b),a=this._limitCenter(e.latLng(a),b,this.options.maxBounds),d=d||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==c&&(d.zoom=e.extend({animate:d.animate},d.zoom),d.pan=e.extend({animate:d.animate},d.pan));var f=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,b,d.zoom):this._tryAnimatedPan(a,d.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(a,b),this},panBy:function(a,b){if(a=e.point(a).round(),b=b||{},!a.x&&!a.y)return this;if(this._panAnim||(this._panAnim=new e.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){e.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a);this._panAnim.run(this._mapPane,c,b.duration||.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){e.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();return(b&&b.animate)===!0||this.getSize().contains(c)?(this.panBy(c,b),!0):!1}}),e.PosAnimation=e.DomUtil.TRANSITION?e.PosAnimation:e.PosAnimation.extend({run:function(a,b,c,d){this.stop(),this._el=a,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=e.DomUtil.getPosition(a),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=e.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var a=+new Date-this._startTime,b=1e3*this._duration;b>a?this._runFrame(this._easeOut(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){var b=this._startPos.add(this._offset.multiplyBy(a));e.DomUtil.setPosition(this._el,b),this.fire("step")},_complete:function(){e.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),e.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),e.DomUtil.TRANSITION&&e.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&e.DomUtil.TRANSITION&&e.Browser.any3d&&!e.Browser.android23&&!e.Browser.mobileOpera,this._zoomAnimated&&e.DomEvent.on(this._mapPane,e.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),e.Map.include(e.DomUtil.TRANSITION?{_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(b),e=this._getCenterOffset(a)._divideBy(1-1/d),f=this._getCenterLayerPoint()._add(e);return c.animate===!0||this.getSize().contains(e)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(a,b,f,d,null,!0),!0):!1},_animateZoom:function(a,b,c,d,f,g,h){h||(this._animatingZoom=!0),e.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=a,this._animateToZoom=b,e.Draggable&&(e.Draggable._disabled=!0),e.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:a,zoom:b,origin:c,scale:d,delta:f,backwards:g}),setTimeout(e.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,e.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),e.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),e.Draggable&&(e.Draggable._disabled=!1)},this))}}:{}),e.TileLayer.include({_animateZoom:function(a){
this._animating||(this._animating=!0,this._prepareBgBuffer());var b=this._bgBuffer,c=e.DomUtil.TRANSFORM,d=a.delta?e.DomUtil.getTranslateString(a.delta):b.style[c],f=e.DomUtil.getScaleString(a.scale,a.origin);b.style[c]=a.backwards?f+" "+d:d+" "+f},_endZoomAnim:function(){var a=this._tileContainer,b=this._bgBuffer;a.style.visibility="",a.parentNode.appendChild(a),e.Util.falseFn(b.offsetWidth);var c=this._map.getZoom();(c>this.options.maxZoom||c<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var a=this._map;!a||a._animatingZoom||a.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[e.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var a=this._tileContainer,b=this._bgBuffer,c=this._getLoadedTilesPercentage(b),d=this._getLoadedTilesPercentage(a);return b&&c>.5&&.5>d?(a.style.visibility="hidden",void this._stopLoadingImages(a)):(b.style.visibility="hidden",b.style[e.DomUtil.TRANSFORM]="",this._tileContainer=b,b=this._bgBuffer=a,this._stopLoadingImages(b),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(a){var b,c,d=a.getElementsByTagName("img"),e=0;for(b=0,c=d.length;c>b;b++)d[b].complete&&e++;return e/c},_stopLoadingImages:function(a){var b,c,d,f=Array.prototype.slice.call(a.getElementsByTagName("img"));for(b=0,c=f.length;c>b;b++)d=f[b],d.complete||(d.onload=e.Util.falseFn,d.onerror=e.Util.falseFn,d.src=e.Util.emptyImageUrl,d.parentNode.removeChild(d))}}),e.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(a){if(a=this._locateOptions=e.extend(this._defaultLocateOptions,a),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=e.bind(this._handleGeolocationResponse,this),c=e.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,a):navigator.geolocation.getCurrentPosition(b,c,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code,c=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+c+"."})},_handleGeolocationResponse:function(a){var b=a.coords.latitude,c=a.coords.longitude,d=new e.LatLng(b,c),f=180*a.coords.accuracy/40075017,g=f/Math.cos(e.LatLng.DEG_TO_RAD*b),h=e.latLngBounds([b-f,c-g],[b+f,c+g]),i=this._locateOptions;if(i.setView){var j=Math.min(this.getBoundsZoom(h),i.maxZoom);this.setView(d,j)}var k={latlng:d,bounds:h,timestamp:a.timestamp};for(var l in a.coords)"number"==typeof a.coords[l]&&(k[l]=a.coords[l]);this.fire("locationfound",k)}})}(window,document),function(a){"use strict";var b={};"undefined"!=typeof window&&window.addEventListener("resize",function(){for(var a in b)if(b.hasOwnProperty(a)){var c=b[a];c.refresh()}});var c=function(a){var d,e,f,g,h;c.classes.dispatcher.extend(this);var i=a||{};if("string"==typeof i||i instanceof HTMLElement?i={renderers:[i]}:"[object Array]"===Object.prototype.toString.call(i)&&(i={renderers:i}),g=i.renderers||i.renderer||i.container,i.renderers&&0!==i.renderers.length||("string"==typeof g||g instanceof HTMLElement||"object"==typeof g&&"container"in g)&&(i.renderers=[g]),i.id){if(b[i.id])throw'sigma: Instance "'+i.id+'" already exists.';Object.defineProperty(this,"id",{value:i.id})}else{for(h=0;b[h];)h++;Object.defineProperty(this,"id",{value:""+h})}for(b[this.id]=this,this.settings=new c.classes.configurable(c.settings,i.settings||{}),Object.defineProperty(this,"graph",{value:new c.classes.graph(this.settings),configurable:!0}),Object.defineProperty(this,"middlewares",{value:[],configurable:!0}),Object.defineProperty(this,"cameras",{value:{},configurable:!0}),Object.defineProperty(this,"renderers",{value:{},configurable:!0}),Object.defineProperty(this,"renderersPerCamera",{value:{},configurable:!0}),Object.defineProperty(this,"cameraFrames",{value:{},configurable:!0}),Object.defineProperty(this,"camera",{get:function(){return this.cameras[0]}}),Object.defineProperty(this,"events",{value:["click","rightClick","clickStage","doubleClickStage","rightClickStage","clickNode","clickNodes","doubleClickNode","doubleClickNodes","rightClickNode","rightClickNodes","hovers","downNode","downNodes","upNode","upNodes"],configurable:!0}),this._handler=function(a){var b,c={};for(b in a.data)c[b]=a.data[b];c.renderer=a.target,this.dispatchEvent(a.type,c)}.bind(this),f=i.renderers||[],d=0,e=f.length;e>d;d++)this.addRenderer(f[d]);for(f=i.middlewares||[],d=0,e=f.length;e>d;d++)this.middlewares.push("string"==typeof f[d]?c.middlewares[f[d]]:f[d]);"object"==typeof i.graph&&i.graph&&(this.graph.read(i.graph),this.refresh())};if(c.prototype.addCamera=function(b){var d,e=this;if(!arguments.length){for(b=0;this.cameras[""+b];)b++;b=""+b}if(this.cameras[b])throw'sigma.addCamera: The camera "'+b+'" already exists.';return d=new c.classes.camera(b,this.graph,this.settings),this.cameras[b]=d,d.quadtree=new c.classes.quad,c.classes.edgequad!==a&&(d.edgequadtree=new c.classes.edgequad),d.bind("coordinatesUpdated",function(a){e.dispatchEvent("coordinatesUpdated"),e.renderCamera(d)}),this.renderersPerCamera[b]=[],d},c.prototype.killCamera=function(a){if(a="string"==typeof a?this.cameras[a]:a,!a)throw"sigma.killCamera: The camera is undefined.";var b,c,d=this.renderersPerCamera[a.id];for(c=d.length,b=c-1;b>=0;b--)this.killRenderer(d[b]);return delete this.renderersPerCamera[a.id],delete this.cameraFrames[a.id],delete this.cameras[a.id],a.kill&&a.kill(),this},c.prototype.addRenderer=function(a){var b,d,e,f,g=a||{};if("string"==typeof g?g={container:document.getElementById(g)}:g instanceof HTMLElement&&(g={container:g}),"string"==typeof g.container&&(g.container=document.getElementById(g.container)),"id"in g)b=g.id;else{for(b=0;this.renderers[""+b];)b++;b=""+b}if(this.renderers[b])throw'sigma.addRenderer: The renderer "'+b+'" already exists.';if(d="function"==typeof g.type?g.type:c.renderers[g.type],d=d||c.renderers.def,e="camera"in g?g.camera instanceof c.classes.camera?g.camera:this.cameras[g.camera]||this.addCamera(g.camera):this.addCamera(),this.cameras[e.id]!==e)throw"sigma.addRenderer: The camera is not properly referenced.";return f=new d(this.graph,e,this.settings,g),this.renderers[b]=f,Object.defineProperty(f,"id",{value:b}),f.bind&&f.bind(["click","rightClick","clickStage","doubleClickStage","rightClickStage","clickNode","clickNodes","clickEdge","clickEdges","doubleClickNode","doubleClickNodes","doubleClickEdge","doubleClickEdges","rightClickNode","rightClickNodes","rightClickEdge","rightClickEdges","hovers","downNode","downNodes","downEdge","downEdges","upNode","upNodes","upEdge","upEdges"],this._handler),this.renderersPerCamera[e.id].push(f),f},c.prototype.killRenderer=function(a){if(a="string"==typeof a?this.renderers[a]:a,!a)throw"sigma.killRenderer: The renderer is undefined.";var b=this.renderersPerCamera[a.camera.id],c=b.indexOf(a);return c>=0&&b.splice(c,1),a.kill&&a.kill(),delete this.renderers[a.id],this},c.prototype.refresh=function(b){var d,e,f,g,h,i,j=0;for(b=b||{},g=this.middlewares||[],d=0,e=g.length;e>d;d++)g[d].call(this,0===d?"":"tmp"+j+":",d===e-1?"ready:":"tmp"+ ++j+":");for(f in this.cameras)h=this.cameras[f],h.settings("autoRescale")&&this.renderersPerCamera[h.id]&&this.renderersPerCamera[h.id].length?c.middlewares.rescale.call(this,g.length?"ready:":"",h.readPrefix,{width:this.renderersPerCamera[h.id][0].width,height:this.renderersPerCamera[h.id][0].height}):c.middlewares.copy.call(this,g.length?"ready:":"",h.readPrefix),b.skipIndexation||(i=c.utils.getBoundaries(this.graph,h.readPrefix),h.quadtree.index(this.graph,{prefix:h.readPrefix,maxLevel:h.settings("nodeQuadtreeMaxLevel"),bounds:{x:i.minX,y:i.minY,width:i.maxX-i.minX,height:i.maxY-i.minY}}),h.edgequadtree!==a&&h.settings("drawEdges")&&(h.settings("enableEdgeHovering")||h.settings("edgesClippingWithNodes"))&&h.edgequadtree.index(this.graph,{prefix:h.readPrefix,maxLevel:h.settings("edgeQuadtreeMaxLevel"),bounds:{x:i.minX,y:i.minY,width:i.maxX-i.minX,height:i.maxY-i.minY}}));for(g=Object.keys(this.renderers),d=0,e=g.length;e>d;d++)if(this.renderers[g[d]].process)if(this.settings("skipErrors"))try{this.renderers[g[d]].process()}catch(k){console.log('Warning: The renderer "'+g[d]+'" crashed on ".process()"')}else this.renderers[g[d]].process();return this.render(),this},c.prototype.render=function(){var a;for(a in this.renderers)if(this.settings("skipErrors"))try{this.renderers[a].render()}catch(b){this.settings("verbose")&&console.log('Warning: The renderer "'+this.renderers[a]+'" crashed on ".render()"')}else this.renderers[a].render();return this},c.prototype.renderCamera=function(a,b){var c,d,e,f=this;if(b)for(e=this.renderersPerCamera[a.id],c=0,d=e.length;d>c;c++)if(this.settings("skipErrors"))try{e[c].render()}catch(g){this.settings("verbose")&&console.log('Warning: The renderer "'+e[c].id+'" crashed on ".render()"')}else e[c].render();else if(!this.cameraFrames[a.id]){for(e=this.renderersPerCamera[a.id],c=0,d=e.length;d>c;c++)if(this.settings("skipErrors"))try{e[c].render()}catch(g){this.settings("verbose")&&console.log('Warning: The renderer "'+e[c].id+'" crashed on ".render()"')}else e[c].render();this.cameraFrames[a.id]=requestAnimationFrame(function(){delete f.cameraFrames[a.id]})}return this},c.prototype.kill=function(){var a;this.dispatchEvent("kill"),this.graph.kill(),delete this.middlewares;for(a in this.renderers)this.killRenderer(this.renderers[a]);for(a in this.cameras)this.killCamera(this.cameras[a]);delete this.renderers,delete this.cameras;for(a in this)this.hasOwnProperty(a)&&delete this[a];delete b[this.id]},c.instances=function(a){return arguments.length?b[a]:c.utils.extend({},b)},c.version="1.5.2",c.forceES5=!1,"undefined"!=typeof this.sigma)throw"An object called sigma is already in the global scope.";this.sigma=c}.call(this),function(a){"use strict";function b(a,c){var d,e,f,g;if(arguments.length)if(1===arguments.length&&Object(arguments[0])===arguments[0])for(a in arguments[0])b(a,arguments[0][a]);else if(arguments.length>1)for(g=Array.isArray(a)?a:a.split(/ /),d=0,e=g.length;d!==e;d+=1)f=g[d],C[f]||(C[f]=[]),C[f].push({handler:c})}function c(a,b){var c,d,e,f,g,h,i=Array.isArray(a)?a:a.split(/ /);if(arguments.length)if(b)for(c=0,d=i.length;c!==d;c+=1){if(h=i[c],C[h]){for(g=[],e=0,f=C[h].length;e!==f;e+=1)C[h][e].handler!==b&&g.push(C[h][e]);C[h]=g}C[h]&&0===C[h].length&&delete C[h]}else for(c=0,d=i.length;c!==d;c+=1)delete C[i[c]];else C=Object.create(null)}function d(a,b){var c,d,e,f,g,h,i=Array.isArray(a)?a:a.split(/ /);for(b=void 0===b?{}:b,c=0,e=i.length;c!==e;c+=1)if(h=i[c],C[h])for(g={type:h,data:b||{}},d=0,f=C[h].length;d!==f;d+=1)try{C[h][d].handler(g)}catch(j){}}function e(){var a,b,c,d,e=!1,f=s(),g=x.shift();if(c=g.job(),f=s()-f,g.done++,g.time+=f,g.currentTime+=f,g.weightTime=g.currentTime/(g.weight||1),g.averageTime=g.time/g.done,d=g.count?g.count<=g.done:!c,!d){for(a=0,b=x.length;b>a;a++)if(x[a].weightTime>g.weightTime){x.splice(a,0,g),e=!0;break}e||x.push(g)}return d?g:null}function f(a){var b=x.length;w[a.id]=a,a.status="running",b&&(a.weightTime=x[b-1].weightTime,a.currentTime=a.weightTime*(a.weight||1)),a.startTime=s(),d("jobStarted",q(a)),x.push(a)}function g(){var a,b,c;for(a in v)b=v[a],b.after?y[a]=b:f(b),delete v[a];for(u=!!x.length;x.length&&s()-t<B.frameDuration;)if(c=e()){i(c.id);for(a in y)y[a].after===c.id&&(f(y[a]),delete y[a])}u?(t=s(),d("enterFrame"),setTimeout(g,0)):d("stop")}function h(a,b){var c,e,f;if(Array.isArray(a)){for(A=!0,c=0,e=a.length;e>c;c++)h(a[c].id,p(a[c],b));A=!1,u||(t=s(),d("start"),g())}else if("object"==typeof a)if("string"==typeof a.id)h(a.id,a);else{A=!0;for(c in a)"function"==typeof a[c]?h(c,p({job:a[c]},b)):h(c,p(a[c],b));A=!1,u||(t=s(),d("start"),g())}else{if("string"!=typeof a)throw new Error("[conrad.addJob] Wrong arguments.");if(k(a))throw new Error('[conrad.addJob] Job with id "'+a+'" already exists.');if("function"==typeof b)f={id:a,done:0,time:0,status:"waiting",currentTime:0,averageTime:0,weightTime:0,job:b};else{if("object"!=typeof b)throw new Error("[conrad.addJob] Wrong arguments.");f=p({id:a,done:0,time:0,status:"waiting",currentTime:0,averageTime:0,weightTime:0},b)}v[a]=f,d("jobAdded",q(f)),u||A||(t=s(),d("start"),g())}return this}function i(a){var b,c,e,f,g=!1;if(Array.isArray(a))for(b=0,c=a.length;c>b;b++)i(a[b]);else{if("string"!=typeof a)throw new Error("[conrad.killJob] Wrong arguments.");for(e=[w,y,v],b=0,c=e.length;c>b;b++)a in e[b]&&(f=e[b][a],B.history&&(f.status="done",z.push(f)),d("jobEnded",q(f)),delete e[b][a],"function"==typeof f.end&&f.end(),g=!0);for(e=x,b=0,c=e.length;c>b;b++)if(e[b].id===a){e.splice(b,1);break}if(!g)throw new Error('[conrad.killJob] Job "'+a+'" not found.')}return this}function j(){var a,b=p(v,w,y);if(B.history)for(a in b)b[a].status="done",z.push(b[a]),"function"==typeof b[a].end&&b[a].end();return v={},y={},w={},x=[],u=!1,this}function k(a){var b=v[a]||w[a]||y[a];return b?p(b):null}function l(a,b){var c;if("string"==typeof a1&&1===arguments.length)return B[a1];c="object"==typeof a1&&1===arguments.length?a1||{}:{},"string"==typeof a1&&(c[a1]=a2);for(var d in c)void 0!==c[d]?B[d]=c[d]:delete B[d];return this}function m(){return u}function n(){return z=[],this}function o(a,b){var c,d,e,f,g,h,i;if(!arguments.length){g=[];for(d in v)g.push(v[d]);for(d in y)g.push(y[d]);for(d in w)g.push(w[d]);g=g.concat(z)}if("string"==typeof a)switch(a){case"waiting":g=r(y);break;case"running":g=r(w);break;case"done":g=z;break;default:h=a}if(a instanceof RegExp&&(h=a),!h&&("string"==typeof b||b instanceof RegExp)&&(h=b),h){if(i="string"==typeof h,g instanceof Array)c=g;else if("object"==typeof g){c=[];for(d in g)c=c.concat(g[d])}else{c=[];for(d in v)c.push(v[d]);for(d in y)c.push(y[d]);for(d in w)c.push(w[d]);c=c.concat(z)}for(g=[],e=0,f=c.length;f>e;e++)(i?c[e].id===h:c[e].id.match(h))&&g.push(c[e])}return q(g)}function p(){var a,b,c={},d=arguments.length;for(a=d-1;a>=0;a--)for(b in arguments[a])c[b]=arguments[a][b];return c}function q(a){var b,c,d;if(!a)return a;if(Array.isArray(a))for(b=[],c=0,d=a.length;d>c;c++)b.push(q(a[c]));else if("object"==typeof a){b={};for(c in a)b[c]=q(a[c])}else b=a;return b}function r(a){var b,c=[];for(b in a)c.push(a[b]);return c}function s(){return Date.now?Date.now():(new Date).getTime()}if(a.conrad)throw new Error("conrad already exists");var t,u=!1,v={},w={},x=[],y={},z=[],A=!1,B={frameDuration:20,history:!0},C=Object.create(null);Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var D={hasJob:k,addJob:h,killJob:i,killAll:j,settings:l,getStats:o,isRunning:m,clearHistory:n,bind:b,unbind:c,version:"0.1.0"};"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=D),exports.conrad=D),a.conrad=D}(this),function(a){"use strict";function b(){var b,c=this;sigma.forceES5||"undefined"==typeof Map||Map.prototype.keys===a||Map.prototype.forEach===a||Array.from===a?(b=Object.create(null),this.size=0,this.keyList=function(){return Object.keys(b).filter(function(c){return b[c]!==a})},this.valueList=function(){for(var c=Object.keys(b),d=[],e=0;e<c.length;e++){var f=b[c[e]];f!==a&&d.push(f)}return d},this.set=function(d,e){b[d]===a&&c.size++,b[d]=e},this.get=function(a){return b[a]},this.has=function(c){return b[c]!==a},this.forEach=function(a){for(var c=Object.keys(b),d=0;d<c.length;++d){var e=c[d],f=b[e];"undefined"!=typeof f&&a(f,e)}},this["delete"]=function(d){var e=b[d];return b[d]=a,e!==a&&c.size--,e},this.clear=function(){for(var a in b)"hasOwnProperty"in b&&!b.hasOwnProperty(a)||delete b[a];b=Object.create(null),c.size=0}):(b=new Map,Object.defineProperty(this,"size",{get:function(){return b.size},set:a,enumerable:!0}),this.set=function(a,c){b.set(""+a,c)},this.get=function(a){return b.get(""+a)},this.has=function(a){return b.has(""+a)},this.forEach=function(a){return b.forEach(a)},this["delete"]=function(a){return b["delete"](""+a)},this.clear=function(){b.clear()},this.keyList=function(){return Array.from(b.keys())},this.valueList=function(){var a=[];return b.forEach(function(b){a.push(b)}),a})}if("undefined"==typeof sigma)throw"sigma is not declared";var c=this;sigma.utils=sigma.utils||{},sigma.utils.map=b,sigma.utils.extend=function(){var a,b,c={},d=arguments.length;for(a=d-1;a>=0;a--)for(b in arguments[a])c[b]=arguments[a][b];return c},sigma.utils.dateNow=function(){return Date.now?Date.now():(new Date).getTime()},sigma.utils.pkg=function(a){return(a||"").split(".").reduce(function(a,b){return b in a?a[b]:a[b]={}},c)},sigma.utils.id=function(){var a=0;return function(){return++a}}();var d={};sigma.utils.floatColor=function(a){if(d[a])return d[a];var b=a,c=0,e=0,f=0;"#"===a[0]?(a=a.slice(1),3===a.length?(c=parseInt(a.charAt(0)+a.charAt(0),16),e=parseInt(a.charAt(1)+a.charAt(1),16),f=parseInt(a.charAt(2)+a.charAt(2),16)):(c=parseInt(a.charAt(0)+a.charAt(1),16),e=parseInt(a.charAt(2)+a.charAt(3),16),f=parseInt(a.charAt(4)+a.charAt(5),16))):a.match(/^ *rgba? *\(/)&&(a=a.match(/^ *rgba? *\( *([0-9]*) *, *([0-9]*) *, *([0-9]*) *(,.*)?\) *$/),c=+a[1],e=+a[2],f=+a[3]);var g=256*c*256+256*e+f;return d[b]=g,g},sigma.utils.zoomTo=function(a,b,c,d,e){var f,g,h,i=a.settings;g=Math.max(i("zoomMin"),Math.min(i("zoomMax"),a.ratio*d)),g!==a.ratio&&(d=g/a.ratio,h={x:b*(1-d)+a.x,y:c*(1-d)+a.y,ratio:g},e&&e.duration?(f=sigma.misc.animation.killAll(a),e=sigma.utils.extend(e,{easing:f?"quadraticOut":"quadraticInOut"}),sigma.misc.animation.camera(a,h,e)):(a.goTo(h),e&&e.onComplete&&e.onComplete()))},sigma.utils.getQuadraticControlPoint=function(a,b,c,d,e){return e=this.extend(e,{x:2,y:4}),{x:(a+c)/e.x+(d-b)/e.y,y:(b+d)/e.x+(a-c)/e.y}},sigma.utils.getPointOnQuadraticCurve=function(a,b,c,d,e,f,g){return{x:(1-a)*(1-a)*b+2*(1-a)*a*f+a*a*d,y:(1-a)*(1-a)*c+2*(1-a)*a*g+a*a*e}},sigma.utils.getPointOnBezierCurve=function(a,b,c,d,e,f,g,h,i){var j=(1-a)*(1-a)*(1-a),k=3*a*(1-a)*(1-a),l=3*a*a*(1-a),m=a*a*a;return{x:j*b+k*f+l*h+m*d,y:j*c+k*g+l*i+m*e}},sigma.utils.getSelfLoopControlPoints=function(a,b,c){return{x1:a-7*c,y1:b,x2:a,y2:b+7*c}},sigma.utils.getDistance=function(a,b,c,d){return Math.sqrt((c-a)*(c-a)+(d-b)*(d-b))},sigma.utils.getCircleIntersection=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;if(h=d-a,i=e-b,j=Math.sqrt(i*i+h*h),j>c+f)return!1;if(j<Math.abs(c-f))return!1;g=(c*c-f*f+j*j)/(2*j),n=a+h*g/j,o=b+i*g/j,k=Math.sqrt(c*c-g*g),l=-i*(k/j),m=h*(k/j);var p=n+l,q=n-l,r=o+m,s=o-m;return{xi:p,xi_prime:q,yi:r,yi_prime:s}},sigma.utils.isPointOnSegment=function(a,b,c,d,e,f,g){return sigma.utils.distancePointToSegment(a,b,c,d,e,f)<g},sigma.utils.distancePointToSegment=function(a,b,c,d,e,f){var g,h,i=a-c,j=b-d,k=e-c,l=f-d,m=i*k+j*l,n=k*k+l*l,o=-1;0!==n&&(o=m/n),0>o?(g=c,h=d):o>1?(g=e,h=f):(g=c+o*k,h=d+o*l);var p=a-g,q=b-h;return Math.sqrt(p*p+q*q)},sigma.utils.isPointOnQuadraticCurve=function(a,b,c,d,e,f,g,h,i){var j=sigma.utils.getDistance(c,d,e,f);if(Math.abs(a-c)>j||Math.abs(b-d)>j)return!1;for(var k,l=sigma.utils.getDistance(a,b,c,d),m=sigma.utils.getDistance(a,b,e,f),n=.5,o=m>l?-.01:.01,p=.001,q=100,r=sigma.utils.getPointOnQuadraticCurve(n,c,d,e,f,g,h),s=sigma.utils.getDistance(a,b,r.x,r.y);q-- >0&&n>=0&&1>=n&&s>i&&(o>p||-p>o);)k=s,r=sigma.utils.getPointOnQuadraticCurve(n,c,d,e,f,g,h),s=sigma.utils.getDistance(a,b,r.x,r.y),s>k?(o=-o/2,n+=o):0>n+o||n+o>1?(o/=2,s=k):n+=o;return i>s},sigma.utils.isPointOnBezierCurve=function(a,b,c,d,e,f,g,h,i,j,k){var l=sigma.utils.getDistance(c,d,g,h);if(Math.abs(a-c)>l||Math.abs(b-d)>l)return!1;for(var m,n=sigma.utils.getDistance(a,b,c,d),o=sigma.utils.getDistance(a,b,e,f),p=.5,q=o>n?-.01:.01,r=.001,s=100,t=sigma.utils.getPointOnBezierCurve(p,c,d,e,f,g,h,i,j),u=sigma.utils.getDistance(a,b,t.x,t.y);s-- >0&&p>=0&&1>=p&&u>k&&(q>r||-r>q);)m=u,t=sigma.utils.getPointOnBezierCurve(p,c,d,e,f,g,h,i,j),u=sigma.utils.getDistance(a,b,t.x,t.y),u>m?(q=-q/2,p+=q):0>p+q||p+q>1?(q/=2,u=m):p+=q;return k>u},sigma.utils.getX=function(b){return b.offsetX!==a&&b.offsetX||b.layerX!==a&&b.layerX||b.clientX!==a&&b.clientX},sigma.utils.getY=function(b){return b.offsetY!==a&&b.offsetY||b.layerY!==a&&b.layerY||b.clientY!==a&&b.clientY},sigma.utils.getPixelRatio=function(){var b=1;return window.screen.deviceXDPI!==a&&window.screen.logicalXDPI!==a&&window.screen.deviceXDPI>window.screen.logicalXDPI?b=window.screen.systemXDPI/window.screen.logicalXDPI:window.devicePixelRatio!==a&&(b=window.devicePixelRatio),b},sigma.utils.getWidth=function(b){var c=b.target.ownerSVGElement?b.target.ownerSVGElement.width:b.target.width;return"number"==typeof c&&c||c!==a&&c.baseVal!==a&&c.baseVal.value},sigma.utils.getCenter=function(a){var b=-1!==a.target.namespaceURI.indexOf("svg")?1:sigma.utils.getPixelRatio();return{x:sigma.utils.getWidth(a)/(2*b),y:sigma.utils.getHeight(a)/(2*b)}},sigma.utils.mouseCoords=function(a,b,c){return b=b||sigma.utils.getX(a),c=c||sigma.utils.getY(a),{x:b-sigma.utils.getCenter(a).x,y:c-sigma.utils.getCenter(a).y,clientX:a.clientX,clientY:a.clientY,ctrlKey:a.ctrlKey,metaKey:a.metaKey,altKey:a.altKey,shiftKey:a.shiftKey}},sigma.utils.getHeight=function(b){var c=b.target.ownerSVGElement?b.target.ownerSVGElement.height:b.target.height;return"number"==typeof c&&c||c!==a&&c.baseVal!==a&&c.baseVal.value},sigma.utils.getDelta=function(b){return b.wheelDelta!==a&&b.wheelDelta||b.detail!==a&&-b.detail},sigma.utils.getOffset=function(a){for(var b=0,c=0;a;)c+=parseInt(a.offsetTop),b+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:c,left:b}},sigma.utils.doubleClick=function(a,b,c){var d,e=0;a._doubleClickHandler=a._doubleClickHandler||{},a._doubleClickHandler[b]=a._doubleClickHandler[b]||[],d=a._doubleClickHandler[b],d.push(function(a){return e++,2===e?(e=0,c(a)):void(1===e&&setTimeout(function(){e=0},sigma.settings.doubleClickTimeout))}),a.addEventListener(b,d[d.length-1],!1)},sigma.utils.unbindDoubleClick=function(a,b){for(var c,d=(a._doubleClickHandler||{})[b]||[];c=d.pop();)a.removeEventListener(b,c);delete(a._doubleClickHandler||{})[b]},sigma.utils.easings=sigma.utils.easings||{},sigma.utils.easings.linearNone=function(a){return a},sigma.utils.easings.quadraticIn=function(a){return a*a},sigma.utils.easings.quadraticOut=function(a){return a*(2-a)},sigma.utils.easings.quadraticInOut=function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)},sigma.utils.easings.cubicIn=function(a){return a*a*a},sigma.utils.easings.cubicOut=function(a){return--a*a*a+1},sigma.utils.easings.cubicInOut=function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},sigma.utils.isWebGLSupported=function(){var a,b=!!window.WebGLRenderingContext;if(b){a=document.createElement("canvas");try{return!(!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(c){}}return!1},sigma.utils.loadShader=function(a,b,c,d){var e,f=a.createShader(c);return a.shaderSource(f,b),a.compileShader(f),e=a.getShaderParameter(f,a.COMPILE_STATUS),e?f:(d&&d('Error compiling shader "'+f+'":'+a.getShaderInfoLog(f)),a.deleteShader(f),null)},sigma.utils.loadProgram=function(a,b,c,d,e){var f,g,h=a.createProgram();for(f=0;f<b.length;++f)a.attachShader(h,b[f]);if(c)for(f=0;f<c.length;++f)a.bindAttribLocation(h,locations?locations[f]:f,opt_attribs[f]);return a.linkProgram(h),g=a.getProgramParameter(h,a.LINK_STATUS),g?h:(e&&e("Error in program linking: "+a.getProgramInfoLog(h)),a.deleteProgram(h),null)},sigma.utils.pkg("sigma.utils.matrices"),sigma.utils.matrices.translation=function(a,b){return[1,0,0,0,1,0,a,b,1]},sigma.utils.matrices.rotation=function(a,b){var c=Math.cos(a),d=Math.sin(a);return b?[c,-d,d,c]:[c,-d,0,d,c,0,0,0,1]},sigma.utils.matrices.scale=function(a,b){return b?[a,0,0,a]:[a,0,0,0,a,0,0,0,1]},sigma.utils.matrices.multiply=function(a,b,c){var d=c?2:3,e=a[0*d+0],f=a[0*d+1],g=a[0*d+2],h=a[1*d+0],i=a[1*d+1],j=a[1*d+2],k=a[2*d+0],l=a[2*d+1],m=a[2*d+2],n=b[0*d+0],o=b[0*d+1],p=b[0*d+2],q=b[1*d+0],r=b[1*d+1],s=b[1*d+2],t=b[2*d+0],u=b[2*d+1],v=b[2*d+2];return c?[e*n+f*q,e*o+f*r,h*n+i*q,h*o+i*r]:[e*n+f*q+g*t,e*o+f*r+g*u,e*p+f*s+g*v,h*n+i*q+j*t,h*o+i*r+j*u,h*p+i*s+j*v,k*n+l*q+m*t,k*o+l*r+m*u,k*p+l*s+m*v]},sigma.utils.canvas={},sigma.utils.canvas.getTextWidth=function(a,b,c,d){return d?b?.6*d.length*c:a.measureText(d).width:0},sigma.utils.canvas.setLevel=function(a,b){if(a)switch(b.shadowOffsetX=0,a){case 1:b.shadowOffsetY=1.5,b.shadowBlur=4,b.shadowColor="rgba(0,0,0,0.36)";break;case 2:b.shadowOffsetY=3,b.shadowBlur=12,b.shadowColor="rgba(0,0,0,0.39)";break;case 3:b.shadowOffsetY=6,b.shadowBlur=12,b.shadowColor="rgba(0,0,0,0.42)";break;case 4:b.shadowOffsetY=10,b.shadowBlur=20,b.shadowColor="rgba(0,0,0,0.47)";break;case 5:b.shadowOffsetY=15,b.shadowBlur=24,b.shadowColor="rgba(0,0,0,0.52)"}},sigma.utils.canvas.resetLevel=function(a){a.shadowOffsetY=0,a.shadowBlur=0,a.shadowColor="#000000"};var e={};sigma.utils.canvas.drawImage=function(a,b,c,d,f,g,h,i){if(a.image&&a.image.url&&!(h>d)){var j=a.image.url,k=a.image.h||1,l=a.image.w||1,m=a.image.scale||1,n=a.image.clip||1,o=e[j];o||(o=document.createElement("IMG"),o.setAttribute("crossOrigin",g),o.src=j,o.onload=function(){window.dispatchEvent(new Event("resize"))},e[j]=o);var p=k>l?l/k:1,q=l>k?k/l:1,r=d*m;f.save(),f.beginPath(),"function"==typeof i?i(a,b,c,d,f,n):f.arc(b,c,d*n,0,2*Math.PI,!0),f.closePath(),f.clip(),f.drawImage(o,b+Math.sin(-.7855)*r*p,c-Math.cos(-.7855)*r*q,r*p*2*Math.sin(-.7855)*-1,r*q*2*Math.cos(-.7855)),f.restore()}},sigma.utils.canvas.drawIcon=function(a,b,c,d,e,f){if(a.icon&&!(f>d)){var g=a.icon.font||"Arial",h=a.icon.color||"#F00",i=a.icon.content||"?",j=(a.icon.x||.5,a.icon.y||.5,d),k=.7;"number"==typeof a.icon.scale&&(k=Math.abs(Math.max(.01,a.icon.scale)));var l=Math.round(k*j);e.save(),e.fillStyle=h,e.font=""+l+"px "+g,e.textAlign="center",e.textBaseline="middle",e.fillText(i,b,c),e.restore()}}}.call(this),function(a){"use strict";var b,c=0,d=["ms","moz","webkit","o"];for(b=0;b<d.length&&!a.requestAnimationFrame;b++)a.requestAnimationFrame=a[d[b]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[d[b]+"CancelAnimationFrame"]||a[d[b]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(b,d){var e=(new Date).getTime(),f=Math.max(0,16-(e-c)),g=a.setTimeout(function(){b(e+f)},f);return c=e+f,g}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b,c,d=Array.prototype.slice.call(arguments,1),e=this;return b=function(){},c=function(){return e.apply(this instanceof b&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))},b.prototype=this.prototype,c.prototype=new b,c})}(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.settings");var b={clone:!1,immutable:!0,verbose:!1,classPrefix:"sigma",defaultNodeType:"def",defaultEdgeType:"def",defaultLabelColor:"#000",defaultEdgeColor:"#000",defaultNodeColor:"#000",defaultLabelSize:14,labelAlignment:"right",edgeColor:"source",minArrowSize:0,font:"arial",fontStyle:"",labelColor:"default",labelSize:"fixed",labelSizeRatio:1,labelThreshold:8,maxNodeLabelLineLength:0,webglOversamplingRatio:2,nodeBorderSize:0,defaultNodeBorderColor:"#000",hoverFont:"",singleHover:!0,hoverFontStyle:"",labelHoverShadow:"default",labelHoverShadowColor:"#000",nodeHoverColor:"node",defaultNodeHoverColor:"#000",labelHoverBGColor:"default",defaultHoverLabelBGColor:"#fff",labelHoverColor:"default",defaultLabelHoverColor:"#000",edgeHoverColor:"edge",edgeHoverSizeRatio:1,defaultEdgeHoverColor:"#000",edgeHoverExtremities:!1,drawEdges:!0,drawNodes:!0,drawLabels:!0,drawEdgeLabels:!1,batchEdgesDrawing:!1,hideEdgesOnMove:!1,canvasEdgesBatchSize:500,webglEdgesBatchSize:1e3,approximateLabelWidth:!0,edgesClippingWithNodes:!0,autoCurveRatio:1,autoCurveSortByDirection:!0,scalingMode:"inside",sideMargin:0,minEdgeSize:.5,maxEdgeSize:1,minNodeSize:1,maxNodeSize:8,clickToFocus:!1,touchEnabled:!0,mouseEnabled:!0,mouseWheelEnabled:!0,doubleClickEnabled:!0,eventsEnabled:!0,zoomingRatio:1.7,doubleClickZoomingRatio:2.2,zoomMin:.0625,zoomMax:2,zoomOnLocation:!0,mouseZoomDuration:200,doubleClickZoomDuration:200,mouseInertiaDuration:200,mouseInertiaRatio:3,touchInertiaDuration:200,touchInertiaRatio:3,doubleClickTimeout:300,doubleTapTimeout:300,dragTimeout:200,autoRescale:!0,enableCamera:!0,enableHovering:!0,enableEdgeHovering:!1,edgeHoverPrecision:5,rescaleIgnoreSize:!1,skipErrors:!1,nodeQuadtreeMaxLevel:4,edgeQuadtreeMaxLevel:4,nodesPowRatio:.5,edgesPowRatio:.5,animationsTime:200};sigma.settings=sigma.utils.extend(sigma.settings||{},b)}.call(this),function(){"use strict";var a=function(){Object.defineProperty(this,"_handlers",{value:{}})};a.prototype.bind=function(a,b){var c,d,e,f;if(1===arguments.length&&"object"==typeof arguments[0])for(a in arguments[0])this.bind(a,arguments[0][a]);else{if(2!==arguments.length||"function"!=typeof arguments[1])throw"bind: Wrong arguments.";for(f="string"==typeof a?a.split(" "):a,c=0,d=f.length;c!==d;c+=1)e=f[c],e&&(this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push({handler:b}))}return this},a.prototype.unbind=function(a,b){var c,d,e,f,g,h,i,j="string"==typeof a?a.split(" "):a;if(!arguments.length){for(g in this._handlers)delete this._handlers[g];return this}if(b)for(c=0,d=j.length;c!==d;c+=1){if(i=j[c],this._handlers[i]){for(h=[],e=0,f=this._handlers[i].length;e!==f;e+=1)this._handlers[i][e].handler!==b&&h.push(this._handlers[i][e]);this._handlers[i]=h}this._handlers[i]&&0===this._handlers[i].length&&delete this._handlers[i]}else for(c=0,d=j.length;c!==d;c+=1)delete this._handlers[j[c]];return this},a.prototype.dispatchEvent=function(a,b){var c,d,e,f,g,h,i,j=this,k="string"==typeof a?a.split(" "):a;for(b=void 0===b?{}:b,c=0,d=k.length;c!==d;c+=1)if(i=k[c],this._handlers[i]){for(h=j.getEvent(i,b),g=[],e=0,f=this._handlers[i].length;e!==f;e+=1)this._handlers[i][e].handler(h),this._handlers[i][e].one||g.push(this._handlers[i][e]);this._handlers[i]=g}return this},a.prototype.getEvent=function(a,b){return{type:a,data:b||{},target:this}},a.extend=function(b,c){var d;for(d in a.prototype)a.prototype.hasOwnProperty(d)&&(b[d]=a.prototype[d]);a.apply(b,c)},"undefined"!=typeof this.sigma?(this.sigma.classes=this.sigma.classes||{},this.sigma.classes.dispatcher=a):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.dispatcher=a):this.dispatcher=a}.call(this),function(){"use strict";var a=function(){var b,c,d={},e=Array.prototype.slice.call(arguments,0),f=function(a,b){var c,g,h,i;if(1!==arguments.length||"string"!=typeof a){if("object"==typeof a&&"string"==typeof b)return void 0!==(a||{})[b]?a[b]:f(b);for(c="object"==typeof a&&void 0===b?a:{},"string"==typeof a&&(c[a]=b),g=0,i=Object.keys(c),h=i.length;h>g;g++)d[i[g]]=c[i[g]];return this}if(void 0!==d[a])return d[a];for(g=0,h=e.length;h>g;g++)if(void 0!==e[g][a])return e[g][a]};for(f.embedObjects=function(){var b=e.concat(d).concat(Array.prototype.splice.call(arguments,0));return a.apply({},b)},b=0,c=arguments.length;c>b;b++)f(arguments[b]);return f};"undefined"!=typeof this.sigma?(this.sigma.classes=this.sigma.classes||{},this.sigma.classes.configurable=a):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.configurable=a):this.configurable=a}.call(this),function(a){"use strict";function b(a,b,c){var d=function(){var d,e;for(d in g[a])g[a][d].apply(b,arguments);e=c.apply(b,arguments);for(d in f[a])f[a][d].apply(b,arguments);return e};return d}var c=Object.create(null),d=Object.create(null),e=Object.create(null),f=Object.create(null),g=Object.create(null),h={immutable:!0,
clone:!0},i=function(a){return h[a]},j=function(a){var d,f,g;g={settings:a||i,nodesArray:[],edgesArray:[],nodesIndex:new sigma.utils.map,edgesIndex:new sigma.utils.map,inNeighborsIndex:new sigma.utils.map,outNeighborsIndex:new sigma.utils.map,allNeighborsIndex:new sigma.utils.map};for(d in e)e[d].call(g);for(d in c)f=b(d,g,c[d]),this[d]=f,g[d]=f};j.addMethod=function(a,b){if("string"!=typeof a||"function"!=typeof b||2!==arguments.length)throw"addMethod: Wrong arguments.";if(c[a]||j[a])throw'The method "'+a+'" already exists.';return c[a]=b,f[a]=Object.create(null),g[a]=Object.create(null),this},j.hasMethod=function(a){return!(!c[a]&&!j[a])},j.attach=function(a,b,c,d){if("string"!=typeof a||"string"!=typeof b||"function"!=typeof c||arguments.length<3||arguments.length>4)throw"attach: Wrong arguments.";var h;if("constructor"===a)h=e;else if(d){if(!g[a])throw'The method "'+a+'" does not exist.';h=g[a]}else{if(!f[a])throw'The method "'+a+'" does not exist.';h=f[a]}if(h[b])throw'A function "'+b+'" is already attached to the method "'+a+'".';return h[b]=c,this},j.attachBefore=function(a,b,c){return this.attach(a,b,c,!0)},j.addIndex=function(a,b){if("string"!=typeof a||Object(b)!==b||2!==arguments.length)throw"addIndex: Wrong arguments.";if(d[a])throw'The index "'+a+'" already exists.';var c;d[a]=b;for(c in b){if("function"!=typeof b[c])throw"The bindings must be functions.";j.attach(c,a,b[c])}return this},j.addMethod("addNode",function(b){if(Object(b)!==b||1!==arguments.length)throw"addNode: Wrong arguments.";if("string"!=typeof b.id&&"number"!=typeof b.id)throw"The node must have a string or number id.";if(this.nodesIndex.get(b.id))throw'The node "'+b.id+'" already exists.';var c,d=b.id,e=Object.create(null);if(this.settings("clone"))for(c in b)"id"!==c&&(e[c]=b[c]);else e=b;return e.x!==a&&"number"!=typeof e.x&&(e.x=parseFloat(e.x)),e.y!==a&&"number"!=typeof e.y&&(e.y=parseFloat(e.y)),e.size!==a&&"number"!=typeof e.size&&(e.size=parseFloat(e.size)),(!e.size||e.size<=0)&&(e.size=1),this.settings("immutable")?Object.defineProperty(e,"id",{value:d,enumerable:!0}):e.id=d,this.inNeighborsIndex.set(d,new sigma.utils.map),this.outNeighborsIndex.set(d,new sigma.utils.map),this.allNeighborsIndex.set(d,new sigma.utils.map),this.nodesArray.push(e),this.nodesIndex.set(e.id,e),this}),j.addMethod("addEdge",function(b){if(Object(b)!==b||1!==arguments.length)throw"addEdge: Wrong arguments.";if("string"!=typeof b.id&&"number"!=typeof b.id)throw"The edge must have a string or number id.";if("string"!=typeof b.source&&"number"!=typeof b.source||!this.nodesIndex.get(b.source))throw"The edge source must have an existing node id.";if("string"!=typeof b.target&&"number"!=typeof b.target||!this.nodesIndex.get(b.target))throw"The edge target must have an existing node id.";if(this.edgesIndex.get(b.id))throw'The edge "'+b.id+'" already exists.';var c,d=Object.create(null);if(this.settings("clone"))for(c in b)"id"!==c&&"source"!==c&&"target"!==c&&(d[c]=b[c]);else d=b;return d.size!==a&&"number"!=typeof d.size&&(d.size=parseFloat(d.size)),(!d.size||d.size<=0)&&(d.size=1),this.settings("immutable")?(Object.defineProperty(d,"id",{value:b.id,enumerable:!0}),Object.defineProperty(d,"source",{value:b.source,enumerable:!0}),Object.defineProperty(d,"target",{value:b.target,enumerable:!0})):(d.id=b.id,d.source=b.source,d.target=b.target),this.edgesArray.push(d),this.edgesIndex.set(d.id,d),this.inNeighborsIndex.get(d.target).get(d.source)||this.inNeighborsIndex.get(d.target).set(d.source,new sigma.utils.map),this.inNeighborsIndex.get(d.target).get(d.source).set(d.id,d),this.outNeighborsIndex.get(d.source).get(d.target)||this.outNeighborsIndex.get(d.source).set(d.target,new sigma.utils.map),this.outNeighborsIndex.get(d.source).get(d.target).set(d.id,d),this.allNeighborsIndex.get(d.source).get(d.target)||this.allNeighborsIndex.get(d.source).set(d.target,new sigma.utils.map),this.allNeighborsIndex.get(d.source).get(d.target).set(d.id,d),d.target!==d.source&&(this.allNeighborsIndex.get(d.target).get(d.source)||this.allNeighborsIndex.get(d.target).set(d.source,new sigma.utils.map),this.allNeighborsIndex.get(d.target).get(d.source).set(d.id,d)),this}),j.addMethod("dropNode",function(a){if("string"!=typeof a&&"number"!=typeof a||1!==arguments.length)throw"dropNode: Wrong arguments.";if(!this.nodesIndex.get(a))throw'The node "'+a+'" does not exist.';var b,c;for(this.nodesIndex["delete"](a),b=0,c=this.nodesArray.length;c>b;b++)if(this.nodesArray[b].id===a){this.nodesArray.splice(b,1);break}for(b=this.edgesArray.length-1;b>=0;b--)this.edgesArray[b].source!==a&&this.edgesArray[b].target!==a||this.dropEdge(this.edgesArray[b].id);this.inNeighborsIndex["delete"](a),this.outNeighborsIndex["delete"](a),this.allNeighborsIndex["delete"](a);var d=this;return this.nodesIndex.forEach(function(b,c){d.inNeighborsIndex.get(c)["delete"](a),d.outNeighborsIndex.get(c)["delete"](a),d.allNeighborsIndex.get(c)["delete"](a)}),this}),j.addMethod("dropEdge",function(a){if("string"!=typeof a&&"number"!=typeof a||1!==arguments.length)throw"dropEdge: Wrong arguments.";if(!this.edgesIndex.get(a))throw'The edge "'+a+'" does not exist.';var b,c,d;for(d=this.edgesIndex.get(a),this.edgesIndex["delete"](a),b=0,c=this.edgesArray.length;c>b;b++)if(this.edgesArray[b].id===a){this.edgesArray.splice(b,1);break}return this.inNeighborsIndex.get(d.target).get(d.source)["delete"](d.id),0==this.inNeighborsIndex.get(d.target).get(d.source).size&&this.inNeighborsIndex.get(d.target)["delete"](d.source),this.outNeighborsIndex.get(d.source).get(d.target)["delete"](d.id),0==this.outNeighborsIndex.get(d.source).get(d.target).size&&this.outNeighborsIndex.get(d.source)["delete"](d.target),this.allNeighborsIndex.get(d.source).get(d.target)["delete"](d.id),0==this.allNeighborsIndex.get(d.source).get(d.target).size&&this.allNeighborsIndex.get(d.source)["delete"](d.target),d.target!==d.source&&(this.allNeighborsIndex.get(d.target).get(d.source)["delete"](d.id),0==this.allNeighborsIndex.get(d.target).get(d.source).size&&this.allNeighborsIndex.get(d.target)["delete"](d.source)),this}),j.addMethod("kill",function(){this.nodesArray.length=0,this.edgesArray.length=0,delete this.nodesArray,delete this.edgesArray,delete this.nodesIndex,delete this.edgesIndex,delete this.inNeighborsIndex,delete this.outNeighborsIndex,delete this.allNeighborsIndex}),j.addMethod("clear",function(){return this.nodesArray.length=0,this.edgesArray.length=0,this.nodesIndex.clear(),this.edgesIndex.clear(),this.nodesIndex.clear(),this.inNeighborsIndex.clear(),this.outNeighborsIndex.clear(),this.allNeighborsIndex.clear(),this}),j.addMethod("read",function(a){var b,c,d;for(c=a.nodes||[],b=0,d=c.length;d>b;b++)this.addNode(c[b]);for(c=a.edges||[],b=0,d=c.length;d>b;b++)this.addEdge(c[b]);return this}),j.addMethod("nodes",function(a){if(!arguments.length)return this.nodesArray.slice(0);if(1===arguments.length&&("string"==typeof a||"number"==typeof a))return this.nodesIndex.get(a);if(1===arguments.length&&"[object Array]"===Object.prototype.toString.call(a)){var b,c,d=[];for(b=0,c=a.length;c>b;b++){if("string"!=typeof a[b]&&"number"!=typeof a[b])throw"nodes: Wrong arguments.";d.push(this.nodesIndex.get(a[b]))}return d}throw"nodes: Wrong arguments."}),j.addMethod("degree",function(a,b){if(b={"in":this.inNeighborsIndex,out:this.outNeighborsIndex}[b||""]||this.allNeighborsIndex,"string"==typeof a||"number"==typeof a)return b.get(a).size;if("[object Array]"===Object.prototype.toString.call(a)){var c,d,e=[];for(c=0,d=a.length;d>c;c++){if("string"!=typeof a[c]&&"number"!=typeof a[c])throw"degree: Wrong arguments.";e.push(b.get(a[c]).size)}return e}throw"degree: Wrong arguments."}),j.addMethod("edges",function(a){if(!arguments.length)return this.edgesArray.slice(0);if(1===arguments.length&&("string"==typeof a||"number"==typeof a))return this.edgesIndex.get(a);if(1===arguments.length&&"[object Array]"===Object.prototype.toString.call(a)){var b,c,d=[];for(b=0,c=a.length;c>b;b++){if("string"!=typeof a[b]&&"number"!=typeof a[b])throw"edges: Wrong arguments.";d.push(this.edgesIndex.get(a[b]))}return d}throw"edges: Wrong arguments."}),"undefined"!=typeof sigma?(sigma.classes=sigma.classes||Object.create(null),sigma.classes.graph=j):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports.graph=j):this.graph=j}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.classes"),sigma.classes.camera=function(a,b,c,d){sigma.classes.dispatcher.extend(this),Object.defineProperty(this,"graph",{value:b}),Object.defineProperty(this,"id",{value:a}),Object.defineProperty(this,"readPrefix",{value:"read_cam"+a+":"}),Object.defineProperty(this,"prefix",{value:"cam"+a+":"}),this.x=0,this.y=0,this.ratio=1,this.angle=0,this.isAnimated=!1,this.settings="object"==typeof d&&d?c.embedObject(d):c},sigma.classes.camera.prototype.goTo=function(b){if(!this.settings("enableCamera"))return this;var c,d,e=b||{},f="ratio"in b&&!this.settings("zoomOnLocation")?["ratio","angle"]:["x","y","ratio","angle"];for(c=0,d=f.length;d>c;c++)if(e[f[c]]!==a){if("number"!=typeof e[f[c]]||isNaN(e[f[c]]))throw'Value for "'+f[c]+'" is not a number.';this[f[c]]=e[f[c]]}return this.dispatchEvent("coordinatesUpdated"),this},sigma.classes.camera.prototype.applyView=function(b,c,d){d=d||{},c=c!==a?c:this.prefix,b=b!==a?b:this.readPrefix;var e,f,g,h=d.nodes||this.graph.nodes(),i=d.edges||this.graph.edges(),j=Math.cos(this.angle)/this.ratio,k=Math.sin(this.angle)/this.ratio,l=Math.pow(this.ratio,this.settings("nodesPowRatio")),m=Math.pow(this.ratio,this.settings("edgesPowRatio")),n=(d.width||0)/2-this.x*j-this.y*k,o=(d.height||0)/2-this.y*j+this.x*k;for(e=0,f=h.length;f>e;e++)g=h[e],g[c+"x"]=(g[b+"x"]||0)*j+(g[b+"y"]||0)*k+n,g[c+"y"]=(g[b+"y"]||0)*j-(g[b+"x"]||0)*k+o,g[c+"size"]=(g[b+"size"]||0)/l;for(e=0,f=i.length;f>e;e++)i[e][c+"size"]=(i[e][b+"size"]||0)/m;return this},sigma.classes.camera.prototype.graphPosition=function(a,b,c){var d=0,e=0,f=Math.cos(this.angle),g=Math.sin(this.angle);return c||(d=-(this.x*f+this.y*g)/this.ratio,e=-(this.y*f-this.x*g)/this.ratio),{x:(a*f+b*g)/this.ratio+d,y:(b*f-a*g)/this.ratio+e}},sigma.classes.camera.prototype.cameraPosition=function(a,b,c){var d=0,e=0,f=Math.cos(this.angle),g=Math.sin(this.angle);return c||(d=-(this.x*f+this.y*g)/this.ratio,e=-(this.y*f-this.x*g)/this.ratio),{x:((a-d)*f-(b-e)*g)*this.ratio,y:((b-e)*f+(a-d)*g)*this.ratio}},sigma.classes.camera.prototype.getMatrix=function(){var a=sigma.utils.matrices.scale(1/this.ratio),b=sigma.utils.matrices.rotation(this.angle),c=sigma.utils.matrices.translation(-this.x,-this.y),d=sigma.utils.matrices.multiply(c,sigma.utils.matrices.multiply(b,a));return d},sigma.classes.camera.prototype.getRectangle=function(a,b){var c=this.cameraPosition(a,0,!0),d=this.cameraPosition(0,b,!0),e=this.cameraPosition(a/2,b/2,!0),f=this.cameraPosition(a/4,0,!0).x,g=this.cameraPosition(0,b/4,!0).y;return{x1:this.x-e.x-f,y1:this.y-e.y-g,x2:this.x-e.x+f+c.x,y2:this.y-e.y-g+c.y,height:Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y+2*g,2))}}}.call(this),function(a){"use strict";function b(a,b){var c=b.x+b.width/2,d=b.y+b.height/2,e=a.y<d,f=a.x<c;return e?f?0:1:f?2:3}function c(a,b){for(var c=[],d=0;4>d;d++)a.x2>=b[d][0].x&&a.x1<=b[d][1].x&&a.y1+a.height>=b[d][0].y&&a.y1<=b[d][2].y&&c.push(d);return c}function d(a,b){for(var c=[],d=0;4>d;d++)j.collision(a,b[d])&&c.push(d);return c}function e(a,b){var c,d,e=b.level+1,f=Math.round(b.bounds.width/2),g=Math.round(b.bounds.height/2),h=Math.round(b.bounds.x),j=Math.round(b.bounds.y);switch(a){case 0:c=h,d=j;break;case 1:c=h+f,d=j;break;case 2:c=h,d=j+g;break;case 3:c=h+f,d=j+g}return i({x:c,y:d,width:f,height:g},e,b.maxElements,b.maxLevel)}function f(b,d,g){if(g.level<g.maxLevel)for(var h=c(d,g.corners),i=0,j=h.length;j>i;i++)g.nodes[h[i]]===a&&(g.nodes[h[i]]=e(h[i],g)),f(b,d,g.nodes[h[i]]);else g.elements.push(b)}function g(c,d){if(d.level<d.maxLevel){var e=b(c,d.bounds);return d.nodes[e]!==a?g(c,d.nodes[e]):[]}return d.elements}function h(b,c,d,e){if(e=e||{},c.level<c.maxLevel)for(var f=d(b,c.corners),g=0,i=f.length;i>g;g++)c.nodes[f[g]]!==a&&h(b,c.nodes[f[g]],d,e);else for(var j=0,k=c.elements.length;k>j;j++)e[c.elements[j].id]===a&&(e[c.elements[j].id]=c.elements[j]);return e}function i(a,b,c,d){return{level:b||0,bounds:a,corners:j.splitSquare(a),maxElements:c||20,maxLevel:d||4,elements:[],nodes:[]}}var j={pointToSquare:function(a){return{x1:a.x-a.size,y1:a.y-a.size,x2:a.x+a.size,y2:a.y-a.size,height:2*a.size}},lineToSquare:function(a){return a.y1<a.y2?a.x1<a.x2?{x1:a.x1-a.size,y1:a.y1-a.size,x2:a.x2+a.size,y2:a.y1-a.size,height:a.y2-a.y1+2*a.size}:{x1:a.x2-a.size,y1:a.y1-a.size,x2:a.x1+a.size,y2:a.y1-a.size,height:a.y2-a.y1+2*a.size}:a.x1<a.x2?{x1:a.x1-a.size,y1:a.y2-a.size,x2:a.x2+a.size,y2:a.y2-a.size,height:a.y1-a.y2+2*a.size}:{x1:a.x2-a.size,y1:a.y2-a.size,x2:a.x1+a.size,y2:a.y2-a.size,height:a.y1-a.y2+2*a.size}},quadraticCurveToSquare:function(a,b){var c=sigma.utils.getPointOnQuadraticCurve(.5,a.x1,a.y1,a.x2,a.y2,b.x,b.y),d=Math.min(a.x1,a.x2,c.x),e=Math.max(a.x1,a.x2,c.x),f=Math.min(a.y1,a.y2,c.y),g=Math.max(a.y1,a.y2,c.y);return{x1:d-a.size,y1:f-a.size,x2:e+a.size,y2:f-a.size,height:g-f+2*a.size}},selfLoopToSquare:function(a){var b=sigma.utils.getSelfLoopControlPoints(a.x,a.y,a.size),c=Math.min(a.x,b.x1,b.x2),d=Math.max(a.x,b.x1,b.x2),e=Math.min(a.y,b.y1,b.y2),f=Math.max(a.y,b.y1,b.y2);return{x1:c-a.size,y1:e-a.size,x2:d+a.size,y2:e-a.size,height:f-e+2*a.size}},isAxisAligned:function(a){return a.x1===a.x2||a.y1===a.y2},axisAlignedTopPoints:function(a){return a.y1===a.y2&&a.x1<a.x2?a:a.x1===a.x2&&a.y2>a.y1?{x1:a.x1-a.height,y1:a.y1,x2:a.x1,y2:a.y1,height:a.height}:a.x1===a.x2&&a.y2<a.y1?{x1:a.x1,y1:a.y2,x2:a.x2+a.height,y2:a.y2,height:a.height}:{x1:a.x2,y1:a.y1-a.height,x2:a.x1,y2:a.y1-a.height,height:a.height}},lowerLeftCoor:function(a){var b=Math.sqrt((a.x2-a.x1)*(a.x2-a.x1)+(a.y2-a.y1)*(a.y2-a.y1));return{x:a.x1-(a.y2-a.y1)*a.height/b,y:a.y1+(a.x2-a.x1)*a.height/b}},lowerRightCoor:function(a,b){return{x:b.x-a.x1+a.x2,y:b.y-a.y1+a.y2}},rectangleCorners:function(a){var b=this.lowerLeftCoor(a),c=this.lowerRightCoor(a,b);return[{x:a.x1,y:a.y1},{x:a.x2,y:a.y2},{x:b.x,y:b.y},{x:c.x,y:c.y}]},splitSquare:function(a){return[[{x:a.x,y:a.y},{x:a.x+a.width/2,y:a.y},{x:a.x,y:a.y+a.height/2},{x:a.x+a.width/2,y:a.y+a.height/2}],[{x:a.x+a.width/2,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width/2,y:a.y+a.height/2},{x:a.x+a.width,y:a.y+a.height/2}],[{x:a.x,y:a.y+a.height/2},{x:a.x+a.width/2,y:a.y+a.height/2},{x:a.x,y:a.y+a.height},{x:a.x+a.width/2,y:a.y+a.height}],[{x:a.x+a.width/2,y:a.y+a.height/2},{x:a.x+a.width,y:a.y+a.height/2},{x:a.x+a.width/2,y:a.y+a.height},{x:a.x+a.width,y:a.y+a.height}]]},axis:function(a,b){return[{x:a[1].x-a[0].x,y:a[1].y-a[0].y},{x:a[1].x-a[3].x,y:a[1].y-a[3].y},{x:b[0].x-b[2].x,y:b[0].y-b[2].y},{x:b[0].x-b[1].x,y:b[0].y-b[1].y}]},projection:function(a,b){var c=(a.x*b.x+a.y*b.y)/(b.x*b.x+b.y*b.y);return{x:c*b.x,y:c*b.y}},axisCollision:function(a,b,c){for(var d=[],e=[],f=0;4>f;f++){var g=this.projection(b[f],a),h=this.projection(c[f],a);d.push(g.x*a.x+g.y*a.y),e.push(h.x*a.x+h.y*a.y)}var i=Math.max.apply(Math,d),j=Math.max.apply(Math,e),k=Math.min.apply(Math,d),l=Math.min.apply(Math,e);return i>=l&&j>=k},collision:function(a,b){for(var c=this.axis(a,b),d=!0,e=0;4>e;e++)d=d&&this.axisCollision(c[e],a,b);return d}},k=function(a){this._geom=j,this._tree=null,this._cache={query:!1,result:!1},this._enabled=!0,this._indexEdges=a||!1};k.prototype.index=function(a,b){if(!this._enabled)return this._tree;if(!b.bounds)throw"sigma.classes.quad.index: bounds information not given.";var c,d,e,g,h,k,l,m=b.prefix||"",n=b.curvatureCoefficients;if(this._tree=i(b.bounds,0,b.maxElements,b.maxLevel),this._indexEdges){var o=a.edges();for(g=0,h=o.length;h>g;g++)d=a.nodes(o[g].source),e=a.nodes(o[g].target),l={x1:d[m+"x"],y1:d[m+"y"],x2:e[m+"x"],y2:e[m+"y"],size:o[g][m+"size"]||0},"curve"===o[g].type||"curvedArrow"===o[g].type?d.id===e.id?(k={x:d[m+"x"],y:d[m+"y"],size:d[m+"size"]||0},f(o[g],j.selfLoopToSquare(k),this._tree)):(c=sigma.utils.getQuadraticControlPoint(l.x1,l.y1,l.x2,l.y2,o[g].cc||n),f(o[g],j.quadraticCurveToSquare(l,c),this._tree)):f(o[g],j.lineToSquare(l),this._tree)}else{var p=a.nodes();for(g=0,h=p.length;h>g;g++)f(p[g],j.pointToSquare({x:p[g][m+"x"],y:p[g][m+"y"],size:p[g][m+"size"]}),this._tree)}return this._cache={query:!1,result:!1},this._tree},k.prototype.point=function(a,b){return this._enabled&&this._tree?g({x:a,y:b},this._tree)||[]:[]},k.prototype.area=function(a){if(!this._enabled)return[];var b,e,f=JSON.stringify(a);if(this._cache.query===f)return this._cache.result;j.isAxisAligned(a)?(b=c,e=j.axisAlignedTopPoints(a)):(b=d,e=j.rectangleCorners(a));var g=this._tree?h(e,this._tree,b):[],i=[];for(var k in g)i.push(g[k]);return this._cache.query=f,this._cache.result=i,i},"undefined"!=typeof this.sigma?(this.sigma.classes=this.sigma.classes||{},this.sigma.classes.quad=k,this.sigma.classes.edgequad=k.bind(this,!0)):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports.quad=k):this.quad=k}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.captors"),sigma.captors.mouse=function(a,b,c){function d(b){z("clickToFocus")||a.focus()}function e(a){var b,c,d;return z("mouseEnabled")&&(w.dispatchEvent("mousemove",sigma.utils.mouseCoords(a)),r)?(s=!0,t=!0,v&&clearTimeout(v),v=setTimeout(function(){s=!1},z("dragTimeout")),sigma.misc.animation.killAll(y),y.isMoving=!0,d=y.cameraPosition(sigma.utils.getX(a)-p,sigma.utils.getY(a)-q,!0),b=l-d.x,c=m-d.y,b===y.x&&c===y.y||(n=y.x,o=y.y,y.goTo({x:b,y:c})),a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation(),!1):void 0}function f(a){if(z("mouseEnabled")&&r){r=!1,v&&clearTimeout(v),y.isMoving=!1;var b=sigma.utils.getX(a),c=sigma.utils.getY(a);s?(sigma.misc.animation.killAll(y),sigma.misc.animation.camera(y,{x:y.x+z("mouseInertiaRatio")*(y.x-n),y:y.y+z("mouseInertiaRatio")*(y.y-o)},{easing:"quadraticOut",duration:z("mouseInertiaDuration")})):p===b&&q===c||y.goTo({x:y.x,y:y.y}),w.dispatchEvent("mouseup",sigma.utils.mouseCoords(a)),s=!1}}function g(a){if(z("mouseEnabled"))switch(l=y.x,m=y.y,n=y.x,o=y.y,p=sigma.utils.getX(a),q=sigma.utils.getY(a),t=!1,u=(new Date).getTime(),a.which){case 2:break;case 3:w.dispatchEvent("rightclick",sigma.utils.mouseCoords(a,p,q));break;default:r=!0,w.dispatchEvent("mousedown",sigma.utils.mouseCoords(a,p,q))}}function h(b){w.eltFocused=!1,a.blur(),z("mouseEnabled")&&w.dispatchEvent("mouseout")}function i(b){if(w.eltFocused=!0,a.focus(),z("mouseEnabled")){var c=sigma.utils.mouseCoords(b);c.isDragging=(new Date).getTime()-u>100&&t,w.dispatchEvent("click",c)}return b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation(),!1}function j(a){var b,c,d;return z("mouseEnabled")?(c=1/z("doubleClickZoomingRatio"),w.dispatchEvent("doubleclick",sigma.utils.mouseCoords(a,p,q)),z("doubleClickEnabled")&&(b=y.cameraPosition(sigma.utils.getX(a)-sigma.utils.getCenter(a).x,sigma.utils.getY(a)-sigma.utils.getCenter(a).y,!0),d={duration:z("doubleClickZoomDuration")},sigma.utils.zoomTo(y,b.x,b.y,c,d)),a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation(),!1):void 0}function k(a){var b,c,d;return z("mouseEnabled")&&z("mouseWheelEnabled")&&(!z("clickToFocus")||w.eltFocused)?(c=sigma.utils.getDelta(a)>0?1/z("zoomingRatio"):z("zoomingRatio"),b=y.cameraPosition(sigma.utils.getX(a)-sigma.utils.getCenter(a).x,sigma.utils.getY(a)-sigma.utils.getCenter(a).y,!0),d={duration:z("mouseZoomDuration")},sigma.utils.zoomTo(y,b.x,b.y,c,d),a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation(),!1):void 0}var l,m,n,o,p,q,r,s,t,u,v,w=this,x=a,y=b,z=c;this.eltFocused=!1,sigma.classes.dispatcher.extend(this),sigma.utils.doubleClick(x,"click",j),x.addEventListener("DOMMouseScroll",k,!1),x.addEventListener("mousewheel",k,!1),x.addEventListener("mousemove",e,!1),x.addEventListener("mousedown",g,!1),x.addEventListener("click",i,!1),x.addEventListener("mouseout",h,!1),x.addEventListener("mouseenter",d,!1),document.addEventListener("mouseup",f,!1),this.kill=function(){sigma.utils.unbindDoubleClick(x,"click"),x.removeEventListener("DOMMouseScroll",k),x.removeEventListener("mousewheel",k),x.removeEventListener("mousemove",e),x.removeEventListener("mousedown",g),x.removeEventListener("click",i),x.removeEventListener("mouseout",h),document.removeEventListener("mouseup",f)}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.captors"),sigma.captors.touch=function(a,b,c){function d(a){var b=sigma.utils.getOffset(B);return{x:a.pageX-b.left,y:a.pageY-b.top}}function e(a){if(D("touchEnabled")){var b,c,e,f,g,h;switch(E=a.touches,E.length){case 1:C.isMoving=!0,w=1,i=C.x,j=C.y,m=C.x,n=C.y,g=d(E[0]),q=g.x,r=g.y;break;case 2:return C.isMoving=!0,w=2,g=d(E[0]),h=d(E[1]),b=g.x,e=g.y,c=h.x,f=h.y,m=C.x,n=C.y,k=C.angle,l=C.ratio,i=C.x,j=C.y,q=b,r=e,s=c,t=f,u=Math.atan2(t-r,s-q),v=Math.sqrt((t-r)*(t-r)+(s-q)*(s-q)),a.preventDefault(),!1}}}function f(a){if(D("touchEnabled")){E=a.touches;var b=D("touchInertiaRatio");switch(z&&(x=!1,clearTimeout(z)),w){case 2:if(1===a.touches.length){e(a),a.preventDefault();break}case 1:C.isMoving=!1,A.dispatchEvent("stopDrag"),x&&(y=!1,sigma.misc.animation.camera(C,{x:C.x+b*(C.x-m),y:C.y+b*(C.y-n)},{easing:"quadraticOut",duration:D("touchInertiaDuration")})),x=!1,w=0}}}function g(a){if(!y&&D("touchEnabled")){var b,c,e,f,g,h,B,F,G,H,I,J,K,L,M,N,O;switch(E=a.touches,x=!0,z&&clearTimeout(z),z=setTimeout(function(){x=!1},D("dragTimeout")),w){case 1:F=d(E[0]),b=F.x,e=F.y,H=C.cameraPosition(b-q,e-r,!0),L=i-H.x,M=j-H.y,L===C.x&&M===C.y||(m=C.x,n=C.y,C.goTo({x:L,y:M}),A.dispatchEvent("mousemove",sigma.utils.mouseCoords(a,F.x,F.y)),A.dispatchEvent("drag"));break;case 2:F=d(E[0]),G=d(E[1]),b=F.x,e=F.y,c=G.x,f=G.y,I=C.cameraPosition((q+s)/2-sigma.utils.getCenter(a).x,(r+t)/2-sigma.utils.getCenter(a).y,!0),B=C.cameraPosition((b+c)/2-sigma.utils.getCenter(a).x,(e+f)/2-sigma.utils.getCenter(a).y,!0),J=Math.atan2(f-e,c-b)-u,K=Math.sqrt((f-e)*(f-e)+(c-b)*(c-b))/v,b=I.x,e=I.y,N=l/K,b*=K,e*=K,O=k-J,g=Math.cos(-J),h=Math.sin(-J),c=b*g+e*h,f=e*g-b*h,b=c,e=f,L=b-B.x+i,M=e-B.y+j,N===C.ratio&&O===C.angle&&L===C.x&&M===C.y||(m=C.x,n=C.y,o=C.angle,p=C.ratio,C.goTo({x:L,y:M,angle:O,ratio:N}),A.dispatchEvent("drag"))}return a.preventDefault(),!1}}function h(a){var b,c,e;return a.touches&&1===a.touches.length&&D("touchEnabled")?(y=!0,c=1/D("doubleClickZoomingRatio"),b=d(a.touches[0]),A.dispatchEvent("doubleclick",sigma.utils.mouseCoords(a,b.x,b.y)),D("doubleClickEnabled")&&(b=C.cameraPosition(b.x-sigma.utils.getCenter(a).x,b.y-sigma.utils.getCenter(a).y,!0),e={duration:D("doubleClickZoomDuration"),onComplete:function(){y=!1}},sigma.utils.zoomTo(C,b.x,b.y,c,e)),a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation(),!1):void 0}var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this,B=a,C=b,D=c,E=[];sigma.classes.dispatcher.extend(this),sigma.utils.doubleClick(B,"touchstart",h),B.addEventListener("touchstart",e,!1),B.addEventListener("touchend",f,!1),B.addEventListener("touchcancel",f,!1),B.addEventListener("touchleave",f,!1),B.addEventListener("touchmove",g,!1),this.kill=function(){sigma.utils.unbindDoubleClick(B,"touchstart"),B.addEventListener("touchstart",e),B.addEventListener("touchend",f),B.addEventListener("touchcancel",f),B.addEventListener("touchleave",f),B.addEventListener("touchmove",g)}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";if("undefined"==typeof conrad)throw"conrad is not declared";sigma.utils.pkg("sigma.renderers"),sigma.renderers.canvas=function(a,b,c,d){if("object"!=typeof d)throw"sigma.renderers.canvas: Wrong arguments.";if(!(d.container instanceof HTMLElement))throw"Container not found.";var e,f,g,h;for(sigma.classes.dispatcher.extend(this),Object.defineProperty(this,"conradId",{value:sigma.utils.id()}),this.graph=a,this.camera=b,this.contexts={},this.domElements={},this.options=d,this.container=this.options.container,this.settings="object"==typeof d.settings&&d.settings?c.embedObjects(d.settings):c,this.nodesOnScreen=[],this.edgesOnScreen=[],this.jobs={},this.options.prefix="renderer"+this.conradId+":",this.settings("batchEdgesDrawing")?(this.initDOM("canvas","edges"),this.initDOM("canvas","scene"),this.contexts.nodes=this.contexts.scene,this.contexts.labels=this.contexts.scene):(this.initDOM("canvas","scene"),this.contexts.edges=this.contexts.scene,this.contexts.nodes=this.contexts.scene,this.contexts.labels=this.contexts.scene),this.initDOM("canvas","mouse"),this.contexts.hover=this.contexts.mouse,this.captors=[],g=this.options.captors||[sigma.captors.mouse,sigma.captors.touch],e=0,f=g.length;f>e;e++)h="function"==typeof g[e]?g[e]:sigma.captors[g[e]],this.captors.push(new h(this.domElements.mouse,this.camera,this.settings));sigma.misc.bindEvents.call(this,this.options.prefix),sigma.misc.drawHovers.call(this,this.options.prefix),this.resize(!1)},sigma.renderers.canvas.applyRenderers=function(a){var b,c,d,e=a.elements,f={font:a.ctx.font},g=a.elements||"edges"==a.type?"defaultEdgeType":"defaultNodeType";for(a.start=a.start||0,a.end=a.end||a.elements.length,a.end=Math.min(a.elements.length,a.end),a.ctx.save(),b=a.start;b<a.end;b++)e[b].hidden||(c=a.renderers[e[b].type||a.settings(g)],d=c||a.renderers.def,"edges"==a.type?d(e[b],a.graph.nodes(e[b].source),a.graph.nodes(e[b].target),a.ctx,a.settings,{ctx:f}):d(e[b],a.ctx,a.settings,{ctx:f}));a.ctx.restore()},sigma.renderers.canvas.prototype.renderEdges=function(a,b,c){var d={renderers:sigma.canvas.edges,type:"edges",elements:this.edgesOnScreen,ctx:this.contexts.edges,start:a,end:b,graph:this.graph,settings:c};sigma.renderers.canvas.applyRenderers(d),c("drawEdgeLabels")&&(d.renderers=sigma.canvas.edges.labels,d.ctx=this.contexts.labels,sigma.renderers.canvas.applyRenderers(d))},sigma.renderers.canvas.prototype.render=function(b){b=b||{},this.dispatchEvent("beforeRender");var c,d,e,f,g,h,i,j,k,l,m,n,o={},p=this.graph,q=this.graph.nodes,r=(this.options.prefix||"",this.settings(b,"drawEdges")),s=this.settings(b,"drawNodes"),t=this.settings(b,"drawLabels"),u=this.settings.embedObjects(b,{prefix:this.options.prefix});this.resize(!1),this.settings(b,"hideEdgesOnMove")&&(this.camera.isAnimated||this.camera.isMoving)&&(r=!1),this.camera.applyView(a,this.options.prefix,{width:this.width,height:this.height}),this.clear();for(e in this.jobs)conrad.hasJob(e)&&conrad.killJob(e);for(this.nodesOnScreen=this.camera.quadtree.area(this.camera.getRectangle(this.width,this.height)),c=this.nodesOnScreen,d=0,f=c.length;f>d;d++)o[c[d].id]=c[d];if(r){if(this.edgesOnScreen=[],u("edgesClippingWithNodes"))for(c=p.edges(),d=0,f=c.length;f>d;d++)g=c[d],!o[g.source]&&!o[g.target]||g.hidden||q(g.source).hidden||q(g.target).hidden||this.edgesOnScreen.push(g);else this.edgesOnScreen=this.camera.edgequadtree.area(this.camera.getRectangle(this.width,this.height));u("batchEdgesDrawing")?(h="edges_"+this.conradId,m=u("canvasEdgesBatchSize"),l=this.edgesOnScreen,f=l.length,k=0,i=Math.min(l.length,k+m),j=function(){return n=this.contexts.edges.globalCompositeOperation,this.contexts.edges.globalCompositeOperation="destination-over",this.renderEdges(k,i,u),this.contexts.edges.globalCompositeOperation=n,i===l.length?(delete this.jobs[h],!1):(k=i+1,i=Math.min(l.length,k+m),!0)},this.jobs[h]=j,conrad.addJob(h,j.bind(this))):this.renderEdges(0,this.edgesOnScreen.length,u)}return s&&sigma.renderers.canvas.applyRenderers({renderers:sigma.canvas.nodes,type:"nodes",ctx:this.contexts.nodes,elements:this.nodesOnScreen,settings:u}),t&&sigma.renderers.canvas.applyRenderers({renderers:sigma.canvas.labels,type:"nodes",ctx:this.contexts.labels,elements:this.nodesOnScreen,settings:u}),this.dispatchEvent("render"),this},sigma.renderers.canvas.prototype.initDOM=function(a,b){var c=document.createElement(a);c.style.position="absolute",c.setAttribute("class","sigma-"+b),this.domElements[b]=c,this.container.appendChild(c),"canvas"===a.toLowerCase()&&(this.contexts[b]=c.getContext("2d"))},sigma.renderers.canvas.prototype.resize=function(b,c){var d,e=this.width,f=this.height,g=sigma.utils.getPixelRatio();if(b!==a&&c!==a?(this.width=b,this.height=c):(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,b=this.width,c=this.height),e!==this.width||f!==this.height)for(d in this.domElements)this.domElements[d].style.width=b+"px",this.domElements[d].style.height=c+"px","canvas"===this.domElements[d].tagName.toLowerCase()&&(this.domElements[d].setAttribute("width",b*g+"px"),this.domElements[d].setAttribute("height",c*g+"px"),1!==g&&this.contexts[d].scale(g,g));return this},sigma.renderers.canvas.prototype.clear=function(){for(var a in this.contexts)this.contexts[a].clearRect(0,0,this.width,this.height);return this},sigma.renderers.canvas.prototype.kill=function(){for(var a,b;b=this.captors.pop();)b.kill();delete this.captors;for(a in this.domElements)this.domElements[a].parentNode.removeChild(this.domElements[a]),delete this.domElements[a],delete this.contexts[a];delete this.domElements,delete this.contexts},sigma.utils.pkg("sigma.canvas.nodes"),sigma.utils.pkg("sigma.canvas.edges"),sigma.utils.pkg("sigma.canvas.labels")}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.renderers"),sigma.renderers.webgl=function(a,b,c,d){if("object"!=typeof d)throw"sigma.renderers.webgl: Wrong arguments.";if(!(d.container instanceof HTMLElement))throw"Container not found.";var e,f,g,h;for(sigma.classes.dispatcher.extend(this),this.jobs={},Object.defineProperty(this,"conradId",{value:sigma.utils.id()}),this.graph=a,this.camera=b,this.contexts={},this.domElements={},this.options=d,this.container=this.options.container,this.settings="object"==typeof d.settings&&d.settings?c.embedObjects(d.settings):c,this.options.prefix=this.camera.readPrefix,Object.defineProperty(this,"nodePrograms",{value:{}}),Object.defineProperty(this,"edgePrograms",{value:{}}),Object.defineProperty(this,"nodeFloatArrays",{value:{}}),Object.defineProperty(this,"edgeFloatArrays",{value:{}}),Object.defineProperty(this,"edgeIndicesArrays",{value:{}}),this.settings(d,"batchEdgesDrawing")?(this.initDOM("canvas","edges",!0),this.initDOM("canvas","nodes",!0)):(this.initDOM("canvas","scene",!0),this.contexts.nodes=this.contexts.scene,this.contexts.edges=this.contexts.scene),this.initDOM("canvas","labels"),this.initDOM("canvas","mouse"),this.contexts.hover=this.contexts.mouse,this.captors=[],g=this.options.captors||[sigma.captors.mouse,sigma.captors.touch],e=0,f=g.length;f>e;e++)h="function"==typeof g[e]?g[e]:sigma.captors[g[e]],this.captors.push(new h(this.domElements.mouse,this.camera,this.settings));sigma.misc.bindEvents.call(this,this.camera.prefix),sigma.misc.drawHovers.call(this,this.camera.prefix),this.resize()},sigma.renderers.webgl.prototype.process=function(){var a,b,c,d,e,f,g=this.graph,h=sigma.utils.extend(h,this.options),i=this.settings(h,"defaultEdgeType"),j=this.settings(h,"defaultNodeType");for(d in this.nodeFloatArrays)delete this.nodeFloatArrays[d];for(d in this.edgeFloatArrays)delete this.edgeFloatArrays[d];for(d in this.edgeIndicesArrays)delete this.edgeIndicesArrays[d];for(a=g.edges(),b=0,c=a.length;c>b;b++)e=a[b].type||i,d=e&&sigma.webgl.edges[e]?e:"def",this.edgeFloatArrays[d]||(this.edgeFloatArrays[d]={edges:[]}),this.edgeFloatArrays[d].edges.push(a[b]);for(a=g.nodes(),b=0,c=a.length;c>b;b++)e=a[b].type||j,d=e&&sigma.webgl.nodes[e]?e:"def",this.nodeFloatArrays[d]||(this.nodeFloatArrays[d]={nodes:[]}),this.nodeFloatArrays[d].nodes.push(a[b]);for(d in this.edgeFloatArrays){for(f=sigma.webgl.edges[d],a=this.edgeFloatArrays[d].edges,this.edgeFloatArrays[d].array=new Float32Array(a.length*f.POINTS*f.ATTRIBUTES),
b=0,c=a.length;c>b;b++)a[b].hidden||g.nodes(a[b].source).hidden||g.nodes(a[b].target).hidden||f.addEdge(a[b],g.nodes(a[b].source),g.nodes(a[b].target),this.edgeFloatArrays[d].array,b*f.POINTS*f.ATTRIBUTES,h.prefix,this.settings);"function"==typeof f.computeIndices&&(this.edgeIndicesArrays[d]=f.computeIndices(this.edgeFloatArrays[d].array))}for(d in this.nodeFloatArrays)for(f=sigma.webgl.nodes[d],a=this.nodeFloatArrays[d].nodes,this.nodeFloatArrays[d].array=new Float32Array(a.length*f.POINTS*f.ATTRIBUTES),b=0,c=a.length;c>b;b++)this.nodeFloatArrays[d].array||(this.nodeFloatArrays[d].array=new Float32Array(a.length*f.POINTS*f.ATTRIBUTES)),a[b].hidden||f.addNode(a[b],this.nodeFloatArrays[d].array,b*f.POINTS*f.ATTRIBUTES,h.prefix,this.settings);return this},sigma.renderers.webgl.prototype.render=function(b){var c,d,e,f,g,h,i=this,j=(this.graph,this.contexts.nodes),k=this.contexts.edges,l=this.camera.getMatrix(),m=sigma.utils.extend(b,this.options),n=this.settings(m,"drawLabels"),o=this.settings(m,"drawEdges"),p=this.settings(m,"drawNodes");this.resize(!1),this.settings(m,"hideEdgesOnMove")&&(this.camera.isAnimated||this.camera.isMoving)&&(o=!1),this.clear(),l=sigma.utils.matrices.multiply(l,sigma.utils.matrices.translation(this.width/2,this.height/2));for(f in this.jobs)conrad.hasJob(f)&&conrad.killJob(f);if(o)if(this.settings(m,"batchEdgesDrawing"))(function(){var a,b,c,d,e,f,g,h,i,j;c="edges_"+this.conradId,j=this.settings(m,"webglEdgesBatchSize"),a=Object.keys(this.edgeFloatArrays),a.length&&(b=0,i=sigma.webgl.edges[a[b]],e=this.edgeFloatArrays[a[b]].array,h=this.edgeIndicesArrays[a[b]],g=0,f=Math.min(g+j*i.POINTS,e.length/i.ATTRIBUTES),d=function(){return this.edgePrograms[a[b]]||(this.edgePrograms[a[b]]=i.initProgram(k)),f>g&&(k.useProgram(this.edgePrograms[a[b]]),i.render(k,this.edgePrograms[a[b]],e,{settings:this.settings,matrix:l,width:this.width,height:this.height,ratio:this.camera.ratio,scalingRatio:this.settings(m,"webglOversamplingRatio"),start:g,count:f-g,indicesData:h})),f>=e.length/i.ATTRIBUTES&&b===a.length-1?(delete this.jobs[c],!1):(f>=e.length/i.ATTRIBUTES?(b++,e=this.edgeFloatArrays[a[b]].array,i=sigma.webgl.edges[a[b]],g=0,f=Math.min(g+j*i.POINTS,e.length/i.ATTRIBUTES)):(g=f,f=Math.min(g+j*i.POINTS,e.length/i.ATTRIBUTES)),!0)},this.jobs[c]=d,conrad.addJob(c,d.bind(this)))}).call(this);else for(f in this.edgeFloatArrays)h=sigma.webgl.edges[f],this.edgePrograms[f]||(this.edgePrograms[f]=h.initProgram(k)),this.edgeFloatArrays[f]&&(k.useProgram(this.edgePrograms[f]),h.render(k,this.edgePrograms[f],this.edgeFloatArrays[f].array,{settings:this.settings,matrix:l,width:this.width,height:this.height,ratio:this.camera.ratio,scalingRatio:this.settings(m,"webglOversamplingRatio"),indicesData:this.edgeIndicesArrays[f]}));if(p){j.blendFunc(j.SRC_ALPHA,j.ONE_MINUS_SRC_ALPHA),j.enable(j.BLEND);for(f in this.nodeFloatArrays)h=sigma.webgl.nodes[f],this.nodePrograms[f]||(this.nodePrograms[f]=h.initProgram(j)),this.nodeFloatArrays[f]&&(j.useProgram(this.nodePrograms[f]),h.render(j,this.nodePrograms[f],this.nodeFloatArrays[f].array,{settings:this.settings,matrix:l,width:this.width,height:this.height,ratio:this.camera.ratio,scalingRatio:this.settings(m,"webglOversamplingRatio")}))}if(n)for(c=this.camera.quadtree.area(this.camera.getRectangle(this.width,this.height)),this.camera.applyView(a,a,{nodes:c,edges:[],width:this.width,height:this.height}),g=function(a){return i.settings({prefix:i.camera.prefix},a)},d=0,e=c.length;e>d;d++)c[d].hidden||(sigma.canvas.labels[c[d].type||this.settings(m,"defaultNodeType")]||sigma.canvas.labels.def)(c[d],this.contexts.labels,g);return this.dispatchEvent("render"),this},sigma.renderers.webgl.prototype.initDOM=function(a,b,c){var d=document.createElement(a),e=this;d.style.position="absolute",d.setAttribute("class","sigma-"+b),this.domElements[b]=d,this.container.appendChild(d),"canvas"===a.toLowerCase()&&(this.contexts[b]=d.getContext(c?"experimental-webgl":"2d",{preserveDrawingBuffer:!0}),c&&(d.addEventListener("webglcontextlost",function(a){a.preventDefault()},!1),d.addEventListener("webglcontextrestored",function(a){e.render()},!1)))},sigma.renderers.webgl.prototype.resize=function(b,c){var d,e=this.width,f=this.height,g=sigma.utils.getPixelRatio();if(b!==a&&c!==a?(this.width=b,this.height=c):(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,b=this.width,c=this.height),e!==this.width||f!==this.height)for(d in this.domElements)this.domElements[d].style.width=b+"px",this.domElements[d].style.height=c+"px","canvas"===this.domElements[d].tagName.toLowerCase()&&(this.contexts[d]&&this.contexts[d].scale?(this.domElements[d].setAttribute("width",b*g+"px"),this.domElements[d].setAttribute("height",c*g+"px"),1!==g&&this.contexts[d].scale(g,g)):(this.domElements[d].setAttribute("width",b*this.settings("webglOversamplingRatio")+"px"),this.domElements[d].setAttribute("height",c*this.settings("webglOversamplingRatio")+"px")));for(d in this.contexts)this.contexts[d]&&this.contexts[d].viewport&&this.contexts[d].viewport(0,0,this.width*this.settings("webglOversamplingRatio"),this.height*this.settings("webglOversamplingRatio"));return this},sigma.renderers.webgl.prototype.clear=function(){return this.contexts.labels.clearRect(0,0,this.width,this.height),this.contexts.nodes.clear(this.contexts.nodes.COLOR_BUFFER_BIT),this.contexts.edges.clear(this.contexts.edges.COLOR_BUFFER_BIT),this},sigma.renderers.webgl.prototype.kill=function(){for(var a,b;b=this.captors.pop();)b.kill();delete this.captors;for(a in this.domElements)this.domElements[a].parentNode.removeChild(this.domElements[a]),delete this.domElements[a],delete this.contexts[a];delete this.domElements,delete this.contexts},sigma.utils.pkg("sigma.webgl.nodes"),sigma.utils.pkg("sigma.webgl.edges"),sigma.utils.pkg("sigma.canvas.labels")}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";if("undefined"==typeof conrad)throw"conrad is not declared";sigma.utils.pkg("sigma.renderers"),sigma.renderers.svg=function(a,b,c,d){if("object"!=typeof d)throw"sigma.renderers.svg: Wrong arguments.";if(!(d.container instanceof HTMLElement))throw"Container not found.";var e,f,g,h,i=this;for(sigma.classes.dispatcher.extend(this),this.graph=a,this.camera=b,this.domElements={graph:null,groups:{},nodes:{},edges:{},labels:{},edgelabels:{},hovers:{}},this.measurementCanvas=null,this.options=d,this.container=this.options.container,this.settings="object"==typeof d.settings&&d.settings?c.embedObjects(d.settings):c,this.settings("freeStyle",!!this.options.freeStyle),this.settings("xmlns","http://www.w3.org/2000/svg"),this.nodesOnScreen=[],this.edgesOnScreen=[],this.options.prefix="renderer"+sigma.utils.id()+":",this.initDOM("svg"),this.captors=[],g=this.options.captors||[sigma.captors.mouse,sigma.captors.touch],e=0,f=g.length;f>e;e++)h="function"==typeof g[e]?g[e]:sigma.captors[g[e]],this.captors.push(new h(this.domElements.graph,this.camera,this.settings));window.addEventListener("resize",function(){i.resize()}),sigma.misc.bindDOMEvents.call(this,this.domElements.graph),this.bindHovers(this.options.prefix),this.resize(!1)},sigma.renderers.svg.prototype.render=function(b){b=b||{},this.dispatchEvent("beforeRender");var c,d,e,f,g,h,i,j,k,l={},m=this.graph,n=this.graph.nodes,o=(this.options.prefix||"",this.settings(b,"drawEdges")),p=this.settings(b,"drawNodes"),q=this.settings(b,"drawLabels"),r=this.settings(b,"drawEdgeLabels"),s=this.settings(b,"defaultEdgeType"),t=this.settings.embedObjects(b,{prefix:this.options.prefix,forceLabels:this.options.forceLabels});for(this.settings(b,"hideEdgesOnMove")&&(this.camera.isAnimated||this.camera.isMoving)&&(o=!1),this.camera.applyView(a,this.options.prefix,{width:this.width,height:this.height}),this.hideDOMElements(this.domElements.nodes),this.hideDOMElements(this.domElements.edges),this.hideDOMElements(this.domElements.labels),this.hideDOMElements(this.domElements.edgelabels),this.edgesOnScreen=[],this.nodesOnScreen=this.camera.quadtree.area(this.camera.getRectangle(this.width,this.height)),c=this.nodesOnScreen,d=0,f=c.length;f>d;d++)l[c[d].id]=c[d];for(c=m.edges(),d=0,f=c.length;f>d;d++)g=c[d],!l[g.source]&&!l[g.target]||g.hidden||n(g.source).hidden||n(g.target).hidden||this.edgesOnScreen.push(g);if(j=sigma.svg.nodes,k=sigma.svg.labels,p)for(c=this.nodesOnScreen,d=0,f=c.length;f>d;d++)c[d].hidden||this.domElements.nodes[c[d].id]||(e=(j[c[d].type]||j.def).create(c[d],t),this.domElements.nodes[c[d].id]=e,this.domElements.groups.nodes.appendChild(e),q&&(e=(k[c[d].type]||k.def).create(c[d],t),this.domElements.labels[c[d].id]=e,this.domElements.groups.labels.appendChild(e)));if(p)for(c=this.nodesOnScreen,d=0,f=c.length;f>d;d++)c[d].hidden||((j[c[d].type]||j.def).update(c[d],this.domElements.nodes[c[d].id],t),q&&(k[c[d].type]||k.def).update(c[d],this.domElements.labels[c[d].id],t));if(j=sigma.svg.edges,k=sigma.svg.edges.labels,o)for(c=this.edgesOnScreen,d=0,f=c.length;f>d;d++)this.domElements.edges[c[d].id]||(h=n(c[d].source),i=n(c[d].target),e=(j[c[d].type]||j[s]||j.def).create(c[d],h,i,t),this.domElements.edges[c[d].id]=e,this.domElements.groups.edges.appendChild(e),r&&(e=(k[c[d].type]||k[s]||k.def).create(c[d],t),this.domElements.edgelabels[c[d].id]=e,this.domElements.groups.edgelabels.appendChild(e)));if(o)for(c=this.edgesOnScreen,d=0,f=c.length;f>d;d++)h=n(c[d].source),i=n(c[d].target),(j[c[d].type]||j[s]||j.def).update(c[d],this.domElements.edges[c[d].id],h,i,t),r&&(k[c[d].type]||k[s]||k.def).update(c[d],h,i,this.domElements.edgelabels[c[d].id],t);return this.dispatchEvent("render"),this},sigma.renderers.svg.prototype.initDOM=function(a){var b,c,d,e=document.createElementNS(this.settings("xmlns"),a),f=this.settings("classPrefix");e.style.position="absolute",e.setAttribute("class",f+"-svg"),e.setAttribute("xmlns",this.settings("xmlns")),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttribute("version","1.1");var g=document.createElement("canvas");g.setAttribute("class",f+"-measurement-canvas"),this.domElements.graph=this.container.appendChild(e);var h=["edges","nodes","edgelabels","labels","hovers"];for(d=0,c=h.length;c>d;d++)b=document.createElementNS(this.settings("xmlns"),"g"),b.setAttributeNS(null,"id",f+"-group-"+h[d]),b.setAttributeNS(null,"class",f+"-group"),this.domElements.groups[h[d]]=this.domElements.graph.appendChild(b);this.container.appendChild(g),this.measurementCanvas=g.getContext("2d")},sigma.renderers.svg.prototype.hideDOMElements=function(a){var b,c;for(c in a)b=a[c],sigma.svg.utils.hide(b);return this},sigma.renderers.svg.prototype.bindHovers=function(a){function b(b){var c,g=f.settings.embedObjects({prefix:a});if(g("enableHovering"))if(b.data.enter.nodes.length>0){c=b.data.enter.nodes[0];var h=(e[c.type]||e.def).create(c,f.domElements.nodes[c.id],f.measurementCanvas,g);f.domElements.hovers[c.id]=h,f.domElements.groups.hovers.appendChild(h),d=c}else b.data.leave.nodes.length>0&&(c=b.data.leave.nodes[0],f.domElements.groups.hovers.removeChild(f.domElements.hovers[c.id]),d=null,delete f.domElements.hovers[c.id],f.domElements.groups.nodes.appendChild(f.domElements.nodes[c.id]))}function c(){if(d){var b=f.settings.embedObjects({prefix:a});f.domElements.groups.hovers.removeChild(f.domElements.hovers[d.id]),delete f.domElements.hovers[d.id];var c=(e[d.type]||e.def).create(d,f.domElements.nodes[d.id],f.measurementCanvas,b);f.domElements.hovers[d.id]=c,f.domElements.groups.hovers.appendChild(c)}}var d,e=sigma.svg.hovers,f=this;this.bind("hovers",b),this.bind("render",c)},sigma.renderers.svg.prototype.resize=function(b,c){var d=this.width,e=this.height;return b!==a&&c!==a?(this.width=b,this.height=c):(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight),d===this.width&&e===this.height||(this.domElements.graph.style.width=this.width+"px",this.domElements.graph.style.height=this.height+"px"),this},sigma.utils.pkg("sigma.svg.nodes"),sigma.utils.pkg("sigma.svg.edges"),sigma.utils.pkg("sigma.svg.labels"),sigma.utils.pkg("sigma.svg.edgelabels")}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.renderers"),sigma.renderers.def=sigma.utils.isWebGLSupported()?sigma.renderers.webgl:sigma.renderers.canvas}(this),function(){"use strict";sigma.utils.pkg("sigma.webgl.nodes"),sigma.webgl.nodes.def={POINTS:3,ATTRIBUTES:5,addNode:function(a,b,c,d,e){var f=sigma.utils.floatColor(a.color||e("defaultNodeColor"));b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=f,b[c++]=0,b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=f,b[c++]=2*Math.PI/3,b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=f,b[c++]=4*Math.PI/3},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_position"),g=a.getAttribLocation(b,"a_size"),h=a.getAttribLocation(b,"a_color"),i=a.getAttribLocation(b,"a_angle"),j=a.getUniformLocation(b,"u_resolution"),k=a.getUniformLocation(b,"u_matrix"),l=a.getUniformLocation(b,"u_ratio"),m=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.DYNAMIC_DRAW),a.uniform2f(j,d.width,d.height),a.uniform1f(l,1/Math.pow(d.ratio,d.settings("nodesPowRatio"))),a.uniform1f(m,d.scalingRatio),a.uniformMatrix3fv(k,!1,d.matrix),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.enableVertexAttribArray(i),a.vertexAttribPointer(f,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(g,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(h,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,12),a.vertexAttribPointer(i,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16),a.drawArrays(a.TRIANGLES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position;","attribute float a_size;","attribute float a_color;","attribute float a_angle;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","varying vec4 color;","varying vec2 center;","varying float radius;","void main() {","radius = a_size * u_ratio;","vec2 position = (u_matrix * vec3(a_position, 1)).xy;","center = position * u_scale;","center = vec2(center.x, u_scale * u_resolution.y - center.y);","position = position +","2.0 * radius * vec2(cos(a_angle), sin(a_angle));","position = (position / u_resolution * 2.0 - 1.0) * vec2(1, -1);","radius = radius * u_scale;","gl_Position = vec4(position, 0, 1);","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","varying vec2 center;","varying float radius;","void main(void) {","vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);","vec2 m = gl_FragCoord.xy - center;","float diff = radius - sqrt(m.x * m.x + m.y * m.y);","if (diff > 0.0)","gl_FragColor = color;","else","gl_FragColor = color0;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.nodes"),sigma.webgl.nodes.fast={POINTS:1,ATTRIBUTES:4,addNode:function(a,b,c,d,e){b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=sigma.utils.floatColor(a.color||e("defaultNodeColor"))},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_position"),g=a.getAttribLocation(b,"a_size"),h=a.getAttribLocation(b,"a_color"),i=a.getUniformLocation(b,"u_resolution"),j=a.getUniformLocation(b,"u_matrix"),k=a.getUniformLocation(b,"u_ratio"),l=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.DYNAMIC_DRAW),a.uniform2f(i,d.width,d.height),a.uniform1f(k,1/Math.pow(d.ratio,d.settings("nodesPowRatio"))),a.uniform1f(l,d.scalingRatio),a.uniformMatrix3fv(j,!1,d.matrix),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.vertexAttribPointer(f,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(g,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(h,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,12),a.drawArrays(a.POINTS,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position;","attribute float a_size;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","varying vec4 color;","void main() {","gl_Position = vec4(","((u_matrix * vec3(a_position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","gl_PointSize = a_size * u_ratio * u_scale * 2.0;","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","float border = 0.01;","float radius = 0.5;","vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);","vec2 m = gl_PointCoord - vec2(0.5, 0.5);","float dist = radius - sqrt(m.x * m.x + m.y * m.y);","float t = 0.0;","if (dist > border)","t = 1.0;","else if (dist > 0.0)","t = dist / border;","gl_FragColor = mix(color0, color, t);","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.edges"),sigma.webgl.edges.def={POINTS:6,ATTRIBUTES:7,addEdge:function(a,b,c,d,e,f,g){var h=(a[f+"size"]||1)/2,i=b[f+"x"],j=b[f+"y"],k=c[f+"x"],l=c[f+"y"],m=a.color;if(!m)switch(g("edgeColor")){case"source":m=b.color||g("defaultNodeColor");break;case"target":m=c.color||g("defaultNodeColor");break;default:m=g("defaultEdgeColor")}m=sigma.utils.floatColor(m),d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=0,d[e++]=m,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=1,d[e++]=m,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=0,d[e++]=m,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=0,d[e++]=m,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=1,d[e++]=m,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=0,d[e++]=m},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_color"),g=a.getAttribLocation(b,"a_position1"),h=a.getAttribLocation(b,"a_position2"),i=a.getAttribLocation(b,"a_thickness"),j=a.getAttribLocation(b,"a_minus"),k=a.getUniformLocation(b,"u_resolution"),l=a.getUniformLocation(b,"u_matrix"),m=a.getUniformLocation(b,"u_matrixHalfPi"),n=a.getUniformLocation(b,"u_matrixHalfPiMinus"),o=a.getUniformLocation(b,"u_ratio"),p=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW),a.uniform2f(k,d.width,d.height),a.uniform1f(o,d.ratio/Math.pow(d.ratio,d.settings("edgesPowRatio"))),a.uniform1f(p,d.scalingRatio),a.uniformMatrix3fv(l,!1,d.matrix),a.uniformMatrix2fv(m,!1,sigma.utils.matrices.rotation(Math.PI/2,!0)),a.uniformMatrix2fv(n,!1,sigma.utils.matrices.rotation(-Math.PI/2,!0)),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.enableVertexAttribArray(i),a.enableVertexAttribArray(j),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(h,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(i,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16),a.vertexAttribPointer(j,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20),a.vertexAttribPointer(f,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,24),a.drawArrays(a.TRIANGLES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position1;","attribute vec2 a_position2;","attribute float a_thickness;","attribute float a_minus;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","uniform mat2 u_matrixHalfPi;","uniform mat2 u_matrixHalfPiMinus;","varying vec4 color;","void main() {","vec2 position = a_thickness * u_ratio *","normalize(a_position2 - a_position1);","mat2 matrix = a_minus * u_matrixHalfPiMinus +","(1.0 - a_minus) * u_matrixHalfPi;","position = matrix * position + a_position1;","gl_Position = vec4(","((u_matrix * vec3(position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.edges"),sigma.webgl.edges.fast={POINTS:2,ATTRIBUTES:3,addEdge:function(a,b,c,d,e,f,g){var h=((a[f+"size"]||1)/2,b[f+"x"]),i=b[f+"y"],j=c[f+"x"],k=c[f+"y"],l=a.color;if(!l)switch(g("edgeColor")){case"source":l=b.color||g("defaultNodeColor");break;case"target":l=c.color||g("defaultNodeColor");break;default:l=g("defaultEdgeColor")}l=sigma.utils.floatColor(l),d[e++]=h,d[e++]=i,d[e++]=l,d[e++]=j,d[e++]=k,d[e++]=l},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_color"),g=a.getAttribLocation(b,"a_position"),h=a.getUniformLocation(b,"u_resolution"),i=a.getUniformLocation(b,"u_matrix");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.DYNAMIC_DRAW),a.uniform2f(h,d.width,d.height),a.uniformMatrix3fv(i,!1,d.matrix),a.enableVertexAttribArray(g),a.enableVertexAttribArray(f),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(f,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.lineWidth(3),a.drawArrays(a.LINES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position;","attribute float a_color;","uniform vec2 u_resolution;","uniform mat3 u_matrix;","varying vec4 color;","void main() {","gl_Position = vec4(","((u_matrix * vec3(a_position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.edges"),sigma.webgl.edges.arrow={POINTS:9,ATTRIBUTES:11,addEdge:function(a,b,c,d,e,f,g){var h=(a[f+"size"]||1)/2,i=b[f+"x"],j=b[f+"y"],k=c[f+"x"],l=c[f+"y"],m=c[f+"size"],n=a.color;if(!n)switch(g("edgeColor")){case"source":n=b.color||g("defaultNodeColor");break;case"target":n=c.color||g("defaultNodeColor");break;default:n=g("defaultEdgeColor")}n=sigma.utils.floatColor(n),d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=m,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=m,d[e++]=0,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=m,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=1,d[e++]=-1,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=1,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=1,d[e++]=1,d[e++]=n},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_pos1"),g=a.getAttribLocation(b,"a_pos2"),h=a.getAttribLocation(b,"a_thickness"),i=a.getAttribLocation(b,"a_tSize"),j=a.getAttribLocation(b,"a_delay"),k=a.getAttribLocation(b,"a_minus"),l=a.getAttribLocation(b,"a_head"),m=a.getAttribLocation(b,"a_headPosition"),n=a.getAttribLocation(b,"a_color"),o=a.getUniformLocation(b,"u_resolution"),p=a.getUniformLocation(b,"u_matrix"),q=a.getUniformLocation(b,"u_matrixHalfPi"),r=a.getUniformLocation(b,"u_matrixHalfPiMinus"),s=a.getUniformLocation(b,"u_ratio"),t=a.getUniformLocation(b,"u_nodeRatio"),u=a.getUniformLocation(b,"u_arrowHead"),v=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW),a.uniform2f(o,d.width,d.height),a.uniform1f(s,d.ratio/Math.pow(d.ratio,d.settings("edgesPowRatio"))),a.uniform1f(t,Math.pow(d.ratio,d.settings("nodesPowRatio"))/d.ratio),a.uniform1f(u,5),a.uniform1f(v,d.scalingRatio),a.uniformMatrix3fv(p,!1,d.matrix),a.uniformMatrix2fv(q,!1,sigma.utils.matrices.rotation(Math.PI/2,!0)),a.uniformMatrix2fv(r,!1,sigma.utils.matrices.rotation(-Math.PI/2,!0)),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.enableVertexAttribArray(i),a.enableVertexAttribArray(j),a.enableVertexAttribArray(k),a.enableVertexAttribArray(l),a.enableVertexAttribArray(m),a.enableVertexAttribArray(n),a.vertexAttribPointer(f,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(h,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16),a.vertexAttribPointer(i,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20),a.vertexAttribPointer(j,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,24),a.vertexAttribPointer(k,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,28),a.vertexAttribPointer(l,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,32),a.vertexAttribPointer(m,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,36),a.vertexAttribPointer(n,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,40),a.drawArrays(a.TRIANGLES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_pos1;","attribute vec2 a_pos2;","attribute float a_thickness;","attribute float a_tSize;","attribute float a_delay;","attribute float a_minus;","attribute float a_head;","attribute float a_headPosition;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_nodeRatio;","uniform float u_arrowHead;","uniform float u_scale;","uniform mat3 u_matrix;","uniform mat2 u_matrixHalfPi;","uniform mat2 u_matrixHalfPiMinus;","varying vec4 color;","void main() {","vec2 pos = normalize(a_pos2 - a_pos1);","mat2 matrix = (1.0 - a_head) *","(","a_minus * u_matrixHalfPiMinus +","(1.0 - a_minus) * u_matrixHalfPi",") + a_head * (","a_headPosition * u_matrixHalfPiMinus * 0.6 +","(a_headPosition * a_headPosition - 1.0) * mat2(1.0)",");","pos = a_pos1 + (","(1.0 - a_head) * a_thickness * u_ratio * matrix * pos +","a_head * u_arrowHead * a_thickness * u_ratio * matrix * pos +","a_delay * pos * (","a_tSize / u_nodeRatio +","u_arrowHead * a_thickness * u_ratio",")",");","gl_Position = vec4(","((u_matrix * vec3(pos, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(a){"use strict";function b(a,b){if(1>=b)return[a];for(var d=a.split(" "),e=[],f=0,g=-1,h=[],i=!0,j=0;j<d.length;++j)if(i){if(d[j].length>b){for(var k=c(d[j],b),l=0;l<k.length;++l)e.push([k[l]]),++g;f=k[k.length-1].length}else e.push([d[j]]),++g,f=d[j].length+1;i=!1}else f+d[j].length<=b?(e[g].push(d[j]),f+=d[j].length+1):(i=!0,--j);for(j=0;j<e.length;++j)h.push(e[j].join(" "));return h}function c(a,b){for(var c=[],d=0;d<a.length;d+=b-1)c.push(a.substr(d,b-1)+"-");var e=c[c.length-1].length;return c[c.length-1]=c[c.length-1].substr(0,e-1)+" ",c}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.labels"),sigma.canvas.labels.def=function(a,c,d,e){var f,g,h,i,j=d("prefix")||"",k=a[j+"size"]||1,l=d("fontStyle"),m=d("nodeBorderSize"),n=d("labelAlignment"),o=d("maxNodeLabelLineLength")||0;if(!(k<=d("labelThreshold"))&&a.label&&"string"==typeof a.label){f="fixed"===d("labelSize")?d("defaultLabelSize"):d("labelSizeRatio")*k;var p=(l?l+" ":"")+f+"px "+(a.active?d("activeFont")||d("font"):d("font"));switch(e&&e.ctx.font!=p?(c.font=p,e.ctx.font=p):c.font=p,c.fillStyle="node"===d("labelColor")?a.color||d("defaultNodeColor"):d("defaultLabelColor"),h=0,i=f/3,c.textAlign="center",n){case"bottom":i=+k+4*f/3;break;case"center":break;case"left":c.textAlign="right",h=-k-m-3;break;case"top":i=-k-2*f/3;break;case"inside":if(g=sigma.utils.canvas.getTextWidth(c,d("approximateLabelWidth"),f,a.label),2*(k+f/3)>=g)break;case"right":default:h=k+m+3,c.textAlign="left"}for(var q=b(a.label,o),r=a[j+"x"]+h,s=Math.round(a[j+"y"]+i),t=0;t<q.length;++t)c.fillText(q[t],r,s+t*(f+1))}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.hovers"),sigma.canvas.hovers.def=function(a,b,c){function d(a,b,d,e,f,g){var h=g>1&&f.length>1?.6*g*d:sigma.utils.canvas.getTextWidth(b,c("approximateLabelWidth"),d,f[0]),i=Math.round(e[m+"x"]),k=Math.round(e[m+"y"]),l=(d+1)*f.length+4,o=Math.round(n+d/4),p=Math.round(h+n+1.5+d/3);if(e.label&&"string"==typeof e.label)switch(a){case"center":break;case"left":i=Math.round(e[m+"x"]+d/2+2),k=Math.round(e[m+"y"]-d/2-2),b.moveTo(i,k+o),b.arcTo(i,k,i-o,k,o),b.lineTo(i-p-j-o,k),b.lineTo(i-p-j-o,k+l),b.lineTo(i-o,k+l),b.arcTo(i,k+l,i,k+l-o,o),b.lineTo(i,k+o);break;case"top":b.rect(i-p/2,k-o-l,p,l);break;case"bottom":b.rect(i-p/2,k+o,p,l);break;case"inside":if(2*o>=h)break;case"right":default:i=Math.round(e[m+"x"]-d/2-2),k=Math.round(e[m+"y"]-d/2-2),b.moveTo(i,k+o),b.arcTo(i,k,i+o,k,o),b.lineTo(i+p+j+o,k),b.lineTo(i+p+j+o,k+l),b.lineTo(i+o,k+l),b.arcTo(i,k+l,i,k+l-o,o),b.lineTo(i,k+o)}b.closePath(),b.fill(),b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=0}function e(a,b){if(1>=b)return[a];for(var c=a.split(" "),d=[],e=0,g=-1,h=[],i=!0,j=0;j<c.length;++j)if(i){if(c[j].length>b){for(var k=f(c[j],b),l=0;l<k.length;++l)d.push([k[l]]),++g;e=k[k.length-1].length}else d.push([c[j]]),++g,e=c[j].length+1;i=!1}else e+c[j].length<=b?(d[g].push(c[j]),e+=c[j].length+1):(i=!0,--j);for(j=0;j<d.length;++j)h.push(d[j].join(" "));return h}function f(a,b){for(var c=[],d=0;d<a.length;d+=b-1)c.push(a.substr(d,b-1)+"-");var e=c[c.length-1].length;return c[c.length-1]=c[c.length-1].substr(0,e-1)+" ",c}var g,h,i,j=c("nodeBorderSize"),k=c("labelAlignment"),l=c("hoverFontStyle")||c("fontStyle"),m=c("prefix")||"",n=a[m+"size"],o=c("maxNodeLabelLineLength")||0,p="fixed"===c("labelSize")?c("defaultLabelSize"):c("labelSizeRatio")*n;b.font=(l?l+" ":"")+p+"px "+(c("hoverFont")||c("font")),b.beginPath(),b.fillStyle="node"===c("labelHoverBGColor")?a.color||c("defaultNodeColor"):c("defaultHoverLabelBGColor"),c("labelHoverShadow")&&(b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=8,b.shadowColor=c("labelHoverShadowColor")),
g=e(a.label,o),d(k,b,p,a,g,o),j>0&&(b.beginPath(),b.fillStyle="node"===c("nodeBorderColor")?a.color||c("defaultNodeColor"):c("defaultNodeBorderColor"),b.arc(a[m+"x"],a[m+"y"],n+j,0,2*Math.PI,!0),b.closePath(),b.fill());var q=sigma.canvas.nodes[a.type]||sigma.canvas.nodes.def;if(q(a,b,c),a.label&&"string"==typeof a.label){b.fillStyle="node"===c("labelHoverColor")?a.color||c("defaultNodeColor"):c("defaultLabelHoverColor");var r=sigma.utils.canvas.getTextWidth(b,c("approximateLabelWidth"),p,a.label),s=-r/2,t=p/3;switch(k){case"bottom":t=+n+4*p/3;break;case"center":break;case"left":s=-n-j-3-r;break;case"top":t=-n-2*p/3;break;case"inside":if(2*(n+p/3)>=r)break;case"right":default:s=n+j+3}h=a[m+"x"]+s,i=Math.round(a[m+"y"]+t);for(var u=0;u<g.length;++u)b.fillText(g[u],h,i+u*(p+1))}}}.call(this),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes"),sigma.canvas.nodes.def=function(a,b,c){var d=c("prefix")||"";b.fillStyle=a.color||c("defaultNodeColor"),b.beginPath(),b.arc(a[d+"x"],a[d+"y"],a[d+"size"],0,2*Math.PI,!0),b.closePath(),b.fill()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.def=function(a,b,c,d,e){var f=a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor");if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.curve=function(a,b,c,d,e){var f=a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l={},m=b[g+"size"],n=b[g+"x"],o=b[g+"y"],p=c[g+"x"],q=c[g+"y"];if(l=b.id===c.id?sigma.utils.getSelfLoopControlPoints(n,o,m):sigma.utils.getQuadraticControlPoint(n,o,p,q,a.cc),!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(n,o),b.id===c.id?d.bezierCurveTo(l.x1,l.y1,l.x2,l.y2,p,q):d.quadraticCurveTo(l.x,l.y,p,q),d.stroke()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.arrow=function(a,b,c,d,e){var f=a.color,g=e("prefix")||"",h=e("edgeColor"),i=e("defaultNodeColor"),j=e("defaultEdgeColor"),k=a[g+"size"]||1,l=c[g+"size"],m=b[g+"x"],n=b[g+"y"],o=c[g+"x"],p=c[g+"y"],q=Math.max(2.5*k,e("minArrowSize")),r=Math.sqrt((o-m)*(o-m)+(p-n)*(p-n)),s=m+(o-m)*(r-q-l)/r,t=n+(p-n)*(r-q-l)/r,u=(o-m)*q/r,v=(p-n)*q/r;if(!f)switch(h){case"source":f=b.color||i;break;case"target":f=c.color||i;break;default:f=j}d.strokeStyle=f,d.lineWidth=k,d.beginPath(),d.moveTo(m,n),d.lineTo(s,t),d.stroke(),d.fillStyle=f,d.beginPath(),d.moveTo(s+u,t+v),d.lineTo(s+.6*v,t-.6*u),d.lineTo(s-.6*v,t+.6*u),d.lineTo(s+u,t+v),d.closePath(),d.fill()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.curvedArrow=function(a,b,c,d,e){var f,g,h,i,j,k=a.color,l=e("prefix")||"",m=e("edgeColor"),n=e("defaultNodeColor"),o=e("defaultEdgeColor"),p={},q=a[l+"size"]||1,r=c[l+"size"],s=b[l+"x"],t=b[l+"y"],u=c[l+"x"],v=c[l+"y"],w=Math.max(2.5*q,e("minArrowSize"));if(p=b.id===c.id?sigma.utils.getSelfLoopControlPoints(s,t,r):sigma.utils.getQuadraticControlPoint(s,t,u,v,a.cc),b.id===c.id?(f=Math.sqrt((u-p.x1)*(u-p.x1)+(v-p.y1)*(v-p.y1)),g=p.x1+(u-p.x1)*(f-w-r)/f,h=p.y1+(v-p.y1)*(f-w-r)/f,i=(u-p.x1)*w/f,j=(v-p.y1)*w/f):(f=Math.sqrt((u-p.x)*(u-p.x)+(v-p.y)*(v-p.y)),g=p.x+(u-p.x)*(f-w-r)/f,h=p.y+(v-p.y)*(f-w-r)/f,i=(u-p.x)*w/f,j=(v-p.y)*w/f),!k)switch(m){case"source":k=b.color||n;break;case"target":k=c.color||n;break;default:k=o}d.strokeStyle=k,d.lineWidth=q,d.beginPath(),d.moveTo(s,t),b.id===c.id?d.bezierCurveTo(p.x2,p.y2,p.x1,p.y1,g,h):d.quadraticCurveTo(p.x,p.y,g,h),d.stroke(),d.fillStyle=k,d.beginPath(),d.moveTo(g+i,h+j),d.lineTo(g+.6*j,h-.6*i),d.lineTo(g-.6*j,h+.6*i),d.lineTo(g+i,h+j),d.closePath(),d.fill()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.def=function(a,b,c,d,e){var f=a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor");if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,h*=e("edgeHoverSizeRatio"),d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.curve=function(a,b,c,d,e){var f=a.color,g=e("prefix")||"",h=e("edgeHoverSizeRatio")*(a[g+"size"]||1),i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l={},m=b[g+"size"],n=b[g+"x"],o=b[g+"y"],p=c[g+"x"],q=c[g+"y"];if(l=b.id===c.id?sigma.utils.getSelfLoopControlPoints(n,o,m):sigma.utils.getQuadraticControlPoint(n,o,p,q,a.cc),!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(n,o),b.id===c.id?d.bezierCurveTo(l.x1,l.y1,l.x2,l.y2,p,q):d.quadraticCurveTo(l.x,l.y,p,q),d.stroke()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.arrow=function(a,b,c,d,e){var f=a.color,g=e("prefix")||"",h=e("edgeColor"),i=e("defaultNodeColor"),j=e("defaultEdgeColor"),k=a[g+"size"]||1,l=c[g+"size"],m=b[g+"x"],n=b[g+"y"],o=c[g+"x"],p=c[g+"y"];k=a.hover?e("edgeHoverSizeRatio")*k:k;var q=Math.max(2.5*k,e("minArrowSize")),r=Math.sqrt((o-m)*(o-m)+(p-n)*(p-n)),s=m+(o-m)*(r-q-l)/r,t=n+(p-n)*(r-q-l)/r,u=(o-m)*q/r,v=(p-n)*q/r;if(!f)switch(h){case"source":f=b.color||i;break;case"target":f=c.color||i;break;default:f=j}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,d.strokeStyle=f,d.lineWidth=k,d.beginPath(),d.moveTo(m,n),d.lineTo(s,t),d.stroke(),d.fillStyle=f,d.beginPath(),d.moveTo(s+u,t+v),d.lineTo(s+.6*v,t-.6*u),d.lineTo(s-.6*v,t+.6*u),d.lineTo(s+u,t+v),d.closePath(),d.fill()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.curvedArrow=function(a,b,c,d,e){var f,g,h,i,j,k,l=a.color,m=e("prefix")||"",n=e("edgeColor"),o=e("defaultNodeColor"),p=e("defaultEdgeColor"),q={},r=e("edgeHoverSizeRatio")*(a[m+"size"]||1),s=c[m+"size"],t=b[m+"x"],u=b[m+"y"],v=c[m+"x"],w=c[m+"y"];if(q=b.id===c.id?sigma.utils.getSelfLoopControlPoints(t,u,s):sigma.utils.getQuadraticControlPoint(t,u,v,w,a.cc),b.id===c.id?(f=Math.sqrt((v-q.x1)*(v-q.x1)+(w-q.y1)*(w-q.y1)),g=Math.max(2.5*r,e("minArrowSize")),h=q.x1+(v-q.x1)*(f-g-s)/f,i=q.y1+(w-q.y1)*(f-g-s)/f,j=(v-q.x1)*g/f,k=(w-q.y1)*g/f):(f=Math.sqrt((v-q.x)*(v-q.x)+(w-q.y)*(w-q.y)),g=2.5*r,h=q.x+(v-q.x)*(f-g-s)/f,i=q.y+(w-q.y)*(f-g-s)/f,j=(v-q.x)*g/f,k=(w-q.y)*g/f),!l)switch(n){case"source":l=b.color||o;break;case"target":l=c.color||o;break;default:l=p}l="edge"===e("edgeHoverColor")?a.hover_color||l:a.hover_color||e("defaultEdgeHoverColor")||l,d.strokeStyle=l,d.lineWidth=r,d.beginPath(),d.moveTo(t,u),b.id===c.id?d.bezierCurveTo(q.x2,q.y2,q.x1,q.y1,h,i):d.quadraticCurveTo(q.x,q.y,h,i),d.stroke(),d.fillStyle=l,d.beginPath(),d.moveTo(h+j,i+k),d.lineTo(h+.6*k,i-.6*j),d.lineTo(h-.6*k,i+.6*j),d.lineTo(h+j,i+k),d.closePath(),d.fill()}}(),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.extremities"),sigma.canvas.extremities.def=function(a,b,c,d,e){(sigma.canvas.hovers[b.type]||sigma.canvas.hovers.def)(b,d,e),(sigma.canvas.hovers[c.type]||sigma.canvas.hovers.def)(c,d,e)}}.call(this),function(){"use strict";sigma.utils.pkg("sigma.svg.utils"),sigma.svg.utils={show:function(a){return a.style.display="",this},hide:function(a){return a.style.display="none",this}}}(),function(){"use strict";sigma.utils.pkg("sigma.svg.nodes"),sigma.svg.nodes.def={create:function(a,b){var c=(b("prefix")||"",document.createElementNS(b("xmlns"),"circle"));return c.setAttributeNS(null,"data-node-id",a.id),c.setAttributeNS(null,"class",b("classPrefix")+"-node"),c.setAttributeNS(null,"fill",a.color||b("defaultNodeColor")),c},update:function(a,b,c){var d=c("prefix")||"";return b.setAttributeNS(null,"cx",a[d+"x"]),b.setAttributeNS(null,"cy",a[d+"y"]),b.setAttributeNS(null,"r",a[d+"size"]),c("freeStyle")||b.setAttributeNS(null,"fill",a.color||c("defaultNodeColor")),b.style.display="",this}}}(),function(){"use strict";sigma.utils.pkg("sigma.svg.edges"),sigma.svg.edges.def={create:function(a,b,c,d){var e=a.color,f=(d("prefix")||"",d("edgeColor")),g=d("defaultNodeColor"),h=d("defaultEdgeColor");if(!e)switch(f){case"source":e=b.color||g;break;case"target":e=c.color||g;break;default:e=h}var i=document.createElementNS(d("xmlns"),"line");return i.setAttributeNS(null,"data-edge-id",a.id),i.setAttributeNS(null,"class",d("classPrefix")+"-edge"),i.setAttributeNS(null,"stroke",e),i},update:function(a,b,c,d,e){var f=e("prefix")||"";return b.setAttributeNS(null,"stroke-width",a[f+"size"]||1),b.setAttributeNS(null,"x1",c[f+"x"]),b.setAttributeNS(null,"y1",c[f+"y"]),b.setAttributeNS(null,"x2",d[f+"x"]),b.setAttributeNS(null,"y2",d[f+"y"]),b.style.display="",this}}}(),function(){"use strict";sigma.utils.pkg("sigma.svg.edges"),sigma.svg.edges.curve={create:function(a,b,c,d){var e=a.color,f=(d("prefix")||"",d("edgeColor")),g=d("defaultNodeColor"),h=d("defaultEdgeColor");if(!e)switch(f){case"source":e=b.color||g;break;case"target":e=c.color||g;break;default:e=h}var i=document.createElementNS(d("xmlns"),"path");return i.setAttributeNS(null,"data-edge-id",a.id),i.setAttributeNS(null,"class",d("classPrefix")+"-edge"),i.setAttributeNS(null,"stroke",e),i},update:function(a,b,c,d,e){var f,g,h=e("prefix")||"",i=c[h+"size"],j=c[h+"x"],k=c[h+"y"],l=d[h+"x"],m=d[h+"y"];return b.setAttributeNS(null,"stroke-width",a[h+"size"]||1),c.id===d.id?(f=sigma.utils.getSelfLoopControlPoints(j,k,i),g="M"+j+","+k+" C"+f.x1+","+f.y1+" "+f.x2+","+f.y2+" "+l+","+m):(f=sigma.utils.getQuadraticControlPoint(j,k,l,m,a.cc),g="M"+j+","+k+" Q"+f.x+","+f.y+" "+l+","+m),b.setAttributeNS(null,"d",g),b.setAttributeNS(null,"fill","none"),b.style.display="",this}}}(),function(){"use strict";sigma.utils.pkg("sigma.svg.edges"),sigma.svg.edges.curvedArrow={create:function(a,b,c,d){var e=a.color,f=(d("prefix")||"",d("edgeColor")),g=d("defaultNodeColor"),h=d("defaultEdgeColor");if(!e)switch(f){case"source":e=b.color||g;break;case"target":e=c.color||g;break;default:e=h}var i=document.createElementNS(d("xmlns"),"path");return i.setAttributeNS(null,"data-edge-id",a.id),i.setAttributeNS(null,"class",d("classPrefix")+"-edge"),i.setAttributeNS(null,"stroke",e),i},update:function(a,b,c,d,e){var f,g,h=e("prefix")||"",i=c[h+"size"],j=c[h+"x"],k=c[h+"y"],l=d[h+"x"],m=d[h+"y"];return b.setAttributeNS(null,"stroke-width",a[h+"size"]||1),c.id===d.id?(f=sigma.utils.getSelfLoopControlPoints(j,k,i),g="M"+j+","+k+" C"+f.x1+","+f.y1+" "+f.x2+","+f.y2+" "+l+","+m):(f=sigma.utils.getQuadraticControlPoint(j,k,l,m,a.cc),g="M"+j+","+k+" Q"+f.x+","+f.y+" "+l+","+m),b.setAttributeNS(null,"d",g),b.setAttributeNS(null,"fill","none"),b.style.display="",this}}}(),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.svg.labels"),sigma.svg.labels.def={create:function(a,b){var c=b("prefix")||"",d=a[c+"size"],e=document.createElementNS(b("xmlns"),"text"),f="fixed"===b("labelSize")?b("defaultLabelSize"):b("labelSizeRatio")*d,g="node"===b("labelColor")?a.color||b("defaultNodeColor"):b("defaultLabelColor");return e.setAttributeNS(null,"data-label-target",a.id),e.setAttributeNS(null,"class",b("classPrefix")+"-label"),e.setAttributeNS(null,"font-size",f),e.setAttributeNS(null,"font-family",b("font")),e.setAttributeNS(null,"fill",g),e.innerHTML=a.label,e.textContent=a.label,e},update:function(a,b,c){var d=c("prefix")||"",e=a[d+"size"],f="fixed"===c("labelSize")?c("defaultLabelSize"):c("labelSizeRatio")*e;return!c("forceLabels")&&e<c("labelThreshold")||"string"!=typeof a.label?void 0:(b.setAttributeNS(null,"x",Math.round(a[d+"x"]+e+3)),b.setAttributeNS(null,"y",Math.round(a[d+"y"]+f/3)),b.style.display="",this)}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.svg.hovers"),sigma.svg.hovers.def={create:function(a,b,c,d){var e,f,g,h,i,j=(d("hoverFontStyle")||d("fontStyle"),d("prefix")||""),k=a[j+"size"],l="fixed"===d("labelSize")?d("defaultLabelSize"):d("labelSizeRatio")*k,m="node"===d("labelHoverColor")?a.color||d("defaultNodeColor"):d("defaultLabelHoverColor"),n=document.createElementNS(d("xmlns"),"g"),o=document.createElementNS(d("xmlns"),"rect"),p=document.createElementNS(d("xmlns"),"circle"),q=document.createElementNS(d("xmlns"),"text");return n.setAttributeNS(null,"class",d("classPrefix")+"-hover"),n.setAttributeNS(null,"data-node-id",a.id),"string"==typeof a.label&&(q.innerHTML=a.label,q.textContent=a.label,q.setAttributeNS(null,"class",d("classPrefix")+"-hover-label"),q.setAttributeNS(null,"font-size",l),q.setAttributeNS(null,"font-family",d("font")),q.setAttributeNS(null,"fill",m),q.setAttributeNS(null,"x",Math.round(a[j+"x"]+k+3)),q.setAttributeNS(null,"y",Math.round(a[j+"y"]+l/3)),e=Math.round(a[j+"x"]-l/2-2),f=Math.round(a[j+"y"]-l/2-2),g=Math.round(c.measureText(a.label).width+l/2+k+9),h=Math.round(l+4),i=Math.round(l/2+2),p.setAttributeNS(null,"class",d("classPrefix")+"-hover-area"),p.setAttributeNS(null,"fill","#fff"),p.setAttributeNS(null,"cx",a[j+"x"]),p.setAttributeNS(null,"cy",a[j+"y"]),p.setAttributeNS(null,"r",i),o.setAttributeNS(null,"class",d("classPrefix")+"-hover-area"),o.setAttributeNS(null,"fill","#fff"),o.setAttributeNS(null,"x",a[j+"x"]+i/4),o.setAttributeNS(null,"y",a[j+"y"]-i),o.setAttributeNS(null,"width",g),o.setAttributeNS(null,"height",h)),n.appendChild(p),n.appendChild(o),n.appendChild(q),n.appendChild(b),n}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.middlewares"),sigma.utils.pkg("sigma.utils"),sigma.middlewares.rescale=function(a,b,c){var d,e,f,g,h,i,j,k,l=this.graph.nodes(),m=this.graph.edges(),n=this.settings.embedObjects(c||{}),o=n("bounds")||sigma.utils.getBoundaries(this.graph,a,!0),p=o.minX,q=o.minY,r=o.maxX,s=o.maxY,t=o.sizeMax,u=o.weightMax,v=n("width")||1,w=n("height")||1,x=n("autoRescale"),y={nodePosition:1,nodeSize:1,edgeSize:1};for(x instanceof Array||(x=["nodePosition","nodeSize","edgeSize"]),d=0,e=x.length;e>d;d++)if(!y[x[d]])throw new Error('The rescale setting "'+x[d]+'" is not recognized.');var z=~x.indexOf("nodePosition"),A=~x.indexOf("nodeSize"),B=~x.indexOf("edgeSize");for(z&&(j="outside"===n("scalingMode")?Math.max(v/Math.max(r-p,1),w/Math.max(s-q,1)):Math.min(v/Math.max(r-p,1),w/Math.max(s-q,1)),k=(n("rescaleIgnoreSize")?0:(n("maxNodeSize")||t)/j)+(n("sideMargin")||0),r+=k,p-=k,s+=k,q-=k,j="outside"===n("scalingMode")?Math.max(v/Math.max(r-p,1),w/Math.max(s-q,1)):Math.min(v/Math.max(r-p,1),w/Math.max(s-q,1))),n("maxNodeSize")||n("minNodeSize")?n("maxNodeSize")===n("minNodeSize")?(f=0,g=+n("maxNodeSize")):(f=(n("maxNodeSize")-n("minNodeSize"))/t,g=+n("minNodeSize")):(f=1,g=0),n("maxEdgeSize")||n("minEdgeSize")?n("maxEdgeSize")===n("minEdgeSize")?(h=0,i=+n("minEdgeSize")):(h=(n("maxEdgeSize")-n("minEdgeSize"))/u,i=+n("minEdgeSize")):(h=1,i=0),d=0,e=m.length;e>d;d++)m[d][b+"size"]=m[d][a+"size"]*(B?h:1)+(B?i:0);for(d=0,e=l.length;e>d;d++)l[d][b+"size"]=l[d][a+"size"]*(A?f:1)+(A?g:0),z?(l[d][b+"x"]=(l[d][a+"x"]-(r+p)/2)*j,l[d][b+"y"]=(l[d][a+"y"]-(s+q)/2)*j):(l[d][b+"x"]=l[d][a+"x"],l[d][b+"y"]=l[d][a+"y"])},sigma.utils.getBoundaries=function(a,b,c){var d,e,f=a.edges(),g=a.nodes(),h=-(1/0),i=-(1/0),j=1/0,k=1/0,l=-(1/0),m=-(1/0);if(c)for(d=0,e=f.length;e>d;d++)h=Math.max(f[d][b+"size"],h);for(d=0,e=g.length;e>d;d++)i=Math.max(g[d][b+"size"],i),l=Math.max(g[d][b+"x"],l),j=Math.min(g[d][b+"x"],j),m=Math.max(g[d][b+"y"],m),k=Math.min(g[d][b+"y"],k);return h=h||1,i=i||1,{weightMax:h,sizeMax:i,minX:j,minY:k,maxX:l,maxY:m}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.middlewares"),sigma.middlewares.copy=function(a,b){var c,d,e;if(b+""!=a+""){for(e=this.graph.nodes(),c=0,d=e.length;d>c;c++)e[c][b+"x"]=e[c][a+"x"],e[c][b+"y"]=e[c][a+"y"],e[c][b+"size"]=e[c][a+"size"];for(e=this.graph.edges(),c=0,d=e.length;d>c;c++)e[c][b+"size"]=e[c][a+"size"]}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.misc.animation.running");var b=function(){var a=0;return function(){return""+ ++a}}();sigma.misc.animation.camera=function(c,d,e){if(!(c instanceof sigma.classes.camera&&"object"==typeof d&&d))throw"animation.camera: Wrong arguments.";if("number"!=typeof d.x&&"number"!=typeof d.y&&"number"!=typeof d.ratio&&"number"!=typeof d.angle)throw"There must be at least one valid coordinate in the given val.";var f,g,h,i,j,k,l=e||{},m=sigma.utils.dateNow();return k={x:c.x,y:c.y,ratio:c.ratio,angle:c.angle},j=l.duration,i="function"!=typeof l.easing?sigma.utils.easings[l.easing||"quadraticInOut"]:l.easing,f=function(){var b,e=l.duration?(sigma.utils.dateNow()-m)/l.duration:1;e>=1?(c.isAnimated=!1,c.goTo({x:d.x!==a?d.x:k.x,y:d.y!==a?d.y:k.y,ratio:d.ratio!==a?d.ratio:k.ratio,angle:d.angle!==a?d.angle:k.angle}),cancelAnimationFrame(g),delete sigma.misc.animation.running[g],"function"==typeof l.onComplete&&l.onComplete()):(b=i(e),c.isAnimated=!0,c.goTo({x:d.x!==a?k.x+(d.x-k.x)*b:k.x,y:d.y!==a?k.y+(d.y-k.y)*b:k.y,ratio:d.ratio!==a?k.ratio+(d.ratio-k.ratio)*b:k.ratio,angle:d.angle!==a?k.angle+(d.angle-k.angle)*b:k.angle}),"function"==typeof l.onNewFrame&&l.onNewFrame(),h.frameId=requestAnimationFrame(f))},g=b(),h={frameId:requestAnimationFrame(f),target:c,type:"camera",options:l,fn:f},sigma.misc.animation.running[g]=h,g},sigma.misc.animation.kill=function(a){if(1!==arguments.length||"number"!=typeof a)throw"animation.kill: Wrong arguments.";var b=sigma.misc.animation.running[a];return b&&(cancelAnimationFrame(a),delete sigma.misc.animation.running[b.frameId],"camera"===b.type&&(b.target.isAnimated=!1),"function"==typeof(b.options||{}).onComplete&&b.options.onComplete()),this},sigma.misc.animation.killAll=function(a){var b,c,d=0,e="string"==typeof a?a:null,f="object"==typeof a?a:null,g=sigma.misc.animation.running;for(c in g)e&&g[c].type!==e||f&&g[c].target!==f||(b=sigma.misc.animation.running[c],cancelAnimationFrame(b.frameId),delete sigma.misc.animation.running[c],"camera"===b.type&&(b.target.isAnimated=!1),d++,"function"==typeof(b.options||{}).onComplete&&b.options.onComplete());return d},sigma.misc.animation.has=function(a){var b,c="string"==typeof a?a:null,d="object"==typeof a?a:null,e=sigma.misc.animation.running;for(b in e)if(!(c&&e[b].type!==c||d&&e[b].target!==d))return!0;return!1}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.misc"),sigma.misc.bindEvents=function(b){function c(a){a&&(h="x"in a.data?a.data.x:h,i="y"in a.data?a.data.y:i);var c,d,e,f,g,k,l,m,n=[],o=h+j.width/2,p=i+j.height/2,q=j.camera.cameraPosition(h,i),r=j.camera.quadtree.point(q.x,q.y);if(r.length)for(c=0,e=r.length;e>c;c++)if(f=r[c],g=f[b+"x"],k=f[b+"y"],l=f[b+"size"],!f.hidden&&o>g-l&&g+l>o&&p>k-l&&k+l>p&&Math.sqrt((o-g)*(o-g)+(p-k)*(p-k))<l){for(m=!1,d=0;d<n.length;d++)if(f.size>n[d].size){n.splice(d,0,f),m=!0;break}m||n.push(f)}return n}function d(c){function d(a,b){for(r=!1,g=0;g<a.length;g++)if(b.size>a[g].size){a.splice(g,0,b),r=!0;break}r||a.push(b)}if(!j.settings("enableEdgeHovering"))return[];var e=sigma.renderers.canvas&&j instanceof sigma.renderers.canvas;if(!e)throw new Error("The edge events feature is not compatible with the WebGL renderer");c&&(h="x"in c.data?c.data.x:h,i="y"in c.data?c.data.y:i);var f,g,k,l,m,n,o,p,q,r,s=j.settings("edgeHoverPrecision"),t={},u=[],v=h+j.width/2,w=i+j.height/2,x=j.camera.cameraPosition(h,i),y=[];if(e){var z=j.camera.quadtree.area(j.camera.getRectangle(j.width,j.height));for(l=z,f=0,k=l.length;k>f;f++)t[l[f].id]=l[f]}if(j.camera.edgequadtree!==a&&(y=j.camera.edgequadtree.point(x.x,x.y)),y.length)for(f=0,k=y.length;k>f;f++)m=y[f],o=j.graph.nodes(m.source),p=j.graph.nodes(m.target),n=m[b+"size"]||m["read_"+b+"size"],!m.hidden&&!o.hidden&&!p.hidden&&(!e||t[m.source]||t[m.target])&&sigma.utils.getDistance(o[b+"x"],o[b+"y"],v,w)>o[b+"size"]&&sigma.utils.getDistance(p[b+"x"],p[b+"y"],v,w)>p[b+"size"]&&("curve"==m.type||"curvedArrow"==m.type?o.id===p.id?(q=sigma.utils.getSelfLoopControlPoints(o[b+"x"],o[b+"y"],o[b+"size"]),sigma.utils.isPointOnBezierCurve(v,w,o[b+"x"],o[b+"y"],p[b+"x"],p[b+"y"],q.x1,q.y1,q.x2,q.y2,Math.max(n,s))&&d(u,m)):(q=sigma.utils.getQuadraticControlPoint(o[b+"x"],o[b+"y"],p[b+"x"],p[b+"y"],m.cc),sigma.utils.isPointOnQuadraticCurve(v,w,o[b+"x"],o[b+"y"],p[b+"x"],p[b+"y"],q.x,q.y,Math.max(n,s))&&d(u,m)):sigma.utils.isPointOnSegment(v,w,o[b+"x"],o[b+"y"],p[b+"x"],p[b+"y"],Math.max(n,s))&&d(u,m));return u}function e(a){function b(a){j.settings("eventsEnabled")&&(j.dispatchEvent("click",a.data),i=c(a),k=d(a),i.length?(j.dispatchEvent("clickNode",{node:i[0],captor:a.data}),j.dispatchEvent("clickNodes",{node:i,captor:a.data})):k.length?(j.dispatchEvent("clickEdge",{edge:k[0],captor:a.data}),j.dispatchEvent("clickEdges",{edge:k,captor:a.data})):j.dispatchEvent("clickStage",{captor:a.data}))}function e(a){j.settings("eventsEnabled")&&(j.dispatchEvent("doubleClick",a.data),i=c(a),k=d(a),i.length?(j.dispatchEvent("doubleClickNode",{node:i[0],captor:a.data}),j.dispatchEvent("doubleClickNodes",{node:i,captor:a.data})):k.length?(j.dispatchEvent("doubleClickEdge",{edge:k[0],captor:a.data}),j.dispatchEvent("doubleClickEdges",{edge:k,captor:a.data})):j.dispatchEvent("doubleClickStage",{captor:a.data}))}function f(a){j.settings("eventsEnabled")&&(j.dispatchEvent("rightClick",a.data),i=c(a),k=d(a),i.length?(j.dispatchEvent("rightClickNode",{node:i[0],captor:a.data}),j.dispatchEvent("rightClickNodes",{node:i,captor:a.data})):k.length?(j.dispatchEvent("rightClickEdge",{edge:k[0],captor:a.data}),j.dispatchEvent("rightClickEdges",{edge:k,captor:a.data})):j.dispatchEvent("rightClickStage",{captor:a.data}))}function g(a){if(j.settings("eventsEnabled")){var b,c={current:{nodes:[],edges:[]},enter:{nodes:[],edges:[]},leave:{nodes:[],edges:[]},captor:a.data},d=c.leave;for(b in l)d.nodes.push(l[b]);for(b in m)d.edges.push(m[b]);l={},m={},(d.nodes.length||d.edges.length)&&j.dispatchEvent("hovers",c)}}function h(a){if(j.settings("eventsEnabled")){i=c(a),k=d(a);var b,e,f,g,h=[],n=[],o={},p=[],q=[],r={};for(b=0;b<i.length;b++)f=i[b],o[f.id]=f,l[f.id]||(n.push(f),l[f.id]=f);for(e in l)o[e]||(h.push(l[e]),delete l[e]);for(b=0;b<k.length;b++)g=k[b],r[g.id]=g,m[g.id]||(q.push(g),m[g.id]=g);for(e in m)r[e]||(p.push(m[e]),delete m[e]);(p.length||q.length||h.length||n.length)&&j.dispatchEvent("hovers",{current:{nodes:i,edges:k},enter:{nodes:n,edges:q},leave:{nodes:h,edges:p},captor:a.data})}}var i,k,l={},m={};a.bind("click",b),a.bind("mousedown",h),a.bind("mouseup",h),a.bind("mousemove",h),a.bind("mouseout",g),a.bind("doubleclick",e),a.bind("rightclick",f)}var f,g,h,i,j=this;for(f=0,g=this.captors.length;g>f;f++)e(this.captors[f])}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.misc"),sigma.misc.bindDOMEvents=function(a){function b(a){this.attr=function(b){return a.getAttributeNS(null,b)},this.tag=a.tagName,this["class"]=this.attr("class"),this.id=this.attr("id"),this.isNode=function(){return!!~this["class"].indexOf(g.settings("classPrefix")+"-node")},this.isEdge=function(){return!!~this["class"].indexOf(g.settings("classPrefix")+"-edge")},this.isHover=function(){return!!~this["class"].indexOf(g.settings("classPrefix")+"-hover")}}function c(a){if(g.settings("eventsEnabled")){g.dispatchEvent("click",sigma.utils.mouseCoords(a));var c=new b(a.target);c.isNode()?g.dispatchEvent("clickNode",{node:h.nodes(c.attr("data-node-id"))}):g.dispatchEvent("clickStage"),a.preventDefault(),a.stopPropagation()}}function d(a){if(g.settings("eventsEnabled")){g.dispatchEvent("doubleClick",sigma.utils.mouseCoords(a));var c=new b(a.target);c.isNode()?g.dispatchEvent("doubleClickNode",{node:h.nodes(c.attr("data-node-id"))}):g.dispatchEvent("doubleClickStage"),a.preventDefault(),a.stopPropagation()}}function e(a){var c=a.toElement||a.target;if(g.settings("eventsEnabled")&&c){var d,e=new b(c),f={leave:{nodes:[],edges:[]},enter:{nodes:[],edges:[]},captor:sigma.utils.mouseCoords(a)};e.isNode()?(d=h.nodes(e.attr("data-node-id")),f.enter.nodes=[d],i.nodes.push(d)):e.isEdge()&&(d=h.edges(e.attr("data-edge-id")),f.enter.edges=[d],i.edges.push(d)),f.current=i,g.dispatchEvent("hovers",f)}}function f(a){var c=a.fromElement||a.originalTarget;if(g.settings("eventsEnabled")){var d,e=new b(c),f={leave:{nodes:[],edges:[]},enter:{nodes:[],edges:[]},captor:sigma.utils.mouseCoords(a)};if(e.isNode())d=h.nodes(e.attr("data-node-id")),f.leave.nodes=[d],i.nodes.push(d);else{if(!e.isEdge())return;d=h.edges(e.attr("data-edge-id")),f.leave.edges=[d],i.edges.push(d)}f.current=i,g.dispatchEvent("hovers",f)}}var g=this,h=this.graph,i={nodes:[],edges:[]};a.addEventListener("click",c,!1),sigma.utils.doubleClick(a,"click",d),a.addEventListener("touchstart",c,!1),sigma.utils.doubleClick(a,"touchstart",d),a.addEventListener("mouseover",e,!0),a.addEventListener("mouseout",f,!0)}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.misc"),sigma.misc.drawHovers=function(b){function c(){var c=d.contexts.hover.canvas,f=d.settings.embedObjects({prefix:b}),g=f("singleHover")?1:a,h={elements:e.nodes,renderers:sigma.canvas.hovers,type:"nodes",ctx:d.contexts.hover,end:g,graph:d.graph,settings:f};d.contexts.hover.clearRect(0,0,c.width,c.height),e.nodes.length>0&&f("enableHovering")&&sigma.renderers.canvas.applyRenderers(h),e.edges.length>0&&f("enableEdgeHovering")&&(h.renderers=sigma.canvas.edgehovers,h.elements=e.edges,h.type="edges",sigma.renderers.canvas.applyRenderers(h),f("edgeHoverExtremities")?(h.renderers=sigma.canvas.extremities,sigma.renderers.canvas.applyRenderers(h)):(h.ctx=d.contexts.nodes,h.type="nodes",h.renderers=sigma.canvas.nodes,h.elements=e.nodes,sigma.renderers.canvas.applyRenderers(h)))}var d=this,e={nodes:[],edges:[]};this.bind("hovers",function(a){e=a.data.current,c()}),this.bind("render",function(a){c()})}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw new Error("sigma is not declared");var b=new sigma.utils.map;sigma.classes.graph.attach("addNode","sigma.helpers.graph.addNode",function(a){a.fixed&&b.set(a.id,this.nodesIndex.get(a.id))}),sigma.classes.graph.attachBefore("dropNode","sigma.helpers.graph.dropNode",function(a){b["delete"](a)}),sigma.classes.graph.attachBefore("clear","sigma.helpers.graph.clear",function(){b.clear(),b=new sigma.utils.map}),sigma.classes.graph.hasMethod("fixNode")||sigma.classes.graph.addMethod("fixNode",function(a){return this.nodesIndex.get(a)&&(this.nodesIndex.get(a).fixed=!0,b.set(a,this.nodesIndex.get(a))),this}),sigma.classes.graph.hasMethod("unfixNode")||sigma.classes.graph.addMethod("unfixNode",function(c){return this.nodesIndex.get(c)&&(this.nodesIndex.get(c).fixed=a,b["delete"](c)),this}),sigma.classes.graph.hasMethod("getFixedNodes")||sigma.classes.graph.addMethod("getFixedNodes",function(){var a=[];return b.forEach(function(b,c){a.push(b)}),a}),sigma.classes.graph.hasMethod("hasFixedNodes")||sigma.classes.graph.addMethod("hasFixedNodes",function(){return 0!=b.size}),sigma.classes.graph.hasMethod("dropNodes")||sigma.classes.graph.addMethod("dropNodes",function(a){if(arguments.length>1)throw new Error("Too many arguments. Use an array instead.");if("string"==typeof a||"number"==typeof a)this.dropNode(a);else{if(!Array.isArray(a))throw new TypeError('Invalid argument: "v" is not a string, a number, or an array, was '+a);var b,c;for(b=0,c=a.length;c>b;b++){if("string"!=typeof a[b]&&"number"!=typeof a[b])throw new TypeError("Invalid argument: a node id is not a string or a number, was "+a[b]);this.dropNode(a[b])}}return this}),sigma.classes.graph.hasMethod("dropEdges")||sigma.classes.graph.addMethod("dropEdges",function(a){if(arguments.length>1)throw new Error("Too many arguments. Use an array instead.");if("string"==typeof a||"number"==typeof a)this.dropEdge(a);else{if(!Array.isArray(a))throw new TypeError("Invalid argument: it is not a string, a number, or an array, was "+a);var b,c;for(b=0,c=a.length;c>b;b++){if("string"!=typeof a[b]&&"number"!=typeof a[b])throw new TypeError("Invalid argument: an edge id is not a string or a number, was "+a[b]);this.dropEdge(a[b])}}return this}),sigma.classes.graph.hasMethod("adjacentNodes")||sigma.classes.graph.addMethod("adjacentNodes",function(a,b){if(b=b||{},b.withHidden=2==arguments.length?b.withHidden:!0,"string"!=typeof a&&"number"!=typeof a)throw new TypeError("The node id is not a string or a number, was "+a);var c,d=this,e=[];return(this.allNeighborsIndex.get(a)||[]).forEach(function(f,g){b.withHidden?e.push(d.nodesIndex.get(g)):d.nodes(g).hidden||(c=0!=d.allNeighborsIndex.get(a).get(g).keyList().map(function(a){return d.edges(a)}).filter(function(a){return!a.hidden}).length,c&&e.push(d.nodesIndex.get(g)))}),e}),sigma.classes.graph.hasMethod("adjacentEdges")||sigma.classes.graph.addMethod("adjacentEdges",function(a,b){if(b=b||{},b.withHidden=2==arguments.length?b.withHidden:!0,"string"!=typeof a&&"number"!=typeof a)throw new TypeError("The node id is not a string or a number, was "+a);var c=this,d=this.allNeighborsIndex.get(a)||[],e=[];return d.forEach(function(a,f){d.get(f).forEach(function(a,d){!b.withHidden&&c.edges(d).hidden||e.push(c.edges(d))})}),e})}.call(this),function(undefined){"use strict";function Supervisor(a,b){_root.URL=_root.URL||_root.webkitURL,b=b||{},this.sigInst=a,this.graph=this.sigInst.graph,this.ppn=10,this.ppe=3,this.config={},this.worker=null,this.shouldUseWorker=null,this.workerUrl=null,this.runOnBackground=null,this.easing=null,this.randomize=null,this.configure(b),this.started=!1,this.running=!1,this.initWorker()}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.utils.pkg("sigma.layouts");var _root=this,webWorkers="Worker"in _root,eventEmitter={};sigma.classes.dispatcher.extend(eventEmitter),Supervisor.prototype.makeBlob=function(a){var b;try{b=new Blob([a],{type:"application/javascript"})}catch(c){_root.BlobBuilder=_root.BlobBuilder||_root.WebKitBlobBuilder||_root.MozBlobBuilder,b=new BlobBuilder,b.append(a),b=b.getBlob()}return b},Supervisor.prototype.graphToByteArrays=function(){var a,b,c,d=this.graph.nodes(),e=this.graph.edges(),f=d.length*this.ppn,g=e.length*this.ppe,h={};for(this.nodesByteArray=new Float32Array(f),this.edgesByteArray=new Float32Array(g),a=b=0,c=d.length;c>a;a++)h[d[a].id]=b,this.nodesByteArray[b]=this.randomize(d[a].x),this.nodesByteArray[b+1]=this.randomize(d[a].y),this.nodesByteArray[b+2]=0,this.nodesByteArray[b+3]=0,this.nodesByteArray[b+4]=0,this.nodesByteArray[b+5]=0,this.nodesByteArray[b+6]=1+this.graph.degree(d[a].id),this.nodesByteArray[b+7]=1,this.nodesByteArray[b+8]=d[a].size,this.nodesByteArray[b+9]=d[a].fixed||0,b+=this.ppn;for(a=b=0,c=e.length;c>a;a++)this.edgesByteArray[b]=h[e[a].source],this.edgesByteArray[b+1]=h[e[a].target],this.edgesByteArray[b+2]=e[a].weight||0,b+=this.ppe},Supervisor.prototype.applyLayoutChanges=function(a){for(var b=this.graph.nodes(),c=0,d=0,e=this.nodesByteArray.length;e>d;d+=this.ppn)b[c].fixed||(a?(b[c].fa2_x=this.nodesByteArray[d],b[c].fa2_y=this.nodesByteArray[d+1]):(b[c].x=this.nodesByteArray[d],b[c].y=this.nodesByteArray[d+1])),c++},Supervisor.prototype.sendByteArrayToWorker=function(a){var b={action:a||"loop",nodes:this.nodesByteArray.buffer},c=[this.nodesByteArray.buffer];"start"===a&&(b.config=this.config||{},
b.edges=this.edgesByteArray.buffer,c.push(this.edgesByteArray.buffer)),this.shouldUseWorker?this.worker.postMessage(b,c):_root.postMessage(b,"*")},Supervisor.prototype.start=function(){this.running||(this.running=!0,this.started?this.sendByteArrayToWorker():(this.sendByteArrayToWorker("start"),this.started=!0,eventEmitter.dispatchEvent("start")))},Supervisor.prototype.stop=function(){this.running&&(this.running=!1,eventEmitter.dispatchEvent("stop"))},Supervisor.prototype.initWorker=function(){var _this=this,workerFn=sigma.layouts.getForceLinkWorker();if(this.shouldUseWorker){if(this.workerUrl)this.worker=new Worker(this.workerUrl);else{var blob=this.makeBlob(workerFn);this.worker=new Worker(URL.createObjectURL(blob))}this.worker.postMessage=this.worker.webkitPostMessage||this.worker.postMessage}else eval(workerFn);this.msgName=this.worker?"message":"newCoords",this.listener=function(a){_this.nodesByteArray=new Float32Array(a.data.nodes),_this.running&&(_this.applyLayoutChanges(_this.runOnBackground),_this.sendByteArrayToWorker(),_this.runOnBackground||_this.sigInst.refresh({skipIndexation:!0})),a.data.converged&&(_this.running=!1),_this.running||(_this.killWorker(),_this.runOnBackground&&_this.easing?(_this.applyLayoutChanges(!0),eventEmitter.dispatchEvent("interpolate"),_this.graph.nodes().filter(function(a){return a.fixed}).forEach(function(a){a.fa2_x=a.x,a.fa2_y=a.y}),sigma.plugins.animate(_this.sigInst,{x:"fa2_x",y:"fa2_y"},{easing:_this.easing,onComplete:function(){_this.sigInst.refresh(),eventEmitter.dispatchEvent("stop")}})):(_this.applyLayoutChanges(!1),_this.sigInst.refresh(),eventEmitter.dispatchEvent("stop")))},(this.worker||document).addEventListener(this.msgName,this.listener),this.graphToByteArrays(),_this.sigInst.bind("kill",function(){sigma.layouts.killForceLink()})},Supervisor.prototype.killWorker=function(){this.worker?this.worker.terminate():(_root.postMessage({action:"kill"},"*"),document.removeEventListener(this.msgName,this.listener))},Supervisor.prototype.configure=function(a){switch(this.config=a,this.shouldUseWorker=a.worker===!1?!1:webWorkers,this.workerUrl=a.workerUrl,this.runOnBackground=!!a.background,this.easing=a.easing,a.randomize){case"globally":this.randomize=function(b){return Math.random()*(a.randomizeFactor||1)};break;case"locally":this.randomize=function(b){return b+Math.random()*(a.randomizeFactor||1)};break;default:this.randomize=function(a){return a}}if(this.started){var b={action:"config",config:this.config};this.shouldUseWorker?this.worker.postMessage(b):_root.postMessage(b,"*")}};var supervisor=null;sigma.layouts.startForceLink=function(a,b){return supervisor?supervisor.running||(supervisor.killWorker(),supervisor.initWorker(),supervisor.started=!1):supervisor=new Supervisor(a,b),b&&supervisor.configure(b),supervisor.start(),eventEmitter},sigma.layouts.stopForceLink=function(){return supervisor?(supervisor.stop(),supervisor):void 0},sigma.layouts.killForceLink=function(){supervisor&&(supervisor.stop(),supervisor.killWorker(),supervisor=null,eventEmitter={},sigma.classes.dispatcher.extend(eventEmitter))},sigma.layouts.configForceLink=function(a,b){return supervisor?supervisor.running||(supervisor.killWorker(),supervisor.initWorker(),supervisor.started=!1):supervisor=new Supervisor(a,b),supervisor.configure(b),eventEmitter},sigma.layouts.isForceLinkRunning=function(){return!!supervisor&&supervisor.running}}.call(this),function(undefined){"use strict";function no_crush(a){var b,c,d,e=["x","y","dx","dy","old_dx","old_dy","mass","convergence","size","fixed"],f=["source","target","weight"],g=["node","centerX","centerY","size","nextSibling","firstChild","mass","massCenterX","massCenterY"];for(c=0,d=g.length;d>c;c++)b=new RegExp("rp\\(([^,]*), '"+g[c]+"'\\)","g"),a=a.replace(b,0===c?"$1":"$1 + "+c);for(c=0,d=e.length;d>c;c++)b=new RegExp("np\\(([^,]*), '"+e[c]+"'\\)","g"),a=a.replace(b,0===c?"$1":"$1 + "+c);for(c=0,d=f.length;d>c;c++)b=new RegExp("ep\\(([^,]*), '"+f[c]+"'\\)","g"),a=a.replace(b,0===c?"$1":"$1 + "+c);return a}function getWorkerFn(){var a=crush?crush(Worker.toString()):Worker.toString();return";("+a+").call(this);"}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.utils.pkg("sigma.layouts");var _root=this,inWebWorker=!("document"in _root),Worker=function(a){function b(){var a,b,c={},d=arguments.length;for(a=d-1;a>=0;a--)for(b in arguments[a])c[b]=arguments[a][b];return c}function c(a){var b;for(b in a)"hasOwnProperty"in a&&!a.hasOwnProperty(b)||delete a[b];return a}function d(a,b,c,d){return Math.sqrt((c-a)*(c-a)+(d-b)*(d-b))}function e(a,b,c,d,e){return(e-d)*(a-b)/(c-b)+d}function f(a){return Math.acos(a.x/Math.sqrt(a.x*a.x+a.y*a.y))}function g(a,b,c,d){return{xi:-(d-b),yi:c-a,xi_prime:d-b,yi_prime:-(c-a)}}function h(a,b){return{x:(a.xi_prime-a.xi)/b,y:(a.yi_prime-a.yi)/b}}function i(a,b,c,d,e){return{x:a+(c-a)*e,y:b+(d-b)*e}}function j(a,b,c){c=c||{},n=a,o=b,r.nodesLength=n.length,r.edgesLength=o.length,k(c)}function k(a){r.settings=b(a,r.settings)}function l(){var a,b,c,j,k,l,m,q,s,t,u,v,w,x,y,z,A,B=r.settings.minNodeDistance;for(c=0;c<r.nodesLength;c+=r.ppn)n[c+4]=n[c+2],n[c+5]=n[c+3],n[c+2]=0,n[c+3]=0;if(r.settings.outboundAttractionDistribution){for(s=0,c=0;c<r.nodesLength;c+=r.ppn)s+=n[c+6];s/=r.nodesLength}if(r.settings.barnesHutOptimize){var C,D,E=1/0,F=-(1/0),G=1/0,H=-(1/0);for(p=[],c=0;c<r.nodesLength;c+=r.ppn)E=Math.min(E,n[c]),F=Math.max(F,n[c]),G=Math.min(G,n[c+1]),H=Math.max(H,n[c+1]);for(p[0]=-1,p[1]=(E+F)/2,p[2]=(G+H)/2,p[3]=Math.max(F-E,H-G),p[4]=-1,p[5]=-1,p[6]=0,p[7]=0,p[8]=0,a=1,c=0;c<r.nodesLength;c+=r.ppn)for(b=0;;)if(p[b+5]>=0)C=n[c]<p[b+1]?n[c+1]<p[b+2]?p[b+5]:p[b+5]+r.ppr:n[c+1]<p[b+2]?p[b+5]+2*r.ppr:p[b+5]+3*r.ppr,p[b+7]=(p[b+7]*p[b+6]+n[c]*n[c+6])/(p[b+6]+n[c+6]),p[b+8]=(p[b+8]*p[b+6]+n[c+1]*n[c+6])/(p[b+6]+n[c+6]),p[b+6]+=n[c+6],b=C;else{if(p[b]<0){p[b]=c;break}if(p[b+5]=a*r.ppr,m=p[b+3]/2,q=p[b+5],p[q]=-1,p[q+1]=p[b+1]-m,p[q+2]=p[b+2]-m,p[q+3]=m,p[q+4]=q+r.ppr,p[q+5]=-1,p[q+6]=0,p[q+7]=0,p[q+8]=0,q+=r.ppr,p[q]=-1,p[q+1]=p[b+1]-m,p[q+2]=p[b+2]+m,p[q+3]=m,p[q+4]=q+r.ppr,p[q+5]=-1,p[q+6]=0,p[q+7]=0,p[q+8]=0,q+=r.ppr,p[q]=-1,p[q+1]=p[b+1]+m,p[q+2]=p[b+2]-m,p[q+3]=m,p[q+4]=q+r.ppr,p[q+5]=-1,p[q+6]=0,p[q+7]=0,p[q+8]=0,q+=r.ppr,p[q]=-1,p[q+1]=p[b+1]+m,p[q+2]=p[b+2]+m,p[q+3]=m,p[q+4]=p[b+4],p[q+5]=-1,p[q+6]=0,p[q+7]=0,p[q+8]=0,a+=4,C=n[p[b]]<p[b+1]?n[p[b]+1]<p[b+2]?p[b+5]:p[b+5]+r.ppr:n[p[b]+1]<p[b+2]?p[b+5]+2*r.ppr:p[b+5]+3*r.ppr,p[b+6]=n[p[b]+6],p[b+7]=n[p[b]],p[b+8]=n[p[b]+1],p[C]=p[b],p[b]=-1,D=n[c]<p[b+1]?n[c+1]<p[b+2]?p[b+5]:p[b+5]+r.ppr:n[c+1]<p[b+2]?p[b+5]+2*r.ppr:p[b+5]+3*r.ppr,C!==D){p[D]=c;break}b=C}}if(r.settings.barnesHutOptimize)for(t=r.settings.scalingRatio,c=0;c<r.nodesLength;c+=r.ppn)for(b=0;;)if(p[b+5]>=0){if(z=Math.sqrt((n[c]-p[b+7])*(n[c]-p[b+7])+(n[c+1]-p[b+8])*(n[c+1]-p[b+8])),2*p[b+3]/z<r.settings.barnesHutTheta){if(u=n[c]-p[b+7],v=n[c+1]-p[b+8],r.settings.adjustSizes?z>0?(A=t*n[c+6]*p[b+6]/z/z,n[c+2]+=u*A,n[c+3]+=v*A):0>z&&(A=-t*n[c+6]*p[b+6]/z,n[c+2]+=u*A,n[c+3]+=v*A):z>0&&(A=t*n[c+6]*p[b+6]/z/z,n[c+2]+=u*A,n[c+3]+=v*A),p[b+4]<0)break;b=p[b+4];continue}b=p[b+5]}else{if(p[b]>=0&&p[b]!==c&&(u=n[c]-n[p[b]],v=n[c+1]-n[p[b]+1],z=Math.sqrt(u*u+v*v),r.settings.adjustSizes?z>0?(A=t*n[c+6]*n[p[b]+6]/z/z,n[c+2]+=u*A,n[c+3]+=v*A):0>z&&(A=-t*n[c+6]*n[p[b]+6]/z,n[c+2]+=u*A,n[c+3]+=v*A):z>0&&(A=t*n[c+6]*n[p[b]+6]/z/z,n[c+2]+=u*A,n[c+3]+=v*A)),p[b+4]<0)break;b=p[b+4]}else for(t=r.settings.scalingRatio,j=0;j<r.nodesLength;j+=r.ppn)for(k=0;j>k;k+=r.ppn)u=n[j]-n[k],v=n[j+1]-n[k+1],r.settings.adjustSizes?(z=Math.sqrt(u*u+v*v)-n[j+8]-n[k+8],z>0?(A=t*n[j+6]*n[k+6]/z/z,n[j+2]+=u*A,n[j+3]+=v*A,n[k+2]+=u*A,n[k+3]+=v*A):0>z&&(A=100*t*n[j+6]*n[k+6],n[j+2]+=u*A,n[j+3]+=v*A,n[k+2]-=u*A,n[k+3]-=v*A)):(z=Math.sqrt(u*u+v*v),z>0&&(A=t*n[j+6]*n[k+6]/z/z,n[j+2]+=u*A,n[j+3]+=v*A,n[k+2]-=u*A,n[k+3]-=v*A));for(q=r.settings.gravity/r.settings.scalingRatio,t=r.settings.scalingRatio,c=0;c<r.nodesLength;c+=r.ppn)A=0,u=n[c],v=n[c+1],z=Math.sqrt(u*u+v*v),r.settings.strongGravityMode?z>0&&(A=t*n[c+6]*q):z>0&&(A=t*n[c+6]*q/z),n[c+2]-=u*A,n[c+3]-=v*A;for(t=1*(r.settings.outboundAttractionDistribution?s:1),l=0;l<r.edgesLength;l+=r.ppe)j=o[l],k=o[l+1],m=o[l+2],y=Math.pow(m,r.settings.edgeWeightInfluence),u=n[j]-n[k],v=n[j+1]-n[k+1],r.settings.adjustSizes?(z=Math.sqrt(u*u+v*v-n[j+8]-n[k+8])-B,r.settings.linLogMode?r.settings.outboundAttractionDistribution?z>0&&(A=-t*y*Math.log(1+z)/z/n[j+6]):z>0&&(A=-t*y*Math.log(1+z)/z):r.settings.outboundAttractionDistribution?z>0&&(A=-t*y/n[j+6]):z>0&&(A=-t*y)):(z=Math.sqrt(u*u+v*v)-B,r.settings.linLogMode?r.settings.outboundAttractionDistribution?z>0&&(A=-t*y*Math.log(1+z)/z/n[j+6]):z>0&&(A=-t*y*Math.log(1+z)/z):r.settings.outboundAttractionDistribution?(z=1,A=-t*y/n[j+6]):(z=1,A=-t*y)),z>0&&(n[j+2]+=u*A,n[j+3]+=v*A,n[k+2]-=u*A,n[k+3]-=v*A);var I,J,K,L,M=0;if(r.settings.adjustSizes)for(c=0;c<r.nodesLength;c+=r.ppn)n[c+9]||(I=Math.sqrt(n[c+2]*n[c+2]+n[c+3]*n[c+3]),I>r.maxForce&&(n[c+2]=n[c+2]*r.maxForce/I,n[c+3]=n[c+3]*r.maxForce/I),J=n[c+6]*Math.sqrt((n[c+4]-n[c+2])*(n[c+4]-n[c+2])+(n[c+5]-n[c+3])*(n[c+5]-n[c+3])),K=Math.sqrt((n[c+4]+n[c+2])*(n[c+4]+n[c+2])+(n[c+5]+n[c+3])*(n[c+5]+n[c+3]))/2,L=.1*Math.log(1+K)/(1+Math.sqrt(J)),w=n[c],x=n[c+1],n[c]=n[c]+n[c+2]*(L/r.settings.slowDown),n[c+1]=n[c+1]+n[c+3]*(L/r.settings.slowDown),u=n[c],v=n[c+1],z=Math.sqrt((u-w)*(u-w)+(v-x)*(v-x)),M+=z);else for(c=0;c<r.nodesLength;c+=r.ppn)n[c+9]||(J=n[c+6]*Math.sqrt((n[c+4]-n[c+2])*(n[c+4]-n[c+2])+(n[c+5]-n[c+3])*(n[c+5]-n[c+3])),K=Math.sqrt((n[c+4]+n[c+2])*(n[c+4]+n[c+2])+(n[c+5]+n[c+3])*(n[c+5]+n[c+3]))/2,L=n[c+7]*Math.log(1+K)/(1+Math.sqrt(J)),n[c+7]=Math.min(1,Math.sqrt(L*(n[c+2]*n[c+2]+n[c+3]*n[c+3])/(1+Math.sqrt(J)))),w=n[c],x=n[c+1],n[c]=n[c]+n[c+2]*(L/r.settings.slowDown),n[c+1]=n[c+1]+n[c+3]*(L/r.settings.slowDown),u=n[c],v=n[c+1],z=Math.sqrt((u-w)*(u-w)+(v-x)*(v-x)),M+=z);if(r.iterations++,r.settings.autoStop&&(r.converged=r.iterations>r.settings.maxIterations||M/r.nodesLength<r.settings.avgDistanceThreshold,r.converged&&r.settings.alignNodeSiblings)){var N,O,P={},Q={};for(l=0;l<r.edgesLength;l+=r.ppe)j=o[l],k=o[l+1],j!==k&&(P[j]=P[j]||{},P[k]=P[k]||{},P[j][k]=!0,P[k][j]=!0);Object.keys(P).forEach(function(a){a=~~a,O=Object.keys(P[a]),2==O.length&&(N=O[0]+";"+O[1],N in Q?Q[N].push(a):(N=O[1]+";"+O[0],Q[N]||(Q[N]=[~~O[1],~~O[0]]),Q[N].push(a)))});var R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea=r.settings.nodeSiblingsAngleMin;Object.keys(Q).forEach(function(a){if(S=Q[a].shift(),T=Q[a].shift(),R=Q[a].filter(function(a){return!n[a+9]}),1!=R.length){if(W=n[S],X=n[S+1],Y=n[T],Z=n[T+1],U=Object.keys(P[S]).length,V=Object.keys(P[T]).length,$=e(U/(U+V),0,1,.25,.75),aa=i(W,X,Y,Z,$),ba=g(W,X,Y,Z),_=d(W,X,Y,Z),ca=h(ba,_),da=f(ca),2*ea>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");ea>0&&(ea>da||da>Math.PI-ea&&da<=Math.PI?ca={x:2*Math.cos(Math.PI-ea),y:2*Math.sin(Math.PI-ea)}:(da>2*Math.PI-ea||da>=Math.PI&&da<Math.PI+ea)&&(ca={x:2*Math.cos(ea),y:2*Math.sin(ea)}));var b=0,c=1,j=1;R.length%2==1&&(j=0,b=1);for(var k=0;k<R.length;k++)n[R[k]]=aa.x+c*ca.x*j*(b||k>=2?r.settings.nodeSiblingsScale:2*r.settings.nodeSiblingsScale/3),n[R[k]+1]=aa.y+c*ca.y*j*(b||k>=2?r.settings.nodeSiblingsScale:2*r.settings.nodeSiblingsScale/3),c=-c,j+=(k+b)%2}})}}function m(a){for(var b=0;a>b;b++)l();q()}var n,o,p,q,r={ppn:10,ppe:3,ppr:9,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:1,iterationsPerRender:1,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!1,alignNodeSiblings:!1,nodeSiblingsScale:1,nodeSiblingsAngleMin:0,minNodeDistance:0}};q="undefined"!=typeof window&&window.document?function(){if(!r.autoStop||r.converged){var a;document.createEvent?(a=document.createEvent("Event"),a.initEvent("newCoords",!0,!1)):(a=document.createEventObject(),a.eventType="newCoords"),a.eventName="newCoords",a.data={nodes:n.buffer,converged:r.converged},requestAnimationFrame(function(){document.dispatchEvent(a)})}}:function(){(!r.autoStop||r.converged)&&self.postMessage({nodes:n.buffer,converged:r.converged},[n.buffer])};var s=function(a){switch(a.data.action){case"start":j(new Float32Array(a.data.nodes),new Float32Array(a.data.edges),a.data.config),m(r.settings.startingIterations);break;case"loop":n=new Float32Array(a.data.nodes),m(r.settings.iterationsPerRender);break;case"config":k(a.data.config);break;case"kill":c(r),n=null,o=null,p=null,self.removeEventListener("message",s)}};self.addEventListener("message",s)},crush=null;if(inWebWorker)eval(getWorkerFn());else{if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.layouts.getForceLinkWorker=getWorkerFn}}.call(this),function(a){"use strict";function b(a){var b={id:a.id,label:a.label};return a.viz&&(b.viz=a.viz),a.attributes&&(b.attributes=a.attributes),b}function c(a){var b={id:a.id,type:a.type||"undirected",label:a.label||"",source:a.source,target:a.target,weight:+a.weight||1};return a.viz&&(b.viz=a.viz),a.attributes&&(b.attributes=a.attributes),b}function d(a){function d(){var a={};return l.els.meta?(a.lastmodifieddate=l.els.meta.getAttribute("lastmodifieddate"),h.nodeListEach(l.els.meta.childNodes,function(b){a[b.tagName.toLowerCase()]=b.textContent}),a):a}function e(a){var b=[];return l.els.model[a]&&h.nodeListEach(l.els.model[a],function(a){var c={id:a.getAttribute("id")||a.getAttribute("for"),type:a.getAttribute("type")||"string",title:a.getAttribute("title")||""},d=h.nodeListToArray(a.childNodes);d.length>0&&(c.defaultValue=d[0].textContent),b.push(c)}),b.length>0?b:!1}function f(a,b){var c={},d=b.getElementsByTagName("attvalue"),e=h.nodeListToHash(d,function(a){var b=h.namedNodeMapToObject(a.attributes),c=b.id||b["for"];return{key:c,value:b.value}});return a.map(function(a){c[a.id]=!(a.id in e)&&"defaultValue"in a?h.enforceType(a.type,a.defaultValue):h.enforceType(a.type,e[a.id])}),c}function g(a){var c=[];return h.nodeListEach(l.els.nodes,function(d){var e={id:d.getAttribute("id"),label:d.getAttribute("label")||""};a&&(e.attributes=f(a,d)),l.hasViz&&(e.viz=i(d)),c.push(b(e))}),c}function i(a){var b={},c=h.getFirstElementByTagNS(a,"viz","color");if(c){var d=["r","g","b","a"].map(function(a){return c.getAttribute(a)});b.color=h.getRGB(d)}var e=h.getFirstElementByTagNS(a,"viz","position");e&&(b.position={},["x","y","z"].map(function(a){b.position[a]=+e.getAttribute(a)}));var f=h.getFirstElementByTagNS(a,"viz","size");f&&(b.size=+f.getAttribute("value"));var g=h.getFirstElementByTagNS(a,"viz","shape");return g&&(b.shape=g.getAttribute("value")),b}function j(a,b){var d=[];return h.nodeListEach(l.els.edges,function(e){var g=h.namedNodeMapToObject(e.attributes);"type"in g||(g.type=b),a&&(g.attributes=f(a,e)),l.hasViz&&(g.viz=k(e)),d.push(c(g))}),d}function k(a){var b={},c=h.getFirstElementByTagNS(a,"viz","color");if(c){var d=["r","g","b","a"].map(function(a){return c.getAttribute(a)});b.color=h.getRGB(d)}var e=h.getFirstElementByTagNS(a,"viz","shape");e&&(b.shape=e.getAttribute("value"));var f=h.getFirstElementByTagNS(a,"viz","thickness");return f&&(b.thickness=+f.getAttribute("value")),b}var l={};l.els={root:a.getElementsByTagName("gexf")[0],graph:a.getElementsByTagName("graph")[0],meta:a.getElementsByTagName("meta")[0],nodes:a.getElementsByTagName("node"),edges:a.getElementsByTagName("edge"),model:h.getModelTags(a)},l.hasViz=!!h.getAttributeNS(l.els.root,"xmlns","viz"),l.version=l.els.root.getAttribute("version")||"1.0",l.mode=l.els.graph.getAttribute("mode")||"static";var m=l.els.graph.getAttribute("defaultedgetype");l.defaultEdgetype=m||"undirected";var n=e("node"),o=e("edge"),p={version:l.version,mode:l.mode,defaultEdgeType:l.defaultEdgetype,meta:d(),model:{},nodes:g(n),edges:j(o,l.defaultEdgetype)};return n&&(p.model.node=n),o&&(p.model.edge=o),p}function e(a,b){var c=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;var a,b;if(window.ActiveXObject){a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(b in a)try{return new ActiveXObject(a[b])}catch(c){}}return null}();if(!c)throw"XMLHttpRequest not supported, cannot load the file.";var d,e="function"==typeof b;return c.overrideMimeType?(c.overrideMimeType("text/xml"),d=function(a){return a.responseXML}):d=function(a){var b=new DOMParser;return b.parseFromString(a.responseText,"application/xml")},c.open("GET",a,e),e&&(c.onreadystatechange=function(){4===c.readyState&&b(d(c))}),c.send(),e?c:d(c)}function f(a){return d(a)}function g(a,b){return"function"==typeof b?e(a,function(a){b(d(a))}):d(e(a))}var h={getModelTags:function(a){var b,c=a.getElementsByTagName("attributes"),d={},e=c.length;for(b=0;e>b;b++)d[c[b].getAttribute("class")]=c[b].childNodes;return d},nodeListToArray:function(a){for(var b=[],c=0,d=a.length;d>c;++c)"#text"!==a[c].nodeName&&b.push(a[c]);return b},nodeListEach:function(a,b){for(var c=0,d=a.length;d>c;++c)"#text"!==a[c].nodeName&&b(a[c])},nodeListToHash:function(a,b){for(var c={},d=0;d<a.length;d++)if("#text"!==a[d].nodeName){var e=b(a[d]);c[e.key]=e.value}return c},namedNodeMapToObject:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b},getFirstElementByTagNS:function(a,b,c){var d=a.getElementsByTagName(b+":"+c)[0];return d||(d=a.getElementsByTagNameNS(b,c)[0]),d||(d=a.getElementsByTagName(c)[0]),d},getAttributeNS:function(b,c,d){var e=b.getAttribute(c+":"+d);return e===a&&(e=b.getAttributeNS(c,d)),e===a&&(e=b.getAttribute(d)),e},enforceType:function(a,b){switch(a){case"boolean":b="true"===b;break;case"integer":case"long":case"float":case"double":b=+b;break;case"liststring":b=b?b.split("|"):[]}return b},getRGB:function(a){return a[3]?"rgba("+a.join(",")+")":"rgb("+a.slice(0,-1).join(",")+")"}};if("undefined"!=typeof this.gexf)throw'gexf: error - a variable called "gexf" already exists in the global scope';this.gexf={parse:f,fetch:g,version:"0.1.1"},"undefined"!=typeof exports&&this.exports!==exports&&(module.exports=this.gexf)}.call(this),function(a){"use strict";function b(){return"e"+c++}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.parsers");var c=0;sigma.parsers.gexf=function(a,c,d){function e(a){for(h=a.nodes,f=0,g=h.length;g>f;f++)i=h[f],i.id=i.id,i.viz&&"object"==typeof i.viz&&(i.viz.position&&"object"==typeof i.viz.position&&(i.x=i.viz.position.x,i.y=-i.viz.position.y),i.size=i.viz.size,i.color=i.viz.color),i.attributes&&(i.attributes.latitude&&(i.lat=i.attributes.latitude),i.attributes.longitude&&(i.lng=i.attributes.longitude));for(h=a.edges,f=0,g=h.length;g>f;f++)i=h[f],i.id="string"==typeof i.id?i.id:b(),i.source=""+i.source,i.target=""+i.target,i.viz&&"object"==typeof i.viz&&(i.color=i.viz.color,i.size=i.viz.thickness),i.size=i.weight,i.direction=i.type,delete i.type;if(c instanceof sigma){for(c.graph.clear(),h=a.nodes,f=0,g=h.length;g>f;f++)c.graph.addNode(h[f]);for(h=a.edges,f=0,g=h.length;g>f;f++)c.graph.addEdge(h[f])}else"object"==typeof c?(c.graph=a,c=new sigma(c)):"function"==typeof c&&(d=c,c=null);return d?void d(c||a):a}var f,g,h,i;if("string"==typeof a)gexf.fetch(a,e);else if("object"==typeof a)return e(gexf.parse(a))}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.parsers"),sigma.utils.pkg("sigma.utils"),sigma.utils.xhr=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;var a,b;if(window.ActiveXObject){a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(b in a)try{return new ActiveXObject(a[b])}catch(c){}}return null},sigma.parsers.json=function(a,b,c){var d,e=sigma.utils.xhr();if(!e)throw"XMLHttpRequest not supported, cannot load the file.";e.open("GET",a,!0),e.onreadystatechange=function(){4===e.readyState&&(d=JSON.parse(e.responseText),b instanceof sigma?(b.graph.clear(),b.graph.read(d)):"object"==typeof b?(b.graph=d,b=new sigma(b)):"function"==typeof b&&(c=b,b=null),c&&c(b||d))},e.send()}}.call(this),function(a){"use strict";function b(){f=new sigma.utils.map,g=new sigma.utils.map}function c(){null!==h&&j&&h.dispatchEvent("activeNodes")}function d(){null!==h&&j&&h.dispatchEvent("activeEdges")}function e(a){h=this,i=a.graph,null===f&&(f=new sigma.utils.map,i.nodes().forEach(function(a){a.active&&f.set(a.id,a)})),null===g&&(g=new sigma.utils.map,i.edges().forEach(function(a){a.active&&g.set(a.id,a)})),sigma.classes.dispatcher.extend(this),a.bind("kill",function(){h.kill()})}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var f,g,h=null,i=null,j=!0;b(),sigma.classes.graph.attach("addNode","sigma.plugins.activeState.addNode",function(a){a.active&&(f.set(a.id,this.nodesIndex.get(a.id)),c())}),sigma.classes.graph.attach("addEdge","sigma.plugins.activeState.addEdge",function(a){a.active&&(g.set(a.id,this.edgesIndex.get(a.id)),d())}),sigma.classes.graph.attachBefore("dropNode","sigma.plugins.activeState.dropNode",function(b){this.nodesIndex.get(b)!==a&&this.nodesIndex.get(b).active&&(f["delete"](b),c())}),sigma.classes.graph.attachBefore("dropEdge","sigma.plugins.activeState.dropEdge",function(b){this.edgesIndex.get(b)!==a&&this.edgesIndex.get(b).active&&(g["delete"](b),d())}),sigma.classes.graph.attachBefore("clear","sigma.plugins.activeState.clear",b),e.prototype.kill=function(){this.unbind(),f=null,g=null,i=null,h=null},e.prototype.addNodes=function(a){var b,d=f.size;if(arguments.length||i.nodes().forEach(function(a){a.hidden||(a.active=!0,f.set(a.id,a))}),arguments.length>1)throw new TypeError("Too many arguments. Use an array instead.");if("string"==typeof a||"number"==typeof a)b=i.nodes(a),b.hidden||(b.active=!0,f.set(a,b));else if(Array.isArray(a)){var e,g;for(e=0,g=a.length;g>e;e++){if("string"!=typeof a[e]&&"number"!=typeof a[e])throw new TypeError("Invalid argument: a node id is not a string or a number, was "+a[e]);b=i.nodes(a[e]),b.hidden||(b.active=!0,f.set(a[e],b))}}return d!=f.size&&c(),this},e.prototype.addEdges=function(a){var b,c=g.size;if(arguments.length||i.edges().forEach(function(a){a.hidden||(a.active=!0,g.set(a.id,a))}),arguments.length>1)throw new TypeError("Too many arguments. Use an array instead.");if("string"==typeof a||"number"==typeof a)b=i.edges(a),b.hidden||(b.active=!0,g.set(a,b));else if(Array.isArray(a)){var e,f;for(e=0,f=a.length;f>e;e++){if("string"!=typeof a[e]&&"number"!=typeof a[e])throw new TypeError("Invalid argument: an edge id is not a string or a number, was "+a[e]);b=i.edges(a[e]),b.hidden||(b.active=!0,g.set(a[e],b))}}return c!=g.size&&d(),this},e.prototype.dropNodes=function(a){var b=f.size;if(arguments.length||i.nodes().forEach(function(a){a.active=!1,f["delete"](a.id)}),arguments.length>1)throw new TypeError("Too many arguments. Use an array instead.");if("string"==typeof a||"number"==typeof a)i.nodes(a).active=!1,f["delete"](a);else if(Array.isArray(a)){var d,e;for(d=0,e=a.length;e>d;d++){if("string"!=typeof a[d]&&"number"!=typeof a[d])throw new TypeError("Invalid argument: a node id is not a string or a number, was "+a[d]);i.nodes(a[d]).active=!1,f["delete"](a[d])}}return b!=f.size&&c(),this},e.prototype.dropEdges=function(a){var b=g.size;if(arguments.length||i.edges().forEach(function(a){a.active=!1,g["delete"](a.id)}),arguments.length>1)throw new TypeError("Too many arguments. Use an array instead.");if("string"==typeof a||"number"==typeof a)i.edges(a).active=!1,g["delete"](a);else if(Array.isArray(a)){var c,e;for(c=0,e=a.length;e>c;c++){if("string"!=typeof a[c]&&"number"!=typeof a[c])throw new TypeError("Invalid argument: an edge id is not a string or a number, was "+a[c]);i.edges(a[c]).active=!1,g["delete"](a[c])}}return b!=g.size&&d(),this},e.prototype.addNeighbors=function(){if(!("adjacentNodes"in i))throw new Error("Missing method graph.adjacentNodes");var a=f.keyList();return f.forEach(function(b,c){i.adjacentNodes(c).forEach(function(b){b.hidden||a.push(b.id)})}),j=!1,this.dropNodes().dropEdges(),j=!0,this.addNodes(a),this},e.prototype.setNodesBy=function(a){var b=[];return i.nodes().forEach(function(c){a.call(i,c)&&(c.hidden||b.push(c.id))}),j=!1,this.dropNodes(),j=!0,this.addNodes(b),this},e.prototype.setEdgesBy=function(a){var b=[];return i.edges().forEach(function(c){a.call(i,c)&&(c.hidden||b.push(c.id))}),j=!1,this.dropEdges(),j=!0,this.addEdges(b),this},e.prototype.invertNodes=function(){var a=i.nodes().filter(function(a){return!a.hidden&&!a.active}).map(function(a){return a.id});return j=!1,this.dropNodes(),j=!0,a.length?this.addNodes(a):c(),this},e.prototype.invertEdges=function(){var a=i.edges().filter(function(a){return!a.hidden&&!a.active}).map(function(a){return a.id});return j=!1,this.dropEdges(),j=!0,a.length?this.addEdges(a):d(),this},e.prototype.nodes=function(){if(!f)return[];if(!sigma.forceES5)return f.valueList();var a=[];return f.forEach(function(b,c){a.push(b)}),a},e.prototype.edges=function(){if(!g)return[];if(!sigma.forceES5)return g.valueList();var a=[];return g.forEach(function(b,c){a.push(b)}),a},e.prototype.nbNodes=function(){return f?f.size:0},e.prototype.nbEdges=function(){return g?g.size:0},sigma.plugins.activeState=function(a){return h||(h=new e(a)),h},sigma.plugins.killActiveState=function(){h instanceof e&&(h.kill(),h=null)}}.call(this),function(){"use strict";function a(a){if(d[a])return d[a];var b=[0,0,0];return a.match(/^#/)?(a=(a||"").replace(/^#/,""),b=3===a.length?[parseInt(a.charAt(0)+a.charAt(0),16),parseInt(a.charAt(1)+a.charAt(1),16),parseInt(a.charAt(2)+a.charAt(2),16)]:[parseInt(a.charAt(0)+a.charAt(1),16),parseInt(a.charAt(2)+a.charAt(3),16),parseInt(a.charAt(4)+a.charAt(5),16)]):a.match(/^ *rgba? *\(/)&&(a=a.match(/^ *rgba? *\( *([0-9]*) *, *([0-9]*) *, *([0-9]*) *(,.*)?\) *$/),b=[+a[1],+a[2],+a[3]]),d[a]={r:b[0],g:b[1],b:b[2]},d[a]}function b(b,c,d){b=a(b),c=a(c);var e={r:b.r*(1-d)+c.r*d,g:b.g*(1-d)+c.g*d,b:b.b*(1-d)+c.b*d};return"rgb("+[0|e.r,0|e.g,0|e.b].join(",")+")"}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var c=0,d={};sigma.plugins.animate=function(a,d,e){function f(){var c=(sigma.utils.dateNow()-m)/k;c>=1?(g.forEach(function(a){for(var b in d)b in d&&d[b]in a&&(a[b]=a[d[b]])}),a.refresh({skipIndexation:!0}),"function"==typeof i.onComplete&&i.onComplete(),a.dispatchEvent("animate.end")):(c=l(c),g.forEach(function(a){for(var e in d)e in d&&d[e]in a&&(e.match(/color$/)?a[e]=b(h[a.id][e],a[d[e]],c):a[e]=a[d[e]]*c+h[a.id][e]*(1-c))}),a.refresh({skipIndexation:!0}),a.animations[j]=requestAnimationFrame(f))}var g,h,i=e||{},j=++c,k=i.duration||a.settings("animationsTime"),l="string"==typeof i.easing?sigma.utils.easings[i.easing]:"function"==typeof i.easing?i.easing:sigma.utils.easings.quadraticInOut,m=sigma.utils.dateNow();g=i.nodes&&i.nodes.length?"object"==typeof i.nodes[0]?i.nodes:a.graph.nodes(i.nodes):a.graph.nodes(),h=g.reduce(function(a,b){var c;a[b.id]={};for(c in d)c in b&&(a[b.id][c]=b[c]);return a},{}),a.animations=a.animations||Object.create({}),sigma.plugins.killAnimate(a),a.dispatchEvent("animate.start"),f()},sigma.plugins.killAnimate=function(a){for(var b in a.animations||{})cancelAnimationFrame(a.animations[b])}}.call(window),function(){"use strict";function a(a,b,c){function d(a){var b=window.getComputedStyle(a),c=function(a){return parseInt(b.getPropertyValue(a).replace("px",""))||0};return{left:a.getBoundingClientRect().left+c("padding-left"),top:a.getBoundingClientRect().top+c("padding-top")}}function e(a){u=!1,n.removeEventListener("mousemove",j),n.removeEventListener("mouseup",i),t?setTimeout(function(){r=t,p.addEventListener("mousedown",h)},0):r=null}function f(a){if(0!=a.data.enter.nodes.length){var b=a.data.enter.nodes[0];t&&t.id===b.id||(t=b,u||(r=t,p.addEventListener("mousedown",h)))}}function g(a){if(0!=a.data.leave.nodes.length){var b=a.data.leave.nodes[0];t&&t.id===b.id?(t=null,r=null):t||p.removeEventListener("mousedown",h)}}function h(a){y&&3!=a.which&&(u=!0,r&&l.graph.nodes().length>0&&(x=!0,p.removeEventListener("mousedown",h),n.addEventListener("mousemove",j),n.addEventListener("mouseup",i),o.settings({mouseEnabled:!1,enableHovering:!1}),k.dispatchEvent("startdrag",{node:r,captor:a,renderer:o})))}function i(a){if(u=!1,p.addEventListener("mousedown",h),n.removeEventListener("mousemove",j),n.removeEventListener("mouseup",i),o.settings({mouseEnabled:!0,enableHovering:!0}),w){if(k.dispatchEvent("drop",{node:s,captor:a,renderer:o}),m)for(var b=m.nodes(),c=0;c<b.length;c++)b[c].alphaX=void 0,b[c].alphaY=void 0;l.refresh()}k.dispatchEvent("dragend",{node:r,captor:a,renderer:o}),w=!1,s=null}function j(a){function b(){var b,c,e,f,g,h,i,j=d(o.container),n=a.clientX-j.left,p=a.clientY-j.top,t=Math.cos(o.camera.angle),u=Math.sin(o.camera.angle),v=l.graph.nodes(),z=[];if((!m||m.nbNodes()!==v.length)&&y&&!(v.length<2)&&(i=sigma.utils.getDistance(n,p,r[q+"x"],r[q+"y"]),!(x&&i<r[q+"size"]))){x=!1;for(var A=0;y&&(f=v[A],f&&(g={x:f.x*t+f.y*u,y:f.y*t-f.x*u,renX:f[q+"x"],renY:f[q+"y"]},z.push(g)),A!=v.length-1);A++)if(A>0){if(z[0].x!=z[1].x&&z[0].y!=z[1].y)break;z.pop()}var B=z[0],C=z[1],D=C.renX-B.renX;0===D&&(D=1);var E=C.renY-B.renY;if(0===E&&(E=1),n=(n-B.renX)/D*(C.x-B.x)+B.x,p=(p-B.renY)/E*(C.y-B.y)+B.y,b=n*t-p*u,c=p*t+n*u,m&&(e=m.nodes(),h=-1<e.map(function(a){return a.id}).indexOf(r.id)))for(var A=0;A<e.length;A++)s!=r&&(e[A].alphaX=void 0,e[A].alphaY=void 0),e[A].alphaX&&e[A].alphaY||(e[A].alphaX=e[A].x-n,e[A].alphaY=e[A].y-p),e[A].x=r.x+e[A].alphaX,e[A].y=r.y+e[A].alphaY;r.x=b,r.y=c,l.refresh({skipIndexation:!0}),w=!0,s=r,k.dispatchEvent("drag",{node:s,captor:a,renderer:o})}}if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){clearTimeout(c);var c=setTimeout(b,0)}else b()}if(sigma.classes.dispatcher.extend(this),sigma.renderers.webgl&&b instanceof sigma.renderers.webgl)throw new Error("The sigma.plugins.dragNodes is not compatible with the WebGL renderer");var k=this,l=a,m=c,n=document.body,o=b,p=b.container.getElementsByClassName("sigma-mouse")[0],q=b.options.prefix,r=null,s=null,t=null,u=!1,v=!1,w=!1,x=!0,y=!0;b instanceof sigma.renderers.svg&&(p=b.container.firstChild),b.bind("hovers",f),b.bind("hovers",g),b.bind("click",e),this.enable=function(){y=!0},this.disable=function(){y=!1,r=null,s=null,t=null,u=!1,v=!1,w=!1,x=!0},this.unbindAll=function(){p.removeEventListener("mousedown",h),n.removeEventListener("mousemove",j),n.removeEventListener("mouseup",i),o.unbind("hovers",f),o.unbind("hovers",g)}}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var b={};sigma.plugins.dragNodes=function(c,d,e){return b[c.id]||(b[c.id]=new a(c,d,e)),c.bind("kill",function(){sigma.plugins.killDragNodes(c)}),c.bind("animate.start",function(){b[c.id].disable()}),c.bind("animate.end",function(){b[c.id].enable()}),b[c.id]},sigma.plugins.killDragNodes=function(c){b[c.id]instanceof a&&(b[c.id].unbindAll(),delete b[c.id])}}.call(window),function(undefined){"use strict";function strToObjectRef(a,b){return b.split(".").reduce(function(a,b){return a[b]},a)}function emptyObject(a){var b;for(b in a)"hasOwnProperty"in a&&!a.hasOwnProperty(b)||delete a[b];return a}function deepCopy(o){var copy=Object.create(null);for(var i in o)"object"==typeof o[i]&&null!==o[i]?copy[i]=deepCopy(o[i]):"function"==typeof o[i]&&null!==o[i]?eval(" copy[i] = "+o[i].toString()):copy[i]=o[i];return copy}function baseHistogram(a,b){var c,d,e,f,g={};return a.length?(c=a.map(function(a){return parseFloat(a)}).sort(function(a,b){return a-b}),d=c[0],e=c[c.length-1],e-d!==0?c.forEach(function(a){f=Math.floor(b*Math.abs(a-d)/Math.abs(e-d)),f-=f==b?1:0,g[a]=f}):c.forEach(function(a){g[a]=0}),g):g}function histogram(a,b){var c,d=[],e=0;if(a&&a[b]){Object.keys(a[b]).forEach(function(c){var e=a[b][c];d[e]=d[e]||[],d[e].push(+c)}),c=1!==d.length?d.length:7;for(var f=0;c>f;f++)d[f]&&(e=e>d[f].length?e:d[f].length);for(var f=0;c>f;f++)d[f]===undefined&&(d[f]=[]),d[f]={bin:f,values:d[f],
ratio:d[f].length/e},d[f].values.length&&(d[f].min=Math.min.apply(null,d[f].values),d[f].max=Math.max.apply(null,d[f].values))}return d}function resolveHistogram(a,b,c){for(var d,e=b.get(c),f=a.length,g=0,h=0;f>h;h++)a[h].items=[];Object.keys(e).forEach(function(b){for(var f=0;f<e[b].items.length;f++){d=e[b].items[f],b=strToObjectRef(d,c);for(var g=0;g<a.length;g++)!1 in a[g]||!1 in a[g]||a[g].min<=b&&b<=a[g].max&&a[g].items.push(d)}});for(var h=0;f>h;h++)a[h].items&&(g=g>a[h].items.length?g:a[h].items.length);for(var h=0;f>h;h++)a[h].itemsRatio=a[h].items.length/g;return a}function download(a,b,c){var d=null,e=null,f=null;if(window.Blob?(d=new Blob([a],{type:"text/json"}),e=window.URL.createObjectURL(d)):f="data:text/json;charset=UTF-8,"+encodeURIComponent(a),navigator.msSaveBlob)navigator.msSaveBlob(d,c);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(d,c);else{var g=document.createElement("a");g.setAttribute("href",window.Blob?e:f),g.setAttribute("download",c||"graph."+b),document.body.appendChild(g),g.click(),document.body.removeChild(g)}e&&setTimeout(function(){window.URL.revokeObjectURL(e)},0)}function Vision(a,b,c,d){var e=this;if(this.visualVars=null,this.mappings=null,this.palette=d,this.idx=Object.create(null),this.histograms=Object.create(null),this.deprecated=Object.create(null),this.sigmaSettings=Object.create(null),this.dataTypes=Object.create(null),this.originalVisualVariable=Object.create(null),"nodes"===b)this.visualVars=["color","size","label","type","icon","image"],this.mappings=c.nodes,this.dataset=function(){return a.graph.nodes()};else{if("edges"!==b)throw new Error('Invalid argument: "datasetName" is not "nodes" or "edges", was '+b);this.visualVars=["color","size","label","type"],this.mappings=c.edges,this.dataset=function(){return a.graph.edges()}}return this.update=function(a){function b(b,d){c.idx[a][b]===undefined&&(c.idx[a][b]={key:b,items:[],styles:Object.create(null)}),c.idx[a][b].items.push(d),(h||h===undefined)&&(h="number"==typeof b)}var c=this;if(a===undefined)throw new Error('Missing argument: "key".');if("string"!=typeof a)throw new Error('Invalid argument: "key" is not a string, was '+a);var d,f,g,h=undefined,i=!0;f=function(a,b){return strToObjectRef(a,b)},g=function(a,b){return strToObjectRef(a,b)},this.idx[a]={},this.dataset().forEach(function(c){d=f(c,a),d!==undefined&&(i&&(i=Array.isArray(d)?i:!1),i?1===d.length?b(d[0],c):d.forEach(function(a){b(a,c)}):b(d,c))}),this.dataTypes[a]={sequential:h,array:i},this.deprecated[a]=!1;var j=0;for(d in this.idx[a])j=j<this.idx[a][d].items.length?this.idx[a][d].items.length:j;Object.keys(this.idx[a]).forEach(function(b){c.idx[a][b].ratio=parseFloat(c.idx[a][b].items.length/j)});var k,l,m,n,o,p,q,r=0;q=Object.keys(e.mappings).filter(function(b){return e.mappings[b]&&e.mappings[b].by!==undefined&&e.mappings[b].by.toString()==a}),q.forEach(function(b){switch(b){case"color":if(l=e.mappings.color.scheme,"string"!=typeof l)throw new Error('color.scheme "'+l+'" is not a string.');h&&(p=e.mappings.color.bins||7,c.histograms.color=c.histograms.color||{},c.histograms.color[a]=baseHistogram(Object.keys(c.idx[a]),p));break;case"label":if(k=e.mappings.label.format||function(a){return"string"==typeof a?a:a.label},"function"!=typeof k)throw new Error('label.format "'+k+'" is not a function.');break;case"size":if(h===undefined)break;if(!h)throw new Error('One value of the property "'+a+'" is not a number.');c.histograms.size=c.histograms.size||{},c.histograms.size[a]=baseHistogram(Object.keys(c.idx[a]),e.mappings.size.bins||7);break;case"type":if(m=e.mappings.type.scheme,"string"!=typeof m)throw new Error('type.scheme "'+m+'" is not a string.');break;case"icon":if(n=e.mappings.icon.scheme,"string"!=typeof n)throw new Error('icon.scheme "'+n+'" is not a string.');break;case"image":if(o=e.mappings.image.scheme,"string"!=typeof o)throw new Error('type.scheme "'+o+'" is not a string.')}}),Object.keys(this.idx[a]).forEach(function(b){q.forEach(function(d){switch(d){case"color":h?c.idx[a][b].styles.color=function(){var d=c.histograms.color[a][b];return g(e.palette,l)[p][d]}:c.idx[a][b].styles.color=function(){if(g(e.palette,l)===undefined)throw new Error("Wrong or undefined color scheme.");if(e.mappings.color.set>0){var a=g(e.palette,l)[e.mappings.color.set][r];return r=(r+1)%e.mappings.color.set,a}return g(e.palette,l)[b]};break;case"label":c.idx[a][b].styles.label=function(b){return k(f(b,a))};break;case"size":c.idx[a][b].styles.size=function(){return 1+c.histograms.size[a][b]};break;case"type":c.idx[a][b].styles.type=function(){if(g(e.palette,m)===undefined)throw new Error("Wrong or undefined type scheme.");return g(e.palette,m)[b]};break;case"icon":c.idx[a][b].styles.icon=function(){if(g(e.palette,n)===undefined)throw new Error("Wrong or undefined icon scheme.");return g(e.palette,n)[b]};break;case"image":c.idx[a][b].styles.image=function(){if(g(e.palette,o)===undefined)throw new Error("Wrong or undefined image scheme.");return g(e.palette,o)[b]}}})})},this.get=function(a){if(a===undefined)throw new TypeError('Missing argument: "key".');if("string"!=typeof a)throw new TypeError('Invalid argument: "key" is not a string, was '+a);return this.deprecated[a]&&this.update(a),this.idx[a]===undefined&&this.update(a),this.idx[a]},this.applyStyle=function(c,d){if(d===undefined)throw new TypeError('Missing argument: "key"');if("string"!=typeof d)throw new TypeError('Invalid argument: "key" is not a string, was '+d);if(-1==this.visualVars.indexOf(c))throw new Error('Unknown style "'+c+'"');var e=this,f=this.get(d);if("color"===c&&e.dataTypes[d].array&&(this.dataset().forEach(function(a){delete a.colors}),Object.keys(f).forEach(function(a){var b=f[a];b.items.forEach(function(a){a.colors=[]})})),Object.keys(f).forEach(function(a){var b=f[a];b.items.forEach(function(a){if(a!==undefined&&b.styles!==undefined&&"function"==typeof b.styles[c]){e.originalVisualVariable[a.id]||(e.originalVisualVariable[a.id]={}),c in e.originalVisualVariable[a.id]||Object.defineProperty(e.originalVisualVariable[a.id],c,{enumerable:!0,value:a[c]});var f=b.styles[c](a);"color"===c&&e.dataTypes[d].array?f!==undefined&&(a.color=f,a.colors.push(f)):f!==undefined&&(a[c]=f)}else if("function"==typeof b.styles[c])throw new TypeError(b.styles+"."+c+"is not a function, was "+b.styles[c])})}),"size"===c)if("nodes"===b){if(this.mappings.size.min>this.mappings.size.max)throw new RangeError("nodes.size.min must be lower or equal than nodes.size.max");this.mappings.size.min&&(this.sigmaSettings.minNodeSize||(this.sigmaSettings.minNodeSize=a.settings("minNodeSize")),a.settings("minNodeSize",this.mappings.size.min)),this.mappings.size.max&&(this.sigmaSettings.maxNodeSize||(this.sigmaSettings.maxNodeSize=a.settings("maxNodeSize")),a.settings("maxNodeSize",this.mappings.size.max))}else if("edges"===b){if(this.mappings.size.min>this.mappings.size.max)throw new RangeError("edges.size.min must be lower or equal than edges.size.max");this.mappings.size.min&&(this.sigmaSettings.minEdgeSize||(this.sigmaSettings.minEdgeSize=a.settings("minEdgeSize")),a.settings("minEdgeSize",this.mappings.size.min)),this.mappings.size.max&&(this.sigmaSettings.maxEdgeSize||(this.sigmaSettings.maxEdgeSize=a.settings("maxEdgeSize")),a.settings("maxEdgeSize",this.mappings.size.max))}},this.resetStyle=function(c,d){if(d===undefined)throw new TypeError('Missing argument: "key"');if("string"!=typeof d)throw new TypeError('Invalid argument: "key" is not a string, was '+d);if(-1==this.visualVars.indexOf(c))throw new Error('Unknown style "'+c+'".');if(this.idx[d]!==undefined){var e=this,f=this.get(d);"color"===c&&e.dataTypes[d].array&&Object.keys(f).forEach(function(a){var b=f[a];b.items.forEach(function(a){delete a.colors})}),Object.keys(f).forEach(function(a){var b=f[a];b.items.forEach(function(a){a!==undefined&&a[c]!==undefined&&(e.originalVisualVariable[a.id]===undefined||e.originalVisualVariable[a.id][c]===undefined?"edges"===e.key&&"size"===c?a.size=1:delete a[c]:a[c]=e.originalVisualVariable[a.id][c])})}),"size"===c&&("nodes"===b?(this.sigmaSettings.minNodeSize&&a.settings("minNodeSize",this.sigmaSettings.minNodeSize),this.sigmaSettings.maxNodeSize&&a.settings("maxNodeSize",this.sigmaSettings.maxNodeSize)):"edges"===b&&(this.sigmaSettings.minEdgeSize&&a.settings("minEdgeSize",this.sigmaSettings.minEdgeSize),this.sigmaSettings.maxEdgeSize&&a.settings("maxEdgeSize",this.sigmaSettings.maxEdgeSize)))}},this.clear=function(){this.visualVars.length=0,emptyObject(this.idx),emptyObject(this.histograms),emptyObject(this.deprecated),emptyObject(this.sigmaSettings),emptyObject(this.dataTypes),emptyObject(this.originalVisualVariable)},this}function design(a,b){function c(b,c,d){d?b[d]&&b[d].by&&(c.applyStyle(d,b[d].by),b[d].active=!0):Object.keys(b).forEach(function(a){b[a].active=!1,b[a]&&b[a].by&&(c.applyStyle(a,b[a].by),b[a].active=!0)}),a&&a.refresh({skipIndexation:!0})}function d(b,c,d){d?b[d]&&b[d].active&&(c.resetStyle(d,b[d].by),b[d].active=!1):Object.keys(b).forEach(function(a){b[a].active&&(c.resetStyle(a,b[a].by),b[a].active=!1)}),a&&a.refresh({skipIndexation:!0})}this.palette=(b||{}).palette||{},this.styles=sigma.utils.extend((b||{}).styles||{},{nodes:{},edges:{}});var e=this,f=new Vision(a,"nodes",this.styles,this.palette),g=new Vision(a,"edges",this.styles,this.palette);a.bind("kill",function(){sigma.plugins.killDesign(a)}),this.setStyles=function(a){return this.styles=sigma.utils.extend(a||{},{nodes:{},edges:{}}),f.mappings=this.styles.nodes,g.mappings=this.styles.edges,this.deprecate(),this},this.nodesBy=function(a,b){return this.styles=sigma.utils.extend(this.styles||{},{nodes:{},edges:{}}),this.styles.nodes[a]=b,f.mappings=this.styles.nodes,b.by&&this.deprecate("nodes",b.by),this},this.edgesBy=function(a,b){return this.styles=sigma.utils.extend(this.styles||{},{nodes:{},edges:{}}),this.styles.edges[a]=b,g.mappings=this.styles.edges,b.by&&this.deprecate("edges",b.by),this},this.setPalette=function(a){return this.palette=a,f.palette=this.palette,g.palette=this.palette,this.deprecate(),this},this.nodes=function(a){return f.get(a)},this.edges=function(a){return g.get(a)},this.inspect=function(){return{nodes:deepCopy(f),edges:deepCopy(g)}},this.apply=function(a,b){if(this.styles){if(!a)return c(this.styles.nodes,f,b),c(this.styles.edges,g,b),this;switch(a){case"nodes":c(this.styles.nodes,f,b);break;case"edges":c(this.styles.edges,g,b);break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+a)}return this}},this.reset=function(a,b){if(this.styles){if(!a)return d(this.styles.nodes,f,b),d(this.styles.edges,g,b),this;switch(a){case"nodes":d(this.styles.nodes,f,b);break;case"edges":d(this.styles.edges,g,b);break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+a)}return this}},this.deprecate=function(a,b){if(a){if("nodes"!==a&&"edges"!==a)throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+a);b?"nodes"===a?f.deprecated[b]=!0:"edges"===a&&(g.deprecated[b]=!0):"nodes"===a?Object.keys(f.deprecated).forEach(function(a){f.deprecated[a]=!0}):"edges"===a&&Object.keys(g.deprecated).forEach(function(a){g.deprecated[a]=!0})}else Object.keys(f.deprecated).forEach(function(a){f.deprecated[a]=!0}),Object.keys(g.deprecated).forEach(function(a){g.deprecated[a]=!0});return this},this.deletePropertyStylesFrom=function(a,b,c){if(null==b)throw new TypeError('Missing argument: "id".');if("nodes"!==a&&"edges"!==a)throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+a);if(null==c)throw new TypeError('Missing argument: "key".');var d,e,h,i;d="nodes"===a?f.get(c):g.get(c);for(var j=Object.keys(d),k=0;k<j.length;k++){e=d[j[k]],h=Object.keys(e.styles);for(var l=0;l<e.items.length;l++)if(i=e.items[l],i.id===b){for(var m=0;m<h.length;m++)"label"!==h[m]&&"size"!==h[m]?delete i[h[m]]:"size"===h[m]&&(i.size=1);return this.deprecate(a,c),this}}return this},this.clear=function(){return this.reset(),this.styles={nodes:{},edges:{}},this.palette={},f.clear(),g.clear(),f=new Vision(a,"nodes",this.styles,this.palette),g=new Vision(a,"edges",this.styles,this.palette),a&&a.refresh({skipIndexation:!0}),this},this.kill=function(){delete this.styles,delete this.palette,f.clear(),g.clear()},this.toJSON=function(a){a=a||{};var b={styles:this.styles,palette:this.palette};if(a.pretty)var c=JSON.stringify(b,null," ");else var c=JSON.stringify(b);return a.download&&download(c,"json",a.filename),c},this.utils={},this.utils.isSequential=function(a,b){if(!a)throw new TypeError('Missing argument: "target"');var c;switch(a){case"nodes":c=f;break;case"edges":c=g;break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+a)}if(b===undefined)throw new TypeError('Missing argument: "property"');if("string"!=typeof b)throw new TypeError('Invalid argument: "property" is not a string, was '+b);if(!(b in c.dataTypes)||c.dataTypes[b].sequential===undefined){var d,e=!1,h=!0;c.dataset().forEach(function(a){d=strToObjectRef(a,b),d!==undefined&&(e=!0,h="number"==typeof d?h:!1)}),e?c.dataTypes[b]={sequential:h}:c.dataTypes[b]&&(c.dataTypes[b].sequential=undefined)}return(c.dataTypes[b]||{}).sequential},this.utils.histogram=function(a,b,c){if(!a)throw new TypeError('Missing argument: "target"');var d;switch(a){case"nodes":d=f;break;case"edges":d=g;break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+a)}if(-1==d.visualVars.indexOf(b))throw new Error('Unknown visual variable "'+b+'".');if(c===undefined)throw new TypeError('Missing argument: "property".');if("string"!=typeof c)throw new TypeError('Invalid argument: "property" is not a string, was'+c);var h=e.utils.isSequential(a,c);if(!h)throw new Error('The property "'+c+'" is not sequential.');var i=histogram(d.histograms[b],c);if(i=resolveHistogram(i,d,c),"color"===b){if(!e.styles[a].color)throw new Error('Missing key "color" in '+a+" palette.");var j=i.length,k=strToObjectRef(e.palette,e.styles[a].color.scheme);if(!k)throw new Error('Color scheme "'+e.styles[a].color.scheme+'" not in '+a+" palette.");if(h)for(var l=0;j>l;l++){if(!k[j])throw new Error('Missing key "'+j+'" in '+a+' palette " of color scheme '+e.styles[a].color.scheme+'".');i[l][b]=k[j][l]}}return i}}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var _instance={};sigma.plugins.design=function(a,b){return _instance[a.id]||(_instance[a.id]=new design(a,b)),_instance[a.id]},sigma.plugins.killDesign=function(a){_instance[a.id]instanceof design&&_instance[a.id].kill(),delete _instance[a.id]}}.call(this),function(a){"use strict";function b(a){var b=document.createEvent("MouseEvent");return b.initMouseEvent(a.type,a.canBubble,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget),b}function c(a){return"undefined"!=typeof a.lat&&"undefined"!=typeof a.lng&&"number"==typeof a.lat&&"number"==typeof a.lng}function d(d,h,i){function j(b){if(C){for(var c,d=C.graph.nodes(),e=0;e<d.length;e++)c=d[e],A||c.leaflet_hidden===a||(c.hidden=c.leaflet_hidden,c.leaflet_hidden=a),c.leaflet_x!==a&&c.leaflet_y!==a&&(H?(c.x=c["read_cam0:x"]||c.x,c.y=c["read_cam0:y"]||c.y,c.leaflet_x_easing=c.leaflet_x,c.leaflet_y_easing=c.leaflet_y):(c.x=c.leaflet_x,c.y=c.leaflet_y),c.leaflet_x=a,c.leaflet_y=a);H?m(d,b):(C.refresh(),b&&b())}}function k(){A&&(A.has("geo-coordinates")?A.apply():A.nodesBy(c,"geo-coordinates").apply())}function l(){K=!K}function m(a,b){sigma.plugins.animate(C,{x:"leaflet_x_easing",y:"leaflet_y_easing"},{easing:I,onComplete:function(){C.refresh();for(var c=0;c<a.length;c++)a[c].leaflet_x_easing=null,a[c].leaflet_y_easing=null;b&&b()},duration:J})}function n(a){for(var b,c,d=a.data.nodes||[a.data.node],e=0,f=d.length;f>e;e++)b=d[e],c=B.utils.sigmaPointToLatLng(b),b.lat_init=b.lat,b.lng_init=b.lng,b.lat=c.lat,b.lng=c.lng}function o(){O||(O=!0,Object.keys(f).forEach(function(a){F[a]=C.settings(a),C.settings(a,f[a])}),C.camera.ratio=1)}function p(){O&&(O=!1,Object.keys(f).forEach(function(a){C.settings(a,F[a])}))}function q(){if(!P&&"undefined"!=typeof sigma.plugins.locate&&(P=!0,C)){var a=sigma.plugins.locate(C).settings.animation;G.nodeDuration=a.node.duration,G.edgeDuration=a.edge.duration,G.centerDuration=a.center.duration,a.node.duration=0,a.edge.duration=0,a.center.duration=0}}function r(){if(P&&"undefined"!=typeof sigma.plugins.locate&&(P=!1,C)){var a=sigma.plugins.locate(C).settings.animation;a.node.duration=G.nodeDuration,a.edge.duration=G.edgeDuration,a.center.duration=G.centerDuration}}function s(){g.forEach(function(a){E.container.addEventListener(a,u,!0)})}function t(){g.forEach(function(a){E.container.removeEventListener(a,u,!0)})}function u(a){D.getContainer().dispatchEvent(b(a))}function v(){C.settings("enableCamera",!1),E.container.style.visibility="hidden"}function w(){C.settings("enableCamera",!0),E.container.style.visibility="",B.syncNodes()}function x(){D&&(D.getContainer().style.opacity=0,D.getContainer().style.visibility="hidden")}function y(){D&&(D.getContainer().style.opacity=1,D.getContainer().style.visibility="")}if(sigma.classes.dispatcher.extend(this),"undefined"==typeof L)throw new Error("leaflet is not declared");i=i||{};var z,A,B=this,C=d,D=h,E=i.renderer||C.renderers[0],F=Object.create(null),G=Object.create(null),H=!1,I=i.easing,J=i.duration,K=!1,M=!1,N=!1,O=!1,P=!1,Q={x:C.camera.x,y:C.camera.y,ratio:C.camera.ratio};if(I&&(!sigma.plugins||"undefined"==typeof sigma.plugins.animate))throw new Error("sigma.plugins.animate is not declared");this.isApplicable=function(){for(var a=C.graph.nodes(),b=0,d=a.length;d>b;b++)if(c(a[b]))return!0;return!1},this.isEnabled=function(){return M},this.enable=function(){return y(),o(),q(),Q={x:C.camera.x,y:C.camera.y,ratio:C.camera.ratio},B.bindAll(),H=!!I,B.syncNodes(function(){B.dispatchEvent("enabled")}),H=!1,M=!0,B},this.disable=function(){return x(),p(),r(),H=!!I,A&&A.undo("geo-coordinates").apply(),j(function(){B.dispatchEvent("disabled")}),H=!1,M=!1,B.unbindAll(),B},this.syncNodes=function(b,d){var f,g,h;f="string"==typeof b||"number"==typeof b||Array.isArray(b)?C.graph.nodes(b):C.graph.nodes(),"function"==typeof b&&(d=b),Array.isArray(f)||(f=[f]);for(var i=0,j=f.length;j>i;i++)g=f[i],g.leaflet_x===a&&(g.leaflet_x=g.x),g.leaflet_y===a&&(g.leaflet_y=g.y),c(g)?(e.set(g.id,C.graph.nodes(g.id)),h=B.utils.latLngToSigmaPoint(g),H?(g.x=g["read_cam0:x"]||g.x,g.y=g["read_cam0:y"]||g.y,g.leaflet_x_easing=h.x,g.leaflet_y_easing=h.y):(g.x=h.x,g.y=h.y)):(e["delete"](g.id),A||(g.leaflet_hidden===a&&(g.leaflet_hidden=!!g.hidden),g.hidden=!0));return k(),H?m(f,d):(C.refresh(),d&&d()),B},this.syncMap=function(){if(Q.ratio!==C.camera.ratio)Q.ratio<C.camera.ratio?D.zoomIn():D.zoomOut(),C.camera.ratio=1;else{var a=C.camera.x-Q.x,b=C.camera.y-Q.y;Q.x=C.camera.x,Q.y=C.camera.y,D.panBy([a,b],{animate:!1})}return B},this.fitBounds=function(a){function b(){if(c.edgeIds){Array.isArray(c.edgeIds)||(c.edgeIds=[c.edgeIds]),c.nodeIds=[];for(var a=C.graph.edges(c.edgeIds),e=0,f=a.length;f>e;e++)c.nodeIds.push(a[e].source),c.nodeIds.push(a[e].target)}c.nodeIds&&!Array.isArray(c.nodeIds)&&(c.nodeIds=[c.nodeIds]);var g=c.nodeIds?C.graph.nodes(c.nodeIds):C.graph.nodes();D.fitBounds(B.utils.geoBoundaries(g),{animate:!1}),D.getZoom()===d?(H=!!c.animate,c.onComplete?B.syncNodes(c.onComplete):B.syncNodes(),H=!1):c.onComplete&&c.onComplete(),setTimeout(function(){C.unbind("animate.end",b)},0)}var c=a||{},d=D.getZoom();return K?C.bind("animate.end",b):b(),B},this.zoomIn=function(){D.zoomIn()},this.zoomOut=function(){D.zoomOut()},this.bindDragListener=function(a){return z=z||a,z.bind("drop",n),B},this.unbindDragListener=function(){return z!==a?(z.unbind("drop",n),z=a,B):void 0},this.bindFilter=function(a){return A=a,k(),B},this.unbindFilter=function(){return A=a,B},this.resetDraggedNodesLatLng=function(){for(var b,c=C.graph.nodes(),d=0,e=c.length;e>d;d++)b=c[d],b.lat_init!==a&&b.lng_init!==a&&(b.lat=b.lat_init,b.lng=b.lng_init,b.lat_init=a,b.lng_init=a);return B},this.bindAll=function(){return N?void 0:(N=!0,s(),C.bind("coordinatesUpdated",B.syncMap),D.on("zoomstart",v).on("zoomend",w),C.bind("animate.start",l),C.bind("animate.end",l),B)},this.unbindAll=function(){return N?(N=!1,t(),C.unbind("coordinatesUpdated",B.syncMap),D.off("zoomstart",v).off("zoomend",w),C.unbind("animate.start",l),C.unbind("animate.end",l),B.unbindDragListener(),B.unbindFilter(),B):void 0},this.kill=function(){B.unbindAll(),x(),p(),M=!1,C=a,E=a,D=a,Q=a},this.utils={},this.utils.sigmaPointToLatLng=function(a){var b=D.project(D.getCenter());return D.unproject([a.x+b.x-C.camera.x,a.y+b.y-C.camera.y])},this.utils.latLngToSigmaPoint=function(a){var b=D.project(D.getCenter()),c=D.project(a);return{x:c.x-b.x+C.camera.x,y:c.y-b.y+C.camera.y}},this.utils.geoBoundaries=function(a){for(var b,d=1/0,e=1/0,f=-(1/0),g=-(1/0),h=0,i=a.length;i>h;h++)b=a[h],!b.hidden&&c(b)&&(f=Math.max(b.lat,f),d=Math.min(b.lat,d),g=Math.max(b.lng,g),e=Math.min(b.lng,e));return L.latLngBounds(L.latLng(d,e),L.latLng(f,g))}}if("undefined"==typeof sigma)throw new Error("sigma is not declared");"undefined"==typeof L&&console.warn("Include leaflet to use the leaflet plugin for sigma."),sigma.utils.pkg("sigma.plugins.leaflet");var e=new sigma.utils.map;sigma.classes.graph.attach("addNode","sigma.plugins.leaflet.addNode",function(a){c(a)&&e.set(a.id,this.nodesIndex.get(a.id))}),sigma.classes.graph.attachBefore("dropNode","sigma.plugins.leaflet.dropNode",function(a){e["delete"](a)}),sigma.classes.graph.attachBefore("clear","sigma.plugins.leaflet.clear",function(){e.clear(),e=new sigma.utils.map}),sigma.classes.graph.hasMethod("hasLatLngCoordinates")||sigma.classes.graph.addMethod("hasLatLngCoordinates",function(b){if(b!==a){var d=this.nodesIndex.get(b);if(d)return c(d)}return 0!=e.size});var f={zoomingRatio:.999999999,doubleClickZoomingRatio:.999999999,mouseZoomDuration:0,doubleClickZoomDuration:0,autoRescale:["nodeSize","edgeSize"],zoomOnLocation:!1,mouseInertiaDuration:0,mouseInertiaRatio:1,touchInertiaDuration:0,touchInertiaRatio:1},g=["click","mouseup","mouseover","mouseout","mousemove","focus","blur"],h={};sigma.plugins.leaflet=function(b,c,e){if(!b)throw new Error('Missing argument: "sigInst"');if(!c)throw new Error('Missing argument: "leafletMap"');return h[b.id]||(h[b.id]=new d(b,c,e),b.bind("kill",function(){h[b.id].kill(),h[b.id]=a})),h[b.id]},sigma.plugins.killLeafletPlugin=function(b){if(!b)throw new Error('Missing argument: "sigInst"');h[b.id]instanceof d&&(h[b.id].kill(),h[b.id]=a)}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw new Error("sigma not in scope.");sigma.utils.pkg("sigma.settings");var b={legendWidth:130,legendFontFamily:"Arial",legendFontSize:10,legendFontColor:"black",legendTitleFontFamily:"Arial",legendTitleFontSize:15,legendTitleFontColor:"black",legendTitleMaxLength:"30",legendTitleTextAlign:"left",legendShapeColor:"grey",legendBackgroundColor:"white",legendBorderColor:"black",legendBorderRadius:10,legendBorderWidth:1,legendInnerMargin:10,legendOuterMargin:5};sigma.settings=sigma.utils.extend(sigma.settings||{},b)}.call(this),function(a){"use strict";function b(a){var b=this,c=a.settings,e=window.devicePixelRatio||1;this._sigmaInstance=a,this._designPlugin=sigma.plugins.design(a),this._visualSettings={pixelRatio:e,legendWidth:c("legendWidth"),legendFontFamily:c("legendFontFamily"),legendFontSize:c("legendFontSize"),legendFontColor:c("legendFontColor"),legendTitleFontFamily:c("legendTitleFontFamily"),legendTitleFontSize:c("legendTitleFontSize"),legendTitleFontColor:c("legendTitleFontColor"),legendShapeColor:c("legendShapeColor"),legendBackgroundColor:c("legendBackgroundColor"),legendBorderColor:c("legendBorderColor"),legendBorderWidth:c("legendBorderWidth"),legendInnerMargin:c("legendInnerMargin"),legendOuterMargin:c("legendOuterMargin"),legendTitleMaxLength:c("legendTitleMaxLength"),legendTitleTextAlign:c("legendTitleTextAlign"),legendBorderRadius:c("legendBorderRadius")},h(this._visualSettings,function(a,c){"number"==typeof a&&(b._visualSettings[c]=a*e)}),k(this._visualSettings);var f=a.renderers[0];this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.pointerEvents="none",this._renderer=f,f.container.appendChild(this._canvas),window.addEventListener("resize",function(){d(b._canvas,f.container.offsetWidth,f.container.offsetHeight,e),m(b)}),this.textWidgetCounter=1,this.enoughSpace=!0,this.placement="bottom",this.visible=!0,this.widgets={},this.boundingBox={x:0,y:0,w:0,h:0},this.externalCSS=[],this.addWidget("node","size"),this.addWidget("node","color"),this.addWidget("node","icon"),this.addWidget("node","type"),this.addWidget("edge","size"),this.addWidget("edge","color"),this.addWidget("edge","type");var g=function(){f.container.offsetWidth?(d(this._canvas,f.container.offsetWidth,f.container.offsetHeight,e),this.draw()):setTimeout(g,200)}.bind(this);g()}function c(a,b,c,d,e,f){this._canvas=a,this._sigmaInstance=b,this._designPlugin=c,this._legendPlugin=d,this.visualVar=f,this.elementType=e,this.x=0,this.y=0,this.text="",this.unit=null,this.img=new Image,this.pinned=!1}function d(a,b,c,d){a.setAttribute("width",b*d),a.setAttribute("height",c*d),a.style.width=b+"px",a.style.height=c+"px"}function e(a,b){return null==b?null:b.split(".").reduce(function(a,b){return a[b]},a)}function f(a){var b=";base64,";if(-1==a.indexOf(b)){var c=a.split(","),d=c[0].split(":")[1],e=decodeURIComponent(c[1]);return new Blob([e],{type:d})}for(var c=a.split(b),d=c[0].split(":")[1],e=window.atob(c[1]),f=e.length,g=new Uint8Array(f),h=0;f>h;++h)g[h]=e.charCodeAt(h);return new Blob([g],{type:d})}function g(a,b,c){var d=null,e=null,g=null;if(window.Blob?(d=c?f(a):new Blob([a],{type:"text/xml"}),e=window.URL.createObjectURL(d)):g="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(a),navigator.msSaveBlob)navigator.msSaveBlob(d,b);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(d,b);else{var h=document.createElement("a");h.setAttribute("href",window.Blob?e:g),h.setAttribute("download",b),document.body.appendChild(h),h.click(),document.body.removeChild(h)}e&&setTimeout(function(){window.URL.revokeObjectURL(e)},0)}function h(b,c){for(var d in b)b.hasOwnProperty(d)&&b[d]!==a&&c(b[d],d)}function i(b,c,d,e,f){d=d||{};var g=document.createElement(c);for(var h in d)if(d.hasOwnProperty(h)){var i=d[h];i!==a&&g.setAttribute(h,i)}if(e!==a||f){"[object Object]"===Object.prototype.toString.call(e)&&(e=JSON.stringify(e));var j=document.createTextNode(e);g.appendChild(j)}return b.appendChild(g),g}function j(a,b){if(!a.svg)return void b();var c="";c+='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+a.svg.width+'px" height="'+a.svg.height+'px">',c+=a.svg.innerHTML+"</svg>";var d="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(c)));a.img.src!==d?(a.img.onload=b,a.img.src=d):b()}function k(a){a.totalWidgetWidth=a.legendWidth+2*(a.legendBorderWidth+a.legendOuterMargin)}function l(a,b){var c=0,d=Object.keys(a.widgets).length;h(a.widgets,function(a,e){x(a,function(){++c,b&&c===d&&b()})})}function m(a){var b=a._visualSettings,c=a.placement,d="top"===c||"bottom"===c,e=a._canvas.height,f=a._canvas.width,g=r(a.widgets,"text"),i=r(a.widgets,"node"),j=r(a.widgets,"edge"),k=[g,i,j],l=d?s(a.widgets)+2*b.legendOuterMargin:e,m=Math.floor(f/b.totalWidgetWidth),p=n(d?m:1,2*b.legendOuterMargin),q=0,t=!0,u=!1;if(0!==p.length){for(;t&&!u;)t=!1,q=0,h(k,function(a){var c,e,f=[];if(!t&&!u)for(a.forEach(function(a){f.push(a)});;){c=l-(p[q]?p[q].height:0),e=o(f,c),e.forEach(function(a){p[q].widgets.push(f[a]),p[q].height+=f[a].svg.height});for(var g=e.length-1;g>=0;--g)f.splice(e[g],1);if(!(f.length>0))break;if(d){if(q===m-1){p=n(m,2*b.legendOuterMargin),l+=30,t=!0;break}++q}else{if(p.length===m){u=!0;break}p.push({widgets:[],height:2*b.legendOuterMargin}),++q}}});if(u)a.boundingBox={x:0,y:0,w:0,h:0};else{"right"===c&&p.reverse();for(var w=0;w<p.length;++w)for(var x="bottom"===c?l-p[w].height:0,y=0;y<p[w].widgets.length;++y)p[w].widgets[y].x=b.totalWidgetWidth*w+("right"===c?f-p.length*b.totalWidgetWidth:b.legendOuterMargin),"bottom"===c?p[w].widgets[y].y=e-l+x+2*b.legendOuterMargin:p[w].widgets[y].y=x+b.legendOuterMargin,x+=p[w].widgets[y].svg.height;var z=p.reduce(function(a,c){return a+(c.height>2*b.legendOuterMargin?1:0)},0),A=z*(b.totalWidgetWidth+b.legendOuterMargin)+b.legendOuterMargin,B=p.reduce(function(a,b){return a>b.height?a:b.height},0);a.boundingBox={w:A,h:B,x:"right"===a.placement?f-A:0,y:"bottom"===a.placement?e-B:0}}v(a),a.enoughSpace=!u}}function n(a,b){for(var c=[],d=0;a>d;++d)c.push({widgets:[],height:b});return c}function o(a,b){var c={indexes:[],height:0},d=p(a.length,0);return d.forEach(function(d){var e=q(a,d);e>c.height&&b>=e&&(c.indexes=d,c.height=e)}),c.indexes}function p(a,b){if(b===a)return[];var c=[[b]],d=p(a,b+1);return d.forEach(function(a){c.push([b].concat(a))}),c=c.concat(d)}function q(a,b){var c=0;return b.forEach(function(b){c+=a[b].svg.height}),c}function r(a,b){var c=[];return h(a,function(a){a.svg&&!a.pinned&&a.elementType===b&&c.push(a)}),c}function s(a){var b=0;return h(a,function(a){a.svg&&a.svg.height>b&&(b=a.svg.height)}),b}function t(a,b){return a+"_"+b}function u(a){var b=a._canvas.getContext("2d");b.clearRect(0,0,a._canvas.width,a._canvas.height)}function v(a){u(a),h(a.widgets,function(b){w(a,b)&&B(b)})}function w(b,c){return b.visible&&(b.enoughSpace||c.pinned)&&b.widgets[c.id]!==a&&null!==c.svg}function x(a,b){var c=a._legendPlugin._visualSettings;if("size"===a.visualVar)a.svg=G(c,a._sigmaInstance.graph,a._designPlugin,a.elementType,a.unit);else if("text"!==a.elementType)a.svg=H(c,a._sigmaInstance.graph,a._designPlugin,a.elementType,a.visualVar,a.unit);else{var d=z(c,a.text,c.legendWidth-2*c.legendInnerMargin),e=c.legendFontSize+1,f=d.length*e+2*c.legendInnerMargin,g=c.legendInnerMargin+e;a.svg=document.createElement("svg"),L(a.svg,c,f);for(var h=0;h<d.length;++h)J(c,a.svg,d[h],c.legendInnerMargin,g),g+=e;a.svg.width=c.totalWidgetWidth,a.svg.height=f+2*(c.legendBorderWidth+c.legendOuterMargin)}j(a,b)}function y(a){x(a,function(){m(a._legendPlugin)})}function z(a,b,c){for(var d=!1,e=V(" ",a.legendFontFamily,a.legendFontSize,d),f=b.split(" "),g=[{width:-e,words:[]}],h=0,i=[],j=0;j<f.length;++j){var k=V(f[j]+" ",a.legendFontFamily,a.legendFontSize,d);g[h].width+k<=c?(g[h].words.push(f[j]+" "),g[h].width+=k):(g.push({width:k-e,words:[f[j]+" "]}),h++)}for(j=0;j<g.length;++j){for(var l="",m=0;m<g[j].words.length;++m)l+=g[j].words[m];i.push(l)}return i}function A(a){var b=a.split(".");return b.length>2&&"categories"===b[b.length-2]||b.length>=1&&"categories"===b[1]?"Category":T(b[b.length-1])}function B(a){if(a.img){var b=a._canvas.getContext("2d");b.drawImage(a.img,a.x,a.y),"node"===a.elementType&&"icon"===a.visualVar&&(b.textBaseline="middle",a.svg.icons.forEach(function(c){b.fillStyle=c.color,b.font=c.fontSize+"px "+c.font,b.fillText(c.content,a.x+c.x,a.y+c.y)}))}}function C(a,b){for(var c=null,d=null,f=1;f<a.length;++f){var g=e(a[f],b);"number"==typeof g&&((!c||c>g)&&(c=g),(!d||g>d)&&(d=g))}return{min:c?c:0,max:d?d:0}}function D(a,b){for(var c=[],d=a.max-a.min,e=0;b+1>e;++e)c.push(a.min+d*(e/b));return c}function E(a,b){for(var c={},d=0;d<a.length;++d){var f=e(a[d],b);f&&"object"==typeof f?h(f,function(a){c[a]=!0}):c[f]=!0}return c}function F(a,b){var c=0;return h(a,function(a,d){b[d]&&++c}),c}function G(a,b,c,d,e){var f=a,g=document.createElement("svg"),h="node"===d?b.nodes():b.edges(),i="node"===d?c.styles.nodes:c.styles.edges,j=f.legendTitleFontSize+f.legendInnerMargin+1.5*f.legendFontSize;if(!i.size)return null;var k,l=i.size.by,m=C(h,l),n=m.min,o=m.max,p=n%1===0&&o%1===0,q=p?Math.round((n+o)/2):(n+o)/2,r=i.size.max/i.size.min,s=1.5*f.legendFontSize,t=s/r,u=(s+t)/2;
if("node"===d){var v=2;k=j+2*s+10,L(g,f,k),S(f,g,A(i.size.by),e);var w=2*s+v+2*f.legendInnerMargin;J(f,g,W(o,p),w,j+f.legendFontSize),J(f,g,W(q,p),w,j+2*f.legendFontSize),J(f,g,W(n,p),w,j+3*f.legendFontSize),K(g,s+f.legendInnerMargin,j+s,s,f.legendBackgroundColor,f.legendShapeColor,v),K(g,s+f.legendInnerMargin,j+2*s-u,u,f.legendBackgroundColor,f.legendShapeColor,v),K(g,s+f.legendInnerMargin,j+2*s-t,t,f.legendBackgroundColor,f.legendShapeColor,v)}else if("edge"===d){var x=j+1.7*s,y=(f.legendWidth-2*f.legendInnerMargin)/3;k=x+f.legendFontSize,L(g,f,k),S(f,g,A(i.size.by),e),R(g,"rect",{x:f.legendInnerMargin,y:j+5,width:y,height:s/2,fill:f.legendShapeColor}),R(g,"rect",{x:f.legendInnerMargin+y,y:j+5+(s-u)/4,width:y,height:u/2,fill:f.legendShapeColor}),R(g,"rect",{x:f.legendInnerMargin+2*y,y:j+5+(s-t)/4,width:y,height:t/2,fill:f.legendShapeColor}),J(f,g,W(o,p),f.legendInnerMargin+.5*y,x,"middle"),J(f,g,W(q,p),f.legendInnerMargin+1.5*y,x,"middle"),J(f,g,W(n,p),f.legendInnerMargin+2.5*y,x,"middle")}return g.width=f.totalWidgetWidth,g.height=k+2*(f.legendBorderWidth+f.legendOuterMargin),g}function H(a,b,c,d,f,g){var i=a,j=document.createElement("svg"),k="node"===d?b.nodes():b.edges(),l="node"===d?c.styles.nodes:c.styles.edges;if(!l[f])return null;var m,n,o,p,q,r=c.palette,s=1.5*i.legendFontSize,t=i.legendTitleFontSize+i.legendInnerMargin+.8*s,u="color"===f&&l.color.bins,v="edge"===d&&"type"===f,w=u?e(r,l.color.scheme)[l.color.bins]:e(r,l[f].scheme),x=E(k,l[f].by),y=u?Object.keys(w).length:F(w,x),z=s*y+t+(v?s:0),B=i.legendWidth/3,G=t,H="edge"===d?B:1.5*i.legendFontSize+i.legendInnerMargin;return u&&(m=C(k,l.color.by),n=D(m,l.color.bins),o=m.min%1==0&&m.max%1==0),j.icons=[],L(j,i,z),S(i,j,A(l[f].by),g),"edge"===d&&"type"===f&&(p="source node to target node",q=U(p,i.legendFontFamily,i.legendFontSize,i.legendWidth-2*i.legendInnerMargin),J(i,j,p,i.legendInnerMargin,G,"left",i.legendFontColor,i.legendFontFamily,q),G+=s),h(w,function(a,b){if(u||x[b]){"color"===f?(u&&(a=w[w.length-b-1]),"edge"===d?R(j,"rect",{x:i.legendInnerMargin,y:G-s/8,width:B-2*i.legendInnerMargin,height:s/4,fill:a}):K(j,i.legendInnerMargin+i.legendFontSize/2,G,i.legendFontSize/2,a)):"icon"===f?j.icons.push({content:a.content,font:a.font,fontSize:i.legendFontSize,color:i.legendFontColor,x:i.legendInnerMargin,y:G}):"type"===f&&("edge"===d?M(i,j,a,i.legendInnerMargin,B-i.legendInnerMargin,G,i.legendFontSize/3):O(i,j,a,i.legendInnerMargin+i.legendFontSize/2,G,i.legendFontSize/2));var c=2;if(u)p=W(n[y-b-1],o)+" - "+W(n[y-parseInt(b)],o),J(i,j,p,B,G+c,"left",null,null,null,"middle");else{var e=I(T(b),i.legendWidth-i.legendInnerMargin-H,i.legendFontFamily,i.legendFontSize);J(i,j,e,H,G+c,"left",null,null,null,"middle")}G+=s}}),j.width=i.totalWidgetWidth,j.height=z+2*(i.legendBorderWidth+i.legendOuterMargin),j}function I(a,b,c,d){for(var e=V(a,c,d,!1),f=!1;e>b;){f=!0;var g=b/e,a=a.substr(0,a.length*g);e=V(a,c,d,!1)}return f&&(a+="..."),a}function J(a,b,c,d,e,f,g,h,j,k){i(b,"text",{x:d,y:e,"text-anchor":f?f:"left",fill:g?g:a.legendFontColor,"font-size":j?j:a.legendFontSize,"font-family":h?h:a.legendFontFamily,"alignment-baseline":k?k:"auto"},c)}function K(a,b,c,d,e,f,g){i(a,"circle",{cx:b,cy:c,r:d,fill:e,stroke:f,"stroke-width":g})}function L(a,b,c){R(a,"rect",{x:b.legendBorderWidth,y:b.legendBorderWidth,width:b.legendWidth,height:c,stroke:b.legendBorderColor,"stroke-width":b.legendBorderWidth,fill:b.legendBackgroundColor,rx:b.legendBorderRadius,ry:b.legendBorderRadius})}function M(a,b,c,d,e,f,g){var h=2.5*g,i=3*g,j=Math.sqrt(3)/2*h;if("arrow"===c)Q(b,d,f,e-j+1,f,a.legendShapeColor,g),P(b,[e,f,e-j,f-h/2,e-j,f+h/2],a.legendShapeColor);else if("parallel"===c)g*=.8,Q(b,d,f-g,e,f-g,a.legendShapeColor,g),Q(b,d,f+g,e,f+g,a.legendShapeColor,g);else if("curve"===c)N(b,d,f,(d+e)/2,f-i,e,f,a.legendShapeColor,g);else if("curvedArrow"===c){var k,l=e-d;k=40>l?35:60>l?33:30,N(b,d,f,(d+e)/2,f-i,e-h/2,f-g,a.legendShapeColor,g),P(b,[e,f,e-j,f-h/2,e-j,f+h/2],a.legendShapeColor,{angle:k,cx:e,cy:f})}else if("dashed"===c){var m="8 3";Q(b,d,f,e,f,a.legendShapeColor,g,m)}else if("dotted"===c){var n="2";Q(b,d,f,e,f,a.legendShapeColor,g,n)}else"tapered"===c&&P(b,[d,f+g,d,f-g,e,f],a.legendShapeColor)}function N(a,b,c,d,e,f,g,h,j){var k="M "+b+" "+c+" Q "+d+" "+e+" "+f+" "+g;i(a,"path",{d:k,stroke:h,"stroke-width":j,fill:"none"})}function O(a,b,c,d,e,f){var g,h=[];if("diamond"===c)f*=1.3,h=[d-f,e,d,e-f,d+f,e,d,e+f];else if("star"===c){f*=1.7,g=-Math.PI/2;for(var i=0;5>i;++i)h[2*i]=Math.cos(g),h[2*i+1]=Math.sin(g),g+=4*Math.PI/5}else if("equilateral"===c){f*=1.3;var j=5;g=-Math.PI/2;for(var i=0;j>i;++i)h[2*i]=Math.cos(g),h[2*i+1]=Math.sin(g),g+=2*Math.PI/j}else"square"===c&&(h=[d-f,e-f,d+f,e-f,d+f,e+f,d-f,e+f]);if("star"===c||"equilateral"===c)for(var i=0;i<h.length;i+=2)h[i]=d+h[i]*f,h[i+1]=e+h[i+1]*f;if("cross"!==c)P(b,h,a.legendShapeColor);else{f*=1.2;var k=2*window.devicePixelRatio;Q(b,d-f,e,d+f,e,a.legendShapeColor,k),Q(b,d,e-f,d,e+f,a.legendShapeColor,k)}}function P(a,b,c,d){for(var e=b[0]+","+b[1],f=2;f<b.length;f+=2)e+=" "+b[f]+","+b[f+1];var g={points:e,fill:c};d&&(g.transform="rotate("+d.angle+", "+d.cx+", "+d.cy+")"),i(a,"polygon",g)}function Q(a,b,c,d,e,f,g,h){i(a,"line",{x1:b,y1:c,x2:d,y2:e,stroke:f,"stroke-width":g,"stroke-dasharray":h})}function R(a,b,c){i(a,b,c)}function S(a,b,c,d){var e=(c.length>a.legendTitleMaxLength?c.substring(0,a.legendTitleMaxLength):c)+(d?" ("+d+")":""),f=U(e,a.legendTitleFontFamily,a.legendTitleFontSize,a.legendWidth-a.legendInnerMargin),g="middle"===a.legendTitleTextAlign?a.legendWidth/2:a.legendInnerMargin;J(a,b,e,g,a.legendFontSize+a.legendInnerMargin,a.legendTitleTextAlign,a.legendTitleFontColor,a.legendTitleFontFamily,f)}function T(a){return a.charAt(0).toUpperCase()+a.slice(1).replace(/_/g," ")}function U(a,b,c,d){for(;V(a,b,c,!1)>d;)c-=c>15?2:1;return c}function V(a,b,c,d){return d?.45*c*a.length:(X.font=c+"px "+b,X.measureText(a).width)}function W(a,b){var c=["K","M","G","T","P","E","Z","Y"];if(a>9999){for(var d=0;d<c.length&&a>999;)a/=1e3,++d;return Math.ceil(a)+c[d-1]}return b?Math.round(a).toString():10>a?(Math.round(1e3*a)/1e3).toString():100>a?(Math.round(100*a)/100).toString():1e3>a?(Math.round(10*a)/10).toString():Math.round(a).toString()}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var X=document.createElement("canvas").getContext("2d"),Y={};sigma.plugins.legend=function(a){return Y[a.id]||(Y[a.id]=new b(a),a.bind("kill",function(){sigma.plugins.killLegend(a)})),Y[a.id]},sigma.plugins.killLegend=function(b){var c=Y[b.id];c&&(h(c.widgets,function(b,d){c.widgets[d]=a}),Y[b.id]=a)},b.prototype.draw=function(a){var b=this;l(this,function(){m(b),a&&a()})},b.prototype.setVisibility=function(a){this.visible=a,m(this)},b.prototype.setPlacement=function(a){-1!==["top","bottom","right","left"].indexOf(a)&&(this.placement=a,m(this))},b.prototype.addWidget=function(a,b,d){var e=this.widgets[t(a,b)];return e||(e=new c(this._canvas,this._sigmaInstance,this._designPlugin,this,a,b),e.id=t(a,b),this.widgets[e.id]=e),e.unit=d,y(e),e},b.prototype.getWidget=function(a,b){return this.widgets[t(a,b)]},b.prototype.addTextWidget=function(a){var b=new c(this._canvas,this._sigmaInstance,this._designPlugin,this,"text");return b.text=a,b.id="text"+this.textWidgetCounter++,this.widgets[b.id]=b,y(b),b},b.prototype.removeWidget=function(b,d){var e=b instanceof c?b.id:t(b,d);this.widgets[e]&&(this.widgets[e]=a,m(this))},b.prototype.removeAllWidgets=function(){this.widgets={},m(this)},c.prototype.unpin=function(){this.pinned=!1,m(this._legendPlugin)},c.prototype.setPosition=function(a,b){this.pinned=!0,this.x=a,this.y=b,m(this._legendPlugin)},c.prototype.setText=function(a){this.text=a,y(this)},c.prototype.setUnit=function(a){this.unit=a,y(this)},b.prototype.setExternalCSS=function(a){this.externalCSS=a},b.prototype.exportPng=function(a){var b=this.visible,c=this;c.visible=!0,c.draw(function(){var d=document.createElement("canvas"),e=d.getContext("2d"),f=c.boundingBox;d.width=f.w,d.height=f.h,e.drawImage(c._canvas,f.x,f.y,f.w,f.h,0,0,f.w,f.h),c.setVisibility(b),g(d.toDataURL(),a?a:"legend.png",!0)})},b.prototype.exportSvg=function(a){var b=this;this.draw(function(){var c=b._visualSettings,d=b.boundingBox,e="";(b.externalCSS||[]).forEach(function(a){e+='<?xml-stylesheet type="text/css" href="'+a+'" ?>\n'}),e+='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+d.w+'px" height="'+d.h+'px">',h(b.widgets,function(a){if(null!==a.svg){if(e+='<g transform="translate('+(a.x+-d.x)+" "+(a.y-d.y)+')">',e+=a.svg.innerHTML,"icon"===a.visualVar){var b=document.createElement("svg");a.svg.icons.forEach(function(a){J(c,b,a.content,a.x,a.y,"left",c.legendFontColor,a.font,c.legendFontSize,"central")}),e+=b.innerHTML}e+="</g>"}}),e+="</svg>",g(e,a?a:"legend.svg")})}}.call(this),function(a){"use strict";function b(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():d.requestFullscreen?d.requestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.webkitRequestFullscreen&&d.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function c(a){var c=a||{};d=c.container?"object"==typeof c.container?c.container:document.getElementById(c.container):this.container,e=null,c.btnId?(e=document.getElementById(c.btnId),e.removeEventListener("click",b),e.addEventListener("click",b)):b()}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins.fullScreen");var d=null,e=null;sigma.plugins.fullScreen=c}.call(this),function(a){"use strict";function b(a,b,d){function e(b){var c=Math.max(a.settings("zoomMin"),Math.min(a.settings("zoomMax"),a.camera.ratio*(b.ratio||1)));sigma.misc.animation.camera(a.camera,{x:a.camera.x+(b.x||0),y:a.camera.y+(b.y||0),ratio:c},{duration:b.duration})}function f(){e({x:-d.displacement,duration:d.duration})}function g(){e({y:-d.displacement,duration:d.duration})}function h(){e({x:d.displacement,duration:d.duration})}function i(){e({y:d.displacement,duration:d.duration})}function j(){e({ratio:1/d.zoomingRatio,duration:d.duration})}function k(){e({ratio:d.zoomingRatio,duration:d.duration})}function l(){n.domElt.addEventListener("keydown",n.keyDown),n.domElt.addEventListener("keyup",n.keyUp),n.bind("37 18+37",f),n.bind("38 18+38",g),n.bind("39 18+39",h),n.bind("40 18+40",i),n.bind("32+38 18+32+38",j),n.bind("32+40 18+32+40",k)}function m(){n.domElt.removeEventListener("keydown",n.keyDown),n.domElt.removeEventListener("keyup",n.keyUp),n.unbind()}d=sigma.utils.extend(d,c),d.zoomingRatio=d.zoomingRatio||a.settings("zoomingRatio"),d.duration=d.duration||a.settings("mouseZoomDuration"),this.domElt=b.container,this.keys={},this.currentEvents=null;var n=this;sigma.classes.dispatcher.extend(this),this.domElt.tabIndex=d.tabIndex,this.keyDown=function(a){9===a.which||18===a.which||20===a.which||n.keys[a.which]||(n.keys[a.which]=!0,n.currentEvents=Object.keys(n.keys).join("+"),n.dispatchEvent(n.currentEvents))},this.keyUp=function(a){delete n.keys[a.which],n.currentEvents=null},this.focus=function(a){return n.domElt.focus(),!0},this.blur=function(a){return n.domElt.blur(),n.keys={},n.currentEvents=null,!0},this.kill=function(){m(),n.domElt=null,n.keys={},n.currentEvents=null},l()}if("undefined"==typeof sigma)throw"sigma.plugins.keyboard: sigma is not declared";sigma.utils.pkg("sigma.plugins");var c={displacement:100,duration:200,zoomingRatio:1.7,tabIndex:-1},d={};sigma.plugins.keyboard=function(a,c,e){return d[a.id]||(d[a.id]=new b(a,c,e),a.bind("kill",function(){sigma.plugins.killKeyboard(a)})),d[a.id]},sigma.plugins.killKeyboard=function(a){d[a.id]instanceof b&&(d[a.id].kill(),delete d[a.id])}}.call(this),function(){"use strict";function a(a){var b=a.settings("autoRescale");return b?Array.isArray(b)?-1!==b.indexOf("nodePosition"):!0:!1}function b(a,b){var c,d,e=-(1/0),f=1/0,g=1/0,h=-(1/0),i=-(1/0);for(c=0,d=a.length;d>c;c++)e=Math.max(a[c][b+"size"],e),h=Math.max(a[c][b+"x"],h),f=Math.min(a[c][b+"x"],f),i=Math.max(a[c][b+"y"],i),g=Math.min(a[c][b+"y"],g);return e=e||1,{sizeMax:e,minX:f,minY:g,maxX:h,maxY:i}}function c(c,e){function f(b){var c,d,e,f,h,i,j;if(c=.5*(b.minX+b.maxX),d=.5*(b.minY+b.maxY),a(g.s)){var k,l,m,n,o;o=g.s.camera.getRectangle(b.maxX-b.minX,b.maxY-b.minY),f=o.x2-o.x1||1,h=o.height||1,k=sigma.utils.getBoundaries(g.s.graph,g.s.camera.readPrefix),l=g.s.camera.getRectangle(k.maxX-k.minX,k.maxY-k.minY),m=l.x2-l.x1||1,n=l.height||1,i=m-g.settings.padding.left-g.settings.padding.right,j=n-g.settings.padding.top-g.settings.padding.bottom,e=Math.max(f/i,h/j)}else f=b.maxX-b.minX+2*b.sizeMax,h=b.maxY-b.minY+2*b.sizeMax,i=g.s.renderers[0].width-g.settings.padding.left-g.settings.padding.right,j=g.s.renderers[0].height-g.settings.padding.top-g.settings.padding.bottom,e=Math.max(f/i,h/j);return e=Math.max(g.s.settings("zoomMin"),Math.min(g.s.settings("zoomMax"),e)),c+=(g.settings.padding.right-g.settings.padding.left)*e*.5,d+=(g.settings.padding.bottom-g.settings.padding.top)*e*.5,{x:c,y:d,ratio:e}}var g=this;this.s=c,this.settings=sigma.utils.extend(e,d),this.settings.zoomDef=this.settings.zoomDef||this.s.settings("zoomMax"),this.s.bind("kill",function(){sigma.plugins.killLocate(g.s)}),this.nodes=function(d,e){if(arguments.length<1)throw new TypeError("Too few arguments.");if(3===arguments.length&&"object"!=typeof e)throw new TypeError('Invalid argument: "options" is not an object, was '+e);var h,i,j=sigma.utils.extend(e,g.settings.animation.node),k=(g.s.camera.ratio,a(g.s));if("string"==typeof d||"number"==typeof d){if(i=g.s.graph.nodes(d),void 0===i)throw new Error('Invalid argument: the node of id "'+d+'" does not exist.');h={x:i[g.s.camera.readPrefix+"x"],y:i[g.s.camera.readPrefix+"y"],ratio:k?g.s.settings("zoomMin"):g.settings.zoomDef}}else{if(!Array.isArray(d))throw new TypeError('Invalid argument: "v" is not a string, a number, or an array, was '+d);var l=b(d.map(function(a){return g.s.graph.nodes(a)}),g.s.camera.readPrefix);h=f(l)}return g.settings.focusOut&&k?sigma.misc.animation.camera(c.camera,{x:.5*(g.s.camera.x+h.x),y:.5*(g.s.camera.y+h.y),ratio:g.settings.zoomDef},{duration:j.duration,onComplete:function(){sigma.misc.animation.camera(g.s.camera,h,j)}}):sigma.misc.animation.camera(g.s.camera,h,j),g},this.edges=function(d,e){if(arguments.length<1)throw new TypeError("Too few arguments.");if(3===arguments.length&&"object"!=typeof e)throw new TypeError('Invalid argument: "options" is not an object, was '+e);var h,i,j,k=sigma.utils.extend(e,g.settings.animation.edge),l=(g.s.camera.ratio,a(g.s));if("string"==typeof d||"number"==typeof d){if(i=g.s.graph.edges(d),void 0===i)throw new Error('Invalid argument: the edge of id "'+d+'" does not exist.');j=b([g.s.graph.nodes(i.source),g.s.graph.nodes(i.target)],g.s.camera.readPrefix),h=f(j)}else{if(!Array.isArray(d))throw new TypeError('Invalid argument: "v" is not a string or a number, or an array, was '+d);var m,n,o=[];for(m=0,n=d.length;n>m;m++)i=g.s.graph.edges(d[m]),o.push(g.s.graph.nodes(i.source)),o.push(g.s.graph.nodes(i.target));j=b(o,g.s.camera.readPrefix),h=f(j)}return g.settings.focusOut&&l?sigma.misc.animation.camera(c.camera,{x:.5*(g.s.camera.x+h.x),y:.5*(g.s.camera.y+h.y),ratio:g.settings.zoomDef},{duration:k.duration,onComplete:function(){sigma.misc.animation.camera(g.s.camera,h,k)}}):sigma.misc.animation.camera(g.s.camera,h,k),g},this.center=function(a,b){var c=sigma.utils.extend(b,g.settings.animation.center);return g.s.graph.nodes().length?g.nodes(g.s.graph.nodes().map(function(a){return a.id}),c):sigma.misc.animation.camera(g.s.camera,{x:0,y:0,ratio:a},c),g},this.setPadding=function(a){return g.settings.padding=sigma.utils.extend(a,g.settings.padding),g},this.kill=function(){g.settings=null,g.s=null}}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var d={animation:{node:{duration:300},edge:{duration:300},center:{duration:300}},padding:{top:0,right:0,bottom:0,left:0},focusOut:!1,zoomDef:null},e={};sigma.plugins.locate=function(a,b){return e[a.id]||(e[a.id]=new c(a,b)),e[a.id]},sigma.plugins.killLocate=function(a){e[a.id]instanceof c&&e[a.id].kill(),delete e[a.id]}}.call(window),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma.plugins.poweredBy: sigma not in scope.";sigma.utils.pkg("sigma.settings");var b={poweredByHTML:"Linkurious.js",poweredByURL:"https://github.com/Linkurious/linkurious.js",poweredByPingURL:""};sigma.settings=sigma.utils.extend(sigma.settings||{},b)}.call(this),function(a){function b(a){a=a||{};var b,c=a.html||this.settings("poweredByHTML"),d=a.url||this.settings("poweredByURL"),e=a.pingURL||this.settings("poweredByPingURL");if(!document.getElementsByClassName("sigma-poweredby").length){if(b=d?['<a href="'+d+'" target="_blank" style="font-family:\'Helvetica Neue\',Arial,Helvetica,sans-serif; font-size:11px">'+c+"</a>"]:[c],e){var f=new Image;f.src=e}var g=document.createElement("div");g.setAttribute("class","sigma-poweredby"),g.innerHTML=b.join(""),g.style.position="absolute",g.style.padding="0 5px",g.style.bottom="2px",g.style.right="1px",g.style.zIndex="1000",g.style.background="rgba(255, 255, 255, 0.7)",this.container.appendChild(g)}}sigma.renderers.canvas.prototype.poweredBy=b,sigma.renderers.webgl.prototype.poweredBy=b}.call(this),function(a){"use strict";function b(a){h=32===a.which,f.removeEventListener("keydown",b,!1),f.addEventListener("keyup",c,!1)}function c(a){h=!1,f.addEventListener("keydown",b,!1),f.removeEventListener("keyup",c,!1)}function d(c,d,e){function j(){d.dropEdges(),d.nbNodes()===c.graph.nodes().length?d.dropNodes():d.addNodes(),c.refresh({skipIndexation:!0})}function k(){v++}function l(){v=0,u.container.lastChild.addEventListener("mousemove",k)}function m(){setTimeout(function(){v=0;var a=d.nodes()[0];a&&null===g&&(g=a.id)},1),u.container.lastChild.removeEventListener("mousemove",k)}function n(){d.dropEdges(),d.dropNodes(),c.refresh({skipIndexation:!0})}function o(){var a=d.nodes().map(function(a){return a.id}),b=d.edges().map(function(a){return a.id});d.dropEdges(b),d.dropNodes(a),a.length==c.graph.nodes().length?c.graph.clear():(c.graph.dropEdges(b),c.graph.dropNodes(a)),c.refresh()}function p(){d.addNeighbors(),c.refresh({skipIndexation:!0})}function q(){d.dropEdges(),d.setNodesBy(function(a){return 0===c.graph.degree(a.id)}),c.refresh({skipIndexation:!0})}function r(){d.dropEdges(),d.setNodesBy(function(a){return 1===c.graph.adjacentNodes(a.id).length}),c.refresh({skipIndexation:!0})}function s(a){var b=a.data;b.length?(d.dropEdges(),d.addNodes(b.map(function(a){return a.id})),g=d.nodes()[0].id):(d.dropNodes(),g=null)}var t=this,u=e||c.renderers[0],v=0,w=null,x=null;f=f||document.getElementsByTagName("body")[0],u.container.lastChild.addEventListener("mousedown",l),u.container.lastChild.addEventListener("mouseup",m),this.init=function(){d.nbNodes()&&(g=d.nodes()[0].id)},this.clickNodesHandler=function(b){if(!(v>1)){var e=b.data.node[0].id,f=d.nodes().map(function(a){return a.id}),j=f.indexOf(e)>-1?a:e;if(d.dropEdges(),h){var k=j===e?a:e;d.dropNodes(k),c.refresh({skipIndexation:!0})}else{f.length>1&&d.addNodes(e);var l=d.nodes()[0];null!=l?g===l.id?null!=j?(d.dropNodes(),g=null):setTimeout(function(){i||(d.dropNodes(),g=null,c.refresh({skipIndexation:!0}))},c.settings("doubleClickTimeout")):g=l.id:g=j}null!=j&&(d.addNodes(j),c.refresh({skipIndexation:!0}))}},this.doubleClickNodesHandler=function(a){i=!0,setTimeout(function(){i=!1},100+c.settings("doubleClickTimeout"))},this.clickEdgesHandler=function(b){if(!(v>1)){var e=b.data.edge[0].id,f=d.edges().map(function(a){return a.id}),i=f.indexOf(e)>-1?a:e;if(d.dropNodes(),g=null,h){var j=i===e?a:e;d.dropEdges(j),c.refresh({skipIndexation:!0})}else d.dropEdges();null!=i&&(d.addEdges(i),c.refresh({skipIndexation:!0}))}},c.bind("clickNodes",this.clickNodesHandler),c.bind("doubleClickNodes",this.doubleClickNodesHandler),c.bind("clickEdges",this.clickEdgesHandler),f.addEventListener("keydown",b,!1),this.bindKeyboard=function(a){if(!a)throw new Error('Missing argument: "keyboard"');return w=a,w.bind("32+65 18+32+65",j),w.bind("32+85 18+32+85",n),w.bind("32+46 18+32+46",o),w.bind("32+69 18+32+69",p),w.bind("32+73 18+32+73",q),w.bind("32+76 18+32+76",r),this},this.unbindKeyboard=function(){return w&&(w.unbind("32+65 18+32+65",j),w.unbind("32+85 18+32+85",n),w.unbind("32+46 18+32+46",o),w.unbind("32+69 18+32+69",p),w.unbind("32+73 18+32+73",q),w.unbind("32+76 18+32+76",r),w=null),this},this.bindLasso=function(a){if(!a)throw new Error('Missing argument: "lassoInstance"');x=a,x.bind("selectedNodes",s)},this.unbindLasso=function(){x&&x.unbind("selectedNodes",s)},this.clear=function(){c.unbind("clickNodes",t.clickNodesHandler),c.unbind("doubleClickNodes",t.doubleClickNodesHandler),c.unbind("clickEdges",t.clickEdgesHandler),t.unbindKeyboard(),t.unbindLasso(),u.container.lastChild.removeEventListener("mousedown",l),u.container.lastChild.removeEventListener("mouseup",m),u.container.lastChild.removeEventListener("mousemove",k),u=null,w=null}}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var e={},f=null,g=null,h=!1,i=!1;sigma.plugins.select=function(a,b,c){return e[a.id]||(e[a.id]=new d(a,b),a.bind("kill",function(){sigma.plugins.killSelect(a)})),e[a.id]},sigma.plugins.killSelect=function(a){e[a.id]instanceof d&&(e[a.id].clear(),delete e[a.id]),!e.length&&f&&(f.removeEventListener("keydown",b,!1),f.removeEventListener("keyup",c,!1),f=null)}}.call(this),function(){"use strict";function a(a,c,d){function e(a){a.preventDefault()}function f(){i&&i.parentNode&&(i.parentNode.removeChild(i),i=null)}function g(){clearTimeout(j),clearTimeout(k),j=!1,k=!1,f()}function h(a){clearTimeout(j),clearTimeout(k),j=!1,k=setTimeout(function(){p||f()},a)}var i,j,k,l=this,m=[],n=[],o=[],p=!1,q=!1;if(Array.isArray(d.stage))for(var r=0;r<d.stage.length;r++)m.push(sigma.utils.extend(d.stage[r],b.stage));else m.push(sigma.utils.extend(d.stage,b.stage));if(Array.isArray(d.node))for(var r=0;r<d.node.length;r++)n.push(sigma.utils.extend(d.node[r],b.node));else n.push(sigma.utils.extend(d.node,b.node));if(Array.isArray(d.edge))for(var r=0;r<d.edge.length;r++)o.push(sigma.utils.extend(d.edge[r],b.edge));else o.push(sigma.utils.extend(d.edge,b.edge));if(sigma.classes.dispatcher.extend(this),a.bind("kill",function(){sigma.plugins.killTooltips(a)}),this.open=function(b,d,e,g,h){if(f(),i=document.createElement("div"),d.renderer){var j,k,l,m=Object.create(null);for(l in b)m[l]=b[l];if(j=d.renderer.call(a.graph,m,d.template),k=typeof j,"undefined"===k)return;"string"===k?i.innerHTML=j:i.appendChild(j)}else i.innerHTML=d.template;var n=window.getComputedStyle(c.container).position;if("static"!==n){i.style.position="absolute";var o=c.container.getBoundingClientRect();e=~~(e-o.left),g=~~(g-o.top)}i.className=d.cssClass,"css"!==d.position&&("static"===n&&(i.style.position="absolute"),i.style.left=e+"px",i.style.top=g+"px"),i.addEventListener("mouseenter",function(){p=!0},!1),i.addEventListener("mouseleave",function(){p=!1},!1),setTimeout(function(){if(i){c.container.appendChild(i);var a=document.body.getBoundingClientRect(),b=i.getBoundingClientRect(),f=b.top-a.top,j=a.bottom-b.bottom,k=b.left-a.left,l=a.right-b.right;"top"===d.position?(i.className=d.cssClass+" top",i.style.left=e-b.width/2+"px",i.style.top=g-b.height+"px"):"bottom"===d.position?(i.className=d.cssClass+" bottom",i.style.left=e-b.width/2+"px",i.style.top=g+"px"):"left"===d.position?(i.className=d.cssClass+" left",i.style.left=e-b.width+"px",i.style.top=g-b.height/2+"px"):"right"===d.position&&(i.className=d.cssClass+" right",i.style.left=e+"px",i.style.top=g-b.height/2+"px"),d.autoadjust&&(b=i.getBoundingClientRect(),f=b.top-a.top,j=a.bottom-b.bottom,k=b.left-a.left,l=a.right-b.right,0>j?(i.className=d.cssClass,"top"!==d.position&&"bottom"!==d.position||(i.className=d.cssClass+" top"),i.style.top=g-b.height+"px"):0>f&&(i.className=d.cssClass,"top"!==d.position&&"bottom"!==d.position||(i.className=d.cssClass+" bottom"),i.style.top=g+"px"),0>l?(i.className=d.cssClass,"left"!==d.position&&"right"!==d.position||(i.className=d.cssClass+" left"),i.style.left=e-b.width+"px"):0>k&&(i.className=d.cssClass,"left"!==d.position&&"right"!==d.position||(i.className=d.cssClass+" right"),i.style.left=e+"px")),h&&h()}},0)},this.close=function(){return g(),this.dispatchEvent("hidden"),this},this.kill=function(){this.unbindEvents(),clearTimeout(j),clearTimeout(k),i=null,j=null,k=null,q=!1,m=[],n=[],o=[]},this.unbindEvents=function(){for(var b=m.concat(n).concat(o),d=0;d<b.length;d++)a.unbind(b[d].show),a.unbind(b[d].hide),"rightClickNode"!==b[d].show&&"rightClickEdge"!==b[d].show||c.container.removeEventListener("contextmenu",e);a.unbind("doubleClickStage"),a.unbind("doubleClickNode"),a.unbind("doubleClickEdge")},this.bindStageEvents=function(c){a.bind(c.show,function(a){if("doubleClickStage"===c.show||!q){var b=a.data.captor.clientX,d=a.data.captor.clientY;clearTimeout(j),j=setTimeout(function(){l.open(null,c,b,d,l.dispatchEvent.bind(l,"shown",a.data))},c.delay)}}),a.bind(c.hide,function(a){var c=i;h(b.stage.hideDelay),c&&l.dispatchEvent("hidden",a.data)})},this.bindNodeEvents=function(c){a.bind(c.show,function(a){if("doubleClickNode"===c.show||!q){var b=a.data.node;if(!b&&a.data.enter&&(b=a.data.enter.nodes[0]),void 0!=b){var d=a.data.captor.clientX,e=a.data.captor.clientY;clearTimeout(j),j=setTimeout(function(){l.open(b,c,d,e,l.dispatchEvent.bind(l,"shown",a.data))},c.delay)}}}),a.bind(c.hide,function(a){if(!a.data.leave||0!=a.data.leave.nodes.length){var c=i;h(b.node.hideDelay),c&&l.dispatchEvent("hidden",a.data)}})},this.bindEdgeEvents=function(c){a.bind(c.show,function(a){if("doubleClickEdge"===c.show||!q){var b=a.data.edge;if(!b&&a.data.enter&&(b=a.data.enter.edges[0]),void 0!=b){var d=a.data.captor.clientX,e=a.data.captor.clientY;clearTimeout(j),j=setTimeout(function(){l.open(b,c,d,e,l.dispatchEvent.bind(l,"shown",a.data))},c.delay)}}}),a.bind(c.hide,function(a){if(!a.data.leave||0!=a.data.leave.edges.length){var c=i;h(b.edge.hideDelay),c&&l.dispatchEvent("hidden",a.data)}})},d.stage){for(var s=!1,r=0;r<m.length;r++){if(null!==m[r].renderer&&"function"!=typeof m[r].renderer)throw new TypeError('"options.stage.renderer" is not a function, was '+m[r].renderer);if(void 0!==m[r].position&&"top"!==m[r].position&&"bottom"!==m[r].position&&"left"!==m[r].position&&"right"!==m[r].position&&"css"!==m[r].position)throw new Error('"options.position" is not "top", "bottom", "left", "right", or "css", was '+m[r].position);"doubleClickStage"===m[r].show&&(s=!0)}for(var r=0;r<m.length;r++)this.bindStageEvents(m[r]);s||a.bind("doubleClickStage",function(a){g(),q=!0,l.dispatchEvent("hidden",a.data),setTimeout(function(){q=!1},b.doubleClickDelay)})}if(d.node){for(var t=!1,u=!1,r=0;r<n.length;r++){if(null!==n[r].renderer&&"function"!=typeof n[r].renderer)throw new TypeError('"options.node.renderer" is not a function, was '+n[r].renderer);if(void 0!==n[r].position&&"top"!==n[r].position&&"bottom"!==n[r].position&&"left"!==n[r].position&&"right"!==n[r].position&&"css"!==n[r].position)throw new Error('"options.position" is not "top", "bottom", "left", "right", or "css", was '+n[r].position);"doubleClickNode"===n[r].show?u=!0:"rightClickNode"===n[r].show&&(t=!0)}for(var r=0;r<n.length;r++)this.bindNodeEvents(n[r]);u||a.bind("doubleClickNode",function(a){g(),q=!0,l.dispatchEvent("hidden",a.data),setTimeout(function(){q=!1},b.doubleClickDelay)})}if(d.edge){for(var v=!1,w=!1,r=0;r<o.length;r++){if(null!==o[r].renderer&&"function"!=typeof o[r].renderer)throw new TypeError('"options.edge.renderer" is not a function, was '+o[r].renderer);if(void 0!==o[r].position&&"top"!==o[r].position&&"bottom"!==o[r].position&&"left"!==o[r].position&&"right"!==o[r].position&&"css"!==o[r].position)throw new Error('"options.position" is not "top", "bottom", "left", "right", or "css", was '+o[r].position);"doubleClickEdge"===o[r].show?w=!0:"rightClickEdge"===o[r].show&&(v=!0)}for(var r=0;r<o.length;r++)this.bindEdgeEvents(o[r]);w||a.bind("doubleClickEdge",function(a){g(),q=!0,l.dispatchEvent("hidden",a.data),setTimeout(function(){q=!1},b.doubleClickDelay)})}(t||v)&&c.container.addEventListener("contextmenu",e)}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var b={stage:{show:"rightClickStage",hide:"clickStage",cssClass:"sigma-tooltip",position:"top",autoadjust:!1,delay:0,hideDelay:0,template:"",renderer:null},node:{show:"clickNode",hide:"clickStage",cssClass:"sigma-tooltip",position:"top",autoadjust:!1,delay:0,hideDelay:0,template:"",renderer:null},edge:{show:"clickEdge",hide:"clickStage",cssClass:"sigma-tooltip",position:"top",autoadjust:!1,delay:0,hideDelay:0,template:"",renderer:null},doubleClickDelay:800},c={};sigma.plugins.tooltips=function(b,d,e){return c[b.id]||(c[b.id]=new a(b,d,e)),c[b.id]},sigma.plugins.killTooltips=function(b){c[b.id]instanceof a&&c[b.id].kill(),delete c[b.id]}}.call(window),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.settings");var b={edgelabelColor:"default",defaultEdgeLabelColor:"#000",defaultEdgeLabelActiveColor:"#000",defaultEdgeLabelSize:10,edgeLabelSize:"fixed",edgeLabelAlignment:"auto",edgeLabelSizePowRatio:1,edgeLabelThreshold:1,defaultEdgeHoverLabelBGColor:"#fff",edgeLabelHoverBGColor:"default",edgeLabelHoverShadow:"default",edgeLabelHoverShadowColor:"#000"};sigma.settings=sigma.utils.extend(sigma.settings||{},b),sigma.settings.drawEdgeLabels=!0}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels"),sigma.canvas.edges.labels.curve=function(a,b,c,d,e){function f(a,b,c,d,f,g,h){var i=Math.round(sigma.utils.canvas.getTextWidth(b,e("approximateLabelWidth"),c,f)+d+1.5+c/3),j=c+4;b.save(),b.beginPath(),b.translate(g,h),b.rotate(a),b.rect(-i/2,-j-d/2,i,j),b.closePath(),b.fill(),b.restore()}if("string"==typeof a.label){var g=e("prefix")||"",h=a[g+"size"]||1;if(!(h<e("edgeLabelThreshold"))||a.hover){if(0===e("edgeLabelSizePowRatio"))throw new Error('Invalid setting: "edgeLabelSizePowRatio" is equal to 0.');var i,j,k=b[g+"size"],l=b[g+"x"],m=b[g+"y"],n=c[g+"x"],o=c[g+"y"],p=n-l,q=o-m,r=n>l?1:-1,s={},t=0,u=.5,v=a.hover?e("hoverFontStyle")||e("fontStyle"):e("fontStyle");if(b.id===c.id?(s=sigma.utils.getSelfLoopControlPoints(l,m,k),j=sigma.utils.getPointOnBezierCurve(u,l,m,n,o,s.x1,s.y1,s.x2,s.y2)):(s=sigma.utils.getQuadraticControlPoint(l,m,n,o,a.cc),j=sigma.utils.getPointOnQuadraticCurve(u,l,m,n,o,s.x,s.y)),i="fixed"===e("edgeLabelSize")?e("defaultEdgeLabelSize"):e("defaultEdgeLabelSize")*h*Math.pow(h,-1/e("edgeLabelSizePowRatio")),d.save(),a.active?d.font=[e("activeFontStyle")||e("fontStyle"),i+"px",e("activeFont")||e("font")].join(" "):d.font=[v,i+"px",e("font")].join(" "),d.textAlign="center",d.textBaseline="alphabetic","auto"===e("edgeLabelAlignment"))if(b.id===c.id)t=Math.atan2(1,1);else{var w=sigma.utils.canvas.getTextWidth(d,e("approximateLabelWidth"),i,a.label),x=sigma.utils.getDistance(b[g+"x"],b[g+"y"],c[g+"x"],c[g+"y"]);x=x-b[g+"size"]-c[g+"size"]-10,x>w&&(t=Math.atan2(q*r,p*r))}a.hover&&(d.fillStyle="edge"===e("edgeLabelHoverBGColor")?a.color||e("defaultEdgeColor"):e("defaultEdgeHoverLabelBGColor"),e("edgeLabelHoverShadow")&&(d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=8,d.shadowColor=e("edgeLabelHoverShadowColor")),f(t,d,i,h,a.label,j.x,j.y),e("edgeLabelHoverShadow")&&(d.shadowBlur=0,d.shadowColor="#000")),a.active?d.fillStyle="edge"===e("edgeActiveColor")?a.active_color||e("defaultEdgeActiveColor"):e("defaultEdgeLabelActiveColor"):d.fillStyle="edge"===e("edgeLabelColor")?a.color||e("defaultEdgeColor"):e("defaultEdgeLabelColor"),
d.translate(j.x,j.y),d.rotate(t),d.fillText(a.label,0,-h/2-3),d.restore()}}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels"),sigma.canvas.edges.labels.curvedArrow=function(a,b,c,d,e){sigma.canvas.edges.labels.curve(a,b,c,d,e)}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels"),sigma.canvas.edges.labels.def=function(a,b,c,d,e,f){function g(a,b,c,d,f,g,h){var i=Math.round(sigma.utils.canvas.getTextWidth(b,e("approximateLabelWidth"),c,f)+d+1.5+c/3),j=c+4;b.save(),b.beginPath(),b.translate(g,h),b.rotate(a),b.rect(-i/2,-j-d/2,i,j),b.closePath(),b.fill(),b.restore()}if("string"==typeof a.label&&b!=c){var h=e("prefix")||"",i=a[h+"size"]||1;if(!(i<e("edgeLabelThreshold"))||a.hover){if(0===e("edgeLabelSizePowRatio"))throw new Error('Invalid setting: "edgeLabelSizePowRatio" is equal to 0.');var j,k,l,m,n=0,o=a.hover?e("hoverFontStyle")||e("fontStyle"):e("fontStyle"),p=(b[h+"x"]+c[h+"x"])/2,q=(b[h+"y"]+c[h+"y"])/2;j="fixed"===e("edgeLabelSize")?e("defaultEdgeLabelSize"):e("defaultEdgeLabelSize")*i*Math.pow(i,-1/e("edgeLabelSizePowRatio"));var r=[o,j+"px",e("font")].join(" ");if(a.active&&(r=[e("activeFontStyle")||e("fontStyle"),j+"px",e("activeFont")||e("font")].join(" ")),f&&f.ctx.font!=r?(d.font=r,f.ctx.font=r):d.font=r,d.textAlign="center",d.textBaseline="alphabetic","auto"===e("edgeLabelAlignment")){var s=sigma.utils.canvas.getTextWidth(d,e("approximateLabelWidth"),j,a.label),t=sigma.utils.getDistance(b[h+"x"],b[h+"y"],c[h+"x"],c[h+"y"]);t=t-b[h+"size"]-c[h+"size"]-10,t>s&&(k=c[h+"x"]-b[h+"x"],l=c[h+"y"]-b[h+"y"],m=b[h+"x"]<c[h+"x"]?1:-1,n=Math.atan2(l*m,k*m))}a.hover&&(d.fillStyle="edge"===e("edgeLabelHoverBGColor")?a.color||e("defaultEdgeColor"):e("defaultEdgeHoverLabelBGColor"),e("edgeLabelHoverShadow")&&(d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=8,d.shadowColor=e("edgeLabelHoverShadowColor")),g(n,d,j,i,a.label,p,q),e("edgeLabelHoverShadow")&&(d.shadowBlur=0,d.shadowColor="#000")),a.active?d.fillStyle="edge"===e("edgeActiveColor")?a.active_color||e("defaultEdgeActiveColor"):e("defaultEdgeLabelActiveColor"):d.fillStyle="edge"===e("edgeLabelColor")?a.color||e("defaultEdgeColor"):e("defaultEdgeLabelColor"),d.translate(p,q),d.rotate(n),d.fillText(a.label,0,-i/2-3),d.rotate(-n),d.translate(-p,-q)}}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.svg.edges.labels"),sigma.svg.edges.labels.curve={create:function(a,b){var c=b("prefix")||"",d=a[c+"size"],e=document.createElementNS(b("xmlns"),"text"),f="fixed"===b("labelSize")?b("defaultLabelSize"):b("labelSizeRatio")*d,g="edge"===b("edgeLabelColor")?a.color||b("defaultEdgeColor"):b("defaultEdgeLabelColor");return e.setAttributeNS(null,"data-label-target",a.id),e.setAttributeNS(null,"class",b("classPrefix")+"-label"),e.setAttributeNS(null,"font-size",f),e.setAttributeNS(null,"font-family",b("font")),e.setAttributeNS(null,"fill",g),e.innerHTML=a.label,e.textContent=a.label,e},update:function(a,b,c,d,e){var f,g=e("prefix")||"",h=a[g+"size"],i=b[g+"size"],j=(Math.round((b[g+"x"]+c[g+"x"])/2),Math.round((b[g+"y"]+c[g+"y"])/2),b[g+"x"]),k=b[g+"y"],l=c[g+"x"],m=c[g+"y"],n=l-j,o=m-k,p=0,q=l>j?1:-1,r=0,s=.5,t={};return"fixed"===e("labelSize")?e("defaultLabelSize"):e("labelSizeRatio")*h,!e("forceLabels")&&h<e("edgeLabelThreshold")||"string"!=typeof a.label?void 0:(b.id===c.id?(t=sigma.utils.getSelfLoopControlPoints(j,k,i),f=sigma.utils.getPointOnBezierCurve(s,j,k,l,m,t.x1,t.y1,t.x2,t.y2)):(t=sigma.utils.getQuadraticControlPoint(j,k,l,m,a.cc),f=sigma.utils.getPointOnQuadraticCurve(s,j,k,l,m,t.x,t.y)),"auto"===e("edgeLabelAlignment")&&(p=-1-h,r=b.id===c.id?45:Math.atan2(o*q,n*q)*(180/Math.PI)),d.setAttributeNS(null,"x",f.x),d.setAttributeNS(null,"y",f.y),d.setAttributeNS(null,"transform","rotate("+r+" "+f.x+" "+f.y+") translate(0 "+p+")"),d.style.display="",this)}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.svg.edges.labels"),sigma.svg.edges.labels.curvedArrow=sigma.svg.edges.labels.curve}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.svg.edges.labels"),sigma.svg.edges.labels.def={create:function(a,b){var c=b("prefix")||"",d=a[c+"size"],e=document.createElementNS(b("xmlns"),"text"),f="fixed"===b("labelSize")?b("defaultLabelSize"):b("labelSizeRatio")*d,g="edge"===b("edgeLabelColor")?a.color||b("defaultEdgeColor"):b("defaultEdgeLabelColor");return e.setAttributeNS(null,"data-label-target",a.id),e.setAttributeNS(null,"class",b("classPrefix")+"-label"),e.setAttributeNS(null,"font-size",f),e.setAttributeNS(null,"font-family",b("font")),e.setAttributeNS(null,"fill",g),e.innerHTML=a.label,e.textContent=a.label,e},update:function(a,b,c,d,e){var f,g,h,i=e("prefix")||"",j=a[i+"size"],k=Math.round((b[i+"x"]+c[i+"x"])/2),l=Math.round((b[i+"y"]+c[i+"y"])/2),m=0,n=0;return"fixed"===e("labelSize")?e("defaultLabelSize"):e("labelSizeRatio")*j,b.id===c.id||!e("forceLabels")&&j<e("edgeLabelThreshold")||"string"!=typeof a.label?void 0:("auto"===e("edgeLabelAlignment")&&(f=c[i+"x"]-b[i+"x"],g=c[i+"y"]-b[i+"y"],h=b[i+"x"]<c[i+"x"]?1:-1,n=Math.atan2(g*h,f*h)*(180/Math.PI),m=Math.round(-1-j)),d.setAttributeNS(null,"x",k),d.setAttributeNS(null,"y",l),d.setAttributeNS(null,"transform","rotate("+n+" "+k+" "+l+") translate(0 "+m+")"),d.style.display="",this)}}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw new Error("sigma not in scope.");sigma.utils.pkg("sigma.settings");var b={nodeHaloColor:"#fff",nodeHaloStroke:!1,nodeHaloStrokeColor:"#000",nodeHaloStrokeWidth:.5,nodeHaloSize:50,nodeHaloClustering:!1,nodeHaloClusteringMaxRadius:1e3,edgeHaloColor:"#fff",edgeHaloSize:10,drawHalo:!0};sigma.settings=sigma.utils.extend(sigma.settings||{},b)}.call(this),function(a){"use strict";function b(){for(var a=[],b=-1,c=arguments.length;++b<c;){var d=arguments[b];a.push(d)}var e=a[0],f=-1,g=e?e.length:0,h=[];a:for(;++f<g;)if(d=e[f],h.indexOf(d)<0){for(var b=c;--b;)if(a[b].indexOf(d)<0)continue a;h.push(d)}return h}function c(a,b,c){for(var d=0;d<a.length;d++)null!=a[d]&&(b.beginPath(),b.arc(a[d].x,a[d].y,a[d].radius,0,2*Math.PI,!0),b.closePath(),c?b.stroke():b.fill())}function d(a,b,c){if(c=c||Number.POSITIVE_INFINITY,a.length>1)for(var d,e,f,g=!0;g;){g=!1;for(var h=0;h<a.length;h++)if(null!==a[h])for(var i=h+1;i<a.length;i++)if(null!==a[i]&&(e=sigma.utils.getDistance(a[h].x,a[h].y,a[i].x,a[i].y),c>e&&e<a[h].radius+a[i].radius)){g=!0,f=[{x:a[h].x,y:a[h].y,radius:a[h].radius},{x:a[i].x,y:a[i].y,radius:a[i].radius}],a[h].points&&(f=f.concat(a[h].points)),a[i].points&&(f=f.concat(a[i].points)),d={x:0,y:0};for(var j=0;j<f.length;j++)d.x+=f[j].x,d.y+=f[j].y;d.x/=f.length,d.y/=f.length,d.radius=Math.max.apply(null,f.map(function(a){return b+sigma.utils.getDistance(d.x,d.y,a.x,a.y)})),a.push({x:d.x,y:d.y,radius:d.radius,points:f}),a[h]=a[i]=null;break}}return a}function e(a){a=a||{},this.domElements.background||(this.initDOM("canvas","background"),this.domElements.background.width=this.container.offsetWidth,this.domElements.background.height=this.container.offsetHeight,this.container.insertBefore(this.domElements.background,this.container.firstChild));var e,f,g,h,i,j,k,l,m,n,o=this,p=o.contexts.background,q=this instanceof sigma.renderers.webgl,r=o.options.prefix,s=q?r.substr(5):r,t=a.nodeHaloClustering||o.settings("nodeHaloClustering"),u=a.nodeHaloClusteringMaxRadius||o.settings("nodeHaloClusteringMaxRadius"),v=a.nodeHaloColor||o.settings("nodeHaloColor"),w=a.nodeHaloSize||o.settings("nodeHaloSize"),x=a.nodeHaloStroke||o.settings("nodeHaloStroke"),y=a.nodeHaloStrokeColor||o.settings("nodeHaloStrokeColor"),z=a.nodeHaloStrokeWidth||o.settings("nodeHaloStrokeWidth"),A=o.settings("nodeBorderSize")||0,B=o.settings("nodeOuterBorderSize")||0,C=a.edgeHaloColor||o.settings("edgeHaloColor"),D=a.edgeHaloSize||o.settings("edgeHaloSize"),E=a.drawHalo||o.settings("drawHalo"),F=a.nodes||[],G=a.edges||[];E&&(F=q?F:b(a.nodes,o.nodesOnScreen),G=q?G:b(a.edges,o.edgesOnScreen),p.clearRect(0,0,p.canvas.width,p.canvas.height),p.save(),p.strokeStyle=C,G.forEach(function(a){e=o.graph.nodes(a.source),f=o.graph.nodes(a.target),p.lineWidth=(a[r+"size"]||1)+D,p.beginPath(),g={},h=e[s+"size"],i=e[s+"x"],j=e[s+"y"],k=f[s+"x"],l=f[s+"y"],p.moveTo(i,j),"curve"===a.type||"curvedArrow"===a.type?a.source===a.target?(g=sigma.utils.getSelfLoopControlPoints(i,j,h),p.bezierCurveTo(g.x1,g.y1,g.x2,g.y2,k,l)):(g=sigma.utils.getQuadraticControlPoint(i,j,k,l,a.cc),p.quadraticCurveTo(g.x,g.y,k,l)):(p.moveTo(i,j),p.lineTo(k,l)),p.stroke(),p.closePath()}),p.fillStyle=v,x&&(p.lineWidth=z,p.strokeStyle=y),m=A+B+w,n=F.filter(function(a){return!a.hidden}).map(function(a){return{x:a[s+"x"],y:a[s+"y"],radius:a[s+"size"]+m}}),t&&(n=d(n,m,u)),x&&c(n,p,!0),c(n,p),p.restore())}if("undefined"==typeof sigma)throw new Error("sigma not in scope.");sigma.renderers.canvas.prototype.halo=e,sigma.renderers.webgl.prototype.halo=e}.call(this),!function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.arrow=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=e("edgeColor"),i=e("defaultNodeColor"),j=e("defaultEdgeColor"),k=e("edgeHoverLevel"),l=a[g+"size"]||1,m=c[g+"size"],n=b[g+"x"],o=b[g+"y"],p=c[g+"x"],q=c[g+"y"];l=a.hover?e("edgeHoverSizeRatio")*l:l;var r=Math.max(2.5*l,e("minArrowSize")),s=Math.sqrt(Math.pow(p-n,2)+Math.pow(q-o,2)),t=n+(p-n)*(s-r-m)/s,u=o+(q-o)*(s-r-m)/s,v=(p-n)*r/s,w=(q-o)*r/s;if(k)switch(d.shadowOffsetX=0,k){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!f)switch(h){case"source":f=b.color||i;break;case"target":f=c.color||i;break;default:f=j}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,d.strokeStyle=f,d.lineWidth=l,d.beginPath(),d.moveTo(n,o),d.lineTo(t,u),d.stroke(),d.fillStyle=f,d.beginPath(),d.moveTo(t+v,u+w),d.lineTo(t+.6*w,u-.6*v),d.lineTo(t-.6*w,u+.6*v),d.lineTo(t+v,u+w),d.closePath(),d.fill(),k&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.arrow&&(a.hover=!0,sigma.canvas.edges.labels.arrow(a,b,c,d,e),a.hover=!1)}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.curve=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=e("edgeHoverSizeRatio")*(a[g+"size"]||1),i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=e("edgeHoverLevel"),m={},n=b[g+"size"],o=b[g+"x"],p=b[g+"y"],q=c[g+"x"],r=c[g+"y"];if(m=b.id===c.id?sigma.utils.getSelfLoopControlPoints(o,p,n):sigma.utils.getQuadraticControlPoint(o,p,q,r,a.cc),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(o,p),b.id===c.id?d.bezierCurveTo(m.x1,m.y1,m.x2,m.y2,q,r):d.quadraticCurveTo(m.x,m.y,q,r),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.curve&&(a.hover=!0,sigma.canvas.edges.labels.curve(a,b,c,d,e),a.hover=!1)}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.curvedArrow=function(a,b,c,d,e){var f,g,h,i,j,k,l=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,m=e("prefix")||"",n=e("edgeColor"),o=e("defaultNodeColor"),p=e("defaultEdgeColor"),q=e("edgeHoverLevel"),r={},s=e("edgeHoverSizeRatio")*(a[m+"size"]||1),t=c[m+"size"],u=b[m+"x"],v=b[m+"y"],w=c[m+"x"],x=c[m+"y"];if(r=b.id===c.id?sigma.utils.getSelfLoopControlPoints(u,v,t):sigma.utils.getQuadraticControlPoint(u,v,w,x,a.cc),b.id===c.id?(f=Math.sqrt(Math.pow(w-r.x1,2)+Math.pow(x-r.y1,2)),g=2.5*s,h=r.x1+(w-r.x1)*(f-g-t)/f,i=r.y1+(x-r.y1)*(f-g-t)/f,j=(w-r.x1)*g/f,k=(x-r.y1)*g/f):(f=Math.sqrt(Math.pow(w-r.x,2)+Math.pow(x-r.y,2)),g=Math.max(2.5*s,e("minArrowSize")),h=r.x+(w-r.x)*(f-g-t)/f,i=r.y+(x-r.y)*(f-g-t)/f,j=(w-r.x)*g/f,k=(x-r.y)*g/f),q)switch(d.shadowOffsetX=0,q){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!l)switch(n){case"source":l=b.color||o;break;case"target":l=c.color||o;break;default:l=p}if(l="edge"===e("edgeHoverColor")?a.hover_color||l:a.hover_color||e("defaultEdgeHoverColor")||l,d.strokeStyle=l,d.lineWidth=s,d.beginPath(),d.moveTo(u,v),b.id===c.id?d.bezierCurveTo(r.x2,r.y2,r.x1,r.y1,h,i):d.quadraticCurveTo(r.x,r.y,h,i),d.stroke(),d.fillStyle=l,d.beginPath(),d.moveTo(h+j,i+k),d.lineTo(h+.6*k,i-.6*j),d.lineTo(h-.6*k,i+.6*j),d.lineTo(h+j,i+k),d.closePath(),d.fill(),q&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.curvedArrow){a.hover=!0;var y=sigma.canvas.edges.labels.curvedArrow;(y.render||y)(a,b,c,d,e),a.hover=!1}}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.dashed=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=e("edgeHoverLevel");if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}if(f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,h*=e("edgeHoverSizeRatio"),d.save(),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}d.setLineDash([8,3]),d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore(),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.def&&(a.hover=!0,sigma.canvas.edges.labels.def(a,b,c,d,e),a.hover=!1)}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.def=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=e("edgeHoverLevel");if(l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,h*=e("edgeHoverSizeRatio"),d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.def&&(a.hover=!0,sigma.canvas.edges.labels.def(a,b,c,d,e),a.hover=!1)}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.dotted=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=e("edgeHoverLevel");if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}if(f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,h*=e("edgeHoverSizeRatio"),d.save(),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(d.setLineDash([2]),d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore(),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.def){a.hover=!0;var m=sigma.canvas.edges.labels.def;(m.render||m)(a,b,c,d,e),a.hover=!1}}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.parallel=function(a,b,c,d,e){var f,g,h=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,i=e("prefix")||"",j=a[i+"size"]||1,k=e("edgeColor"),l=e("defaultNodeColor"),m=e("defaultEdgeColor"),n=e("edgeHoverLevel"),o=b[i+"x"],p=b[i+"y"],q=c[i+"x"],r=c[i+"y"],s=sigma.utils.getDistance(o,p,q,r);if(!h)switch(k){case"source":h=b.color||l;break;case"target":h=c.color||l;break;default:h=m}if(h="edge"===e("edgeHoverColor")?a.hover_color||h:a.hover_color||e("defaultEdgeHoverColor")||h,j*=e("edgeHoverSizeRatio"),f=sigma.utils.getCircleIntersection(o,p,j,q,r,s),g=sigma.utils.getCircleIntersection(q,r,j,o,p,s),d.save(),n)switch(d.shadowOffsetX=0,n){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}d.strokeStyle=h,d.lineWidth=j,d.beginPath(),d.moveTo(f.xi,f.yi),d.lineTo(g.xi_prime,g.yi_prime),d.closePath(),d.stroke(),d.beginPath(),d.moveTo(f.xi_prime,f.yi_prime),d.lineTo(g.xi,g.yi),d.closePath(),d.stroke(),n&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore(),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.def&&(a.hover=!0,sigma.canvas.edges.labels.def(a,b,c,d,e),a.hover=!1)}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers"),sigma.canvas.edgehovers.tapered=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),g=e("prefix")||"",j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=e("edgeHoverLevel"),m=b[g+"x"],n=b[g+"y"],o=c[g+"x"],p=c[g+"y"],q=sigma.utils.getDistance(m,n,o,p);if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}f="edge"===e("edgeHoverColor")?a.hover_color||f:a.hover_color||e("defaultEdgeHoverColor")||f,h*=e("edgeHoverSizeRatio");var r=sigma.utils.getCircleIntersection(m,n,h,o,p,q);if(d.save(),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}d.globalAlpha=.65,d.fillStyle=f,d.beginPath(),d.moveTo(o,p),d.lineTo(r.xi,r.yi),d.lineTo(r.xi_prime,r.yi_prime),d.closePath(),d.fill(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore(),sigma.canvas.edges.labels&&sigma.canvas.edges.labels.def&&(a.hover=!0,sigma.canvas.edges.labels.def(a,b,c,d,e),a.hover=!1)}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.arrow=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=e("edgeColor"),i=e("defaultNodeColor"),j=e("defaultEdgeColor"),k=a.active?e("edgeActiveLevel"):a.level,l=a[g+"size"]||1,m=c[g+"size"],n=b[g+"x"],o=b[g+"y"],p=c[g+"x"],q=c[g+"y"],r=Math.max(2.5*l,e("minArrowSize")),s=Math.sqrt(Math.pow(p-n,2)+Math.pow(q-o,2)),t=n+(p-n)*(s-r-m)/s,u=o+(q-o)*(s-r-m)/s,v=(p-n)*r/s,w=(q-o)*r/s;if(k)switch(d.shadowOffsetX=0,k){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!f)switch(h){case"source":f=b.color||i;break;case"target":f=c.color||i;break;default:f=j}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?f||j:e("defaultEdgeActiveColor"):d.strokeStyle=f,d.lineWidth=l,d.beginPath(),d.moveTo(n,o),d.lineTo(t,u),d.stroke(),d.fillStyle=f,d.beginPath(),d.moveTo(t+v,u+w),d.lineTo(t+.6*w,u-.6*v),d.lineTo(t-.6*w,u+.6*v),d.lineTo(t+v,u+w),d.closePath(),d.fill(),k&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000")}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");var a=function(a,b,c,d){if(d){var e=a*b/c;return{y:e?e:Number.POSITIVE_INFINITY}}var f=a/(b/2),e=a-f*c;return{y:e?1/e:b}};sigma.canvas.edges.autoCurve=function(b){var c,d=b.settings("autoCurveRatio"),e=b.settings("autoCurveSortByDirection"),f=b.settings("defaultEdgeType"),g=b.graph.edges(),h={key:function(a){var b=a.source+","+a.target;return this[b]?b:!e&&(b=a.target+","+a.source,this[b])?b:(e&&this[a.target+","+a.source]?this[b]={i:1,n:1}:this[b]={i:0,n:0},b)},inc:function(a){this[this.key(a)].n++}};g.forEach(function(a){h.inc(a)}),g.forEach(function(b){c=h.key(b),h[c].n>1||h[c].i>0?(b.cc||("arrow"===b.type||"tapered"===b.type||"arrow"===f||"tapered"===f?(b.cc_prev_type||(b.cc_prev_type=b.type),b.type="curvedArrow"):(b.cc_prev_type||(b.cc_prev_type=b.type),b.type="curve")),b.cc=a(d,h[c].n,h[c].i++,e)):b.cc&&(b.type=b.cc_prev_type,b.cc_prev_type=void 0,b.cc=void 0)})}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.curve=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=a.active?e("edgeActiveLevel"):a.level,m={},n=b[g+"size"],o=b[g+"x"],p=b[g+"y"],q=c[g+"x"],r=c[g+"y"];if(m=b.id===c.id?sigma.utils.getSelfLoopControlPoints(o,p,n):sigma.utils.getQuadraticControlPoint(o,p,q,r,a.cc),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?f||k:e("defaultEdgeActiveColor"):d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(o,p),b.id===c.id?d.bezierCurveTo(m.x1,m.y1,m.x2,m.y2,q,r):d.quadraticCurveTo(m.x,m.y,q,r),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000")}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.curvedArrow=function(a,b,c,d,e){var f,g,h,i,j,k,l=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,m=e("prefix")||"",n=e("edgeColor"),o=e("defaultNodeColor"),p=e("defaultEdgeColor"),q=a.active?e("edgeActiveLevel"):a.level,r={},s=a[m+"size"]||1,t=c[m+"size"],u=b[m+"x"],v=b[m+"y"],w=c[m+"x"],x=c[m+"y"];if(r=b.id===c.id?sigma.utils.getSelfLoopControlPoints(u,v,t):sigma.utils.getQuadraticControlPoint(u,v,w,x,a.cc),b.id===c.id?(f=Math.sqrt(Math.pow(w-r.x1,2)+Math.pow(x-r.y1,2)),g=2.5*s,h=r.x1+(w-r.x1)*(f-g-t)/f,i=r.y1+(x-r.y1)*(f-g-t)/f,j=(w-r.x1)*g/f,k=(x-r.y1)*g/f):(f=Math.sqrt(Math.pow(w-r.x,2)+Math.pow(x-r.y,2)),g=Math.max(2.5*s,e("minArrowSize")),h=r.x+(w-r.x)*(f-g-t)/f,i=r.y+(x-r.y)*(f-g-t)/f,j=(w-r.x)*g/f,k=(x-r.y)*g/f),q)switch(d.shadowOffsetX=0,q){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!l)switch(n){case"source":l=b.color||o;break;case"target":l=c.color||o;break;default:l=p}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?l||p:e("defaultEdgeActiveColor"):d.strokeStyle=l,d.lineWidth=s,d.beginPath(),d.moveTo(u,v),b.id===c.id?d.bezierCurveTo(r.x2,r.y2,r.x1,r.y1,h,i):d.quadraticCurveTo(r.x,r.y,h,i),d.stroke(),d.fillStyle=l,d.beginPath(),d.moveTo(h+j,i+k),d.lineTo(h+.6*k,i-.6*j),d.lineTo(h-.6*k,i+.6*j),d.lineTo(h+j,i+k),d.closePath(),d.fill(),q&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000")}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.dashed=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=a.active?e("edgeActiveLevel"):a.level;if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}if(d.save(),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?f||k:e("defaultEdgeActiveColor"):d.strokeStyle=f,d.setLineDash([8,3]),d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.def=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=a.active?e("edgeActiveLevel"):a.level;if(l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?f||k:e("defaultEdgeActiveColor"):d.strokeStyle=f,d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000")}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.dotted=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=a.active?e("edgeActiveLevel"):a.level;if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}if(d.save(),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?f||k:e("defaultEdgeActiveColor"):d.strokeStyle=f,d.setLineDash([2]),d.lineWidth=h,d.beginPath(),d.moveTo(b[g+"x"],b[g+"y"]),d.lineTo(c[g+"x"],c[g+"y"]),d.stroke(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.parallel=function(a,b,c,d,e){var f,g,h=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,i=e("prefix")||"",j=a[i+"size"]||1,k=e("edgeColor"),l=e("defaultNodeColor"),m=e("defaultEdgeColor"),n=a.active?e("edgeActiveLevel"):a.level,o=b[i+"x"],p=b[i+"y"],q=c[i+"x"],r=c[i+"y"],s=sigma.utils.getDistance(o,p,q,r);if(!h)switch(k){case"source":h=b.color||l;break;case"target":h=c.color||l;break;default:h=m}if(f=sigma.utils.getCircleIntersection(o,p,j,q,r,s),g=sigma.utils.getCircleIntersection(q,r,j,o,p,s),d.save(),n)switch(d.shadowOffsetX=0,n){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}a.active?d.strokeStyle="edge"===e("edgeActiveColor")?h||m:e("defaultEdgeActiveColor"):d.strokeStyle=h,d.lineWidth=j,d.beginPath(),d.moveTo(f.xi,f.yi),d.lineTo(g.xi_prime,g.yi_prime),d.closePath(),d.stroke(),d.beginPath(),d.moveTo(f.xi_prime,f.yi_prime),d.lineTo(g.xi,g.yi),d.closePath(),d.stroke(),n&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore()}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.edges"),sigma.canvas.edges.tapered=function(a,b,c,d,e){var f=a.active?a.active_color||e("defaultEdgeActiveColor"):a.color,g=e("prefix")||"",h=a[g+"size"]||1,i=e("edgeColor"),g=e("prefix")||"",j=e("defaultNodeColor"),k=e("defaultEdgeColor"),l=a.active?e("edgeActiveLevel"):a.level,m=b[g+"x"],n=b[g+"y"],o=c[g+"x"],p=c[g+"y"],q=sigma.utils.getDistance(m,n,o,p);if(!f)switch(i){case"source":f=b.color||j;break;case"target":f=c.color||j;break;default:f=k}var r=sigma.utils.getCircleIntersection(m,n,h,o,p,q);if(d.save(),l)switch(d.shadowOffsetX=0,l){case 1:d.shadowOffsetY=1.5,d.shadowBlur=4,d.shadowColor="rgba(0,0,0,0.36)";break;case 2:d.shadowOffsetY=3,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.39)";
break;case 3:d.shadowOffsetY=6,d.shadowBlur=12,d.shadowColor="rgba(0,0,0,0.42)";break;case 4:d.shadowOffsetY=10,d.shadowBlur=20,d.shadowColor="rgba(0,0,0,0.47)";break;case 5:d.shadowOffsetY=15,d.shadowBlur=24,d.shadowColor="rgba(0,0,0,0.52)"}a.active?d.fillStyle="edge"===e("edgeActiveColor")?f||k:e("defaultEdgeActiveColor"):d.fillStyle=f,d.globalAlpha=.65,d.beginPath(),d.moveTo(o,p),d.lineTo(r.xi,r.yi),d.lineTo(r.xi_prime,r.yi_prime),d.closePath(),d.fill(),l&&(d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor="#000000"),d.restore()}}(),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.extremities"),sigma.canvas.extremities.def=function(a,b,c,d,e){(sigma.canvas.hovers[b.type]||sigma.canvas.hovers.def)(b,d,e),(sigma.canvas.hovers[c.type]||sigma.canvas.hovers.def)(c,d,e)}}.call(this),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.hovers"),sigma.canvas.hovers.def=function(a,b,c){function d(b){b.font=(h?h+" ":"")+o+"px "+(c("hoverFont")||c("font")),b.beginPath(),b.fillStyle="node"===c("labelHoverBGColor")?a.color||k:c("defaultHoverLabelBGColor"),a.label&&c("labelHoverShadow")&&(b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=8,b.shadowColor=c("labelHoverShadowColor"))}function e(a,b,d,e,f,g){var h=g>1&&f.length>1?.6*g*d:sigma.utils.canvas.getTextWidth(b,c("approximateLabelWidth"),d,f[0]),k=Math.round(e[i+"x"]),n=Math.round(e[i+"y"]),o=Math.round(h+4),p=p=(d+1)*f.length+4,q=Math.round(j+.25*d);if(e.label&&"string"==typeof e.label)switch(a){case"constrained":case"center":n=Math.round(e[i+"y"]-.5*d-2),b.rect(k-.5*o,n,o,p);break;case"left":k=Math.round(e[i+"x"]+.5*d+2),n=Math.round(e[i+"y"]-.5*d-2),o+=.5*j+.5*d,b.moveTo(k,n+q),b.arcTo(k,n,k-q,n,q),b.lineTo(k-o-l-m-q,n),b.lineTo(k-o-l-m-q,n+p),b.lineTo(k-q,n+p),b.arcTo(k,n+p,k,n+p-q,q),b.lineTo(k,n+q);break;case"top":b.rect(k-.5*o,n-q-p,o,p);break;case"bottom":b.rect(k-.5*o,n+q,o,p);break;case"inside":if(2*q>=h)break;case"right":default:k=Math.round(e[i+"x"]-.5*d-2),n=Math.round(e[i+"y"]-.5*d-2),o+=.5*j+.5*d,b.moveTo(k,n+q),b.arcTo(k,n,k+q,n,q),b.lineTo(k+o+l+m+q,n),b.lineTo(k+o+l+m+q,n+p),b.lineTo(k+q,n+p),b.arcTo(k,n+p,k,n+p-q,q),b.lineTo(k,n+q)}b.closePath(),b.fill(),b.shadowOffsetY=0,b.shadowBlur=0}function f(a,b){if(null==a)return[];if(1>=b)return[a];for(var c=a.split(" "),d=[],e=0,f=-1,h=[],i=!0,j=0;j<c.length;++j)if(i){if(c[j].length>b){for(var k=g(c[j],b),l=0;l<k.length;++l)d.push([k[l]]),++f;e=k[k.length-1].length}else d.push([c[j]]),++f,e=c[j].length+1;i=!1}else e+c[j].length<=b?(d[f].push(c[j]),e+=c[j].length+1):(i=!0,--j);for(j=0;j<d.length;++j)h.push(d[j].join(" "));return h}function g(a,b){for(var c=[],d=0;d<a.length;d+=b-1)c.push(a.substr(d,b-1)+"-");var e=c[c.length-1].length;return c[c.length-1]=c[c.length-1].substr(0,e-1)+" ",c}var h=c("hoverFontStyle")||c("fontStyle"),i=c("prefix")||"",j=a[i+"size"]||1,k=c("defaultNodeColor"),l=a.active?a.border_size||c("nodeActiveBorderSize")||c("nodeBorderSize"):a.border_size||c("nodeHoverBorderSize")||c("nodeBorderSize"),m=a.active?c("nodeActiveOuterBorderSize")||c("nodeOuterBorderSize"):c("nodeOuterBorderSize"),n=c("labelAlignment"),o="fixed"===c("labelSize")?c("defaultLabelSize"):c("labelSizeRatio")*j,p="node"===c("nodeHoverColor")?a.color||k:c("defaultNodeHoverColor"),q="default"===c("nodeHoverBorderColor")?c("defaultNodeHoverBorderColor")||c("defaultNodeBorderColor"):a.border_color||k,r=c("maxNodeLabelLineLength")||0,s=c("nodeHoverLevel"),t=f(a.label,r);if("center"!==n&&(d(b),e(n,b,o,a,t,r)),s)switch(b.shadowOffsetX=0,s){case 1:b.shadowOffsetY=1.5,b.shadowBlur=4,b.shadowColor="rgba(0,0,0,0.36)";break;case 2:b.shadowOffsetY=3,b.shadowBlur=12,b.shadowColor="rgba(0,0,0,0.39)";break;case 3:b.shadowOffsetY=6,b.shadowBlur=12,b.shadowColor="rgba(0,0,0,0.42)";break;case 4:b.shadowOffsetY=10,b.shadowBlur=20,b.shadowColor="rgba(0,0,0,0.47)";break;case 5:b.shadowOffsetY=15,b.shadowBlur=24,b.shadowColor="rgba(0,0,0,0.52)"}l>0&&(b.beginPath(),b.fillStyle="node"===c("nodeHoverBorderColor")?q:c("defaultNodeHoverBorderColor")||c("defaultNodeBorderColor"),b.arc(a[i+"x"],a[i+"y"],j+l,0,2*Math.PI,!0),b.closePath(),b.fill());var u=sigma.canvas.nodes[a.type]||sigma.canvas.nodes.def;if(u(a,b,c,{color:p}),s&&(b.shadowOffsetY=0,b.shadowBlur=0),"center"===n&&(d(b),e(n,b,o,a,t,r)),"string"==typeof a.label){b.fillStyle="node"===c("labelHoverColor")?a.color||k:c("defaultLabelHoverColor");var v,w=0,x=o/3,y=!0;switch(b.textAlign="center",n){case"bottom":x=+j+4*o/3;break;case"center":break;case"left":b.textAlign="right",w=-j-l-m-3;break;case"top":x=-j-2*o/3;break;case"constrained":v=sigma.utils.canvas.getTextWidth(a.label),v>2*(j+o/3)&&(y=!1);break;case"inside":if(v=sigma.utils.canvas.getTextWidth(a.label),2*(j+o/3)>=v)break;case"right":default:w=j+l+m+3,b.textAlign="left"}if(y)for(var z=a[i+"x"]+w,A=Math.round(a[i+"y"]+x),B=0;B<t.length;++B)b.fillText(t[B],z,A+B*(o+1))}}}.call(this),function(a){"use strict";function b(a,b){if(1>=b)return[a];for(var d=a.split(" "),e=[],f=0,g=-1,h=[],i=!0,j=0;j<d.length;++j)if(i){if(d[j].length>b){for(var k=c(d[j],b),l=0;l<k.length;++l)e.push([k[l]]),++g;f=k[k.length-1].length}else e.push([d[j]]),++g,f=d[j].length+1;i=!1}else f+d[j].length<=b?(e[g].push(d[j]),f+=d[j].length+1):(i=!0,--j);for(j=0;j<e.length;++j)h.push(e[j].join(" "));return h}function c(a,b){for(var c=[],d=0;d<a.length;d+=b-1)c.push(a.substr(d,b-1)+"-");var e=c[c.length-1].length;return c[c.length-1]=c[c.length-1].substr(0,e-1)+" ",c}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.labels"),sigma.canvas.labels.def=function(a,c,d,e){var f,g,h,i,j=d("prefix")||"",k=a[j+"size"]||1,l=d(a.active?"activeFontStyle":"fontStyle"),m=a.active?(a.border_size||d("nodeActiveBorderSize")||d("nodeBorderSize"))+(d("nodeActiveOuterBorderSize")||d("nodeOuterBorderSize")):d("nodeBorderSize")+d("nodeOuterBorderSize"),n=d("maxNodeLabelLineLength")||0,o=!0,p=d("labelAlignment");if(!(k<=d("labelThreshold"))&&a.label&&"string"==typeof a.label){f="fixed"===d("labelSize")?d("defaultLabelSize"):d("labelSizeRatio")*k;var q=(l?l+" ":"")+f+"px "+(a.active?d("activeFont")||d("font"):d("font"));switch(e&&e.ctx.font!=q?(c.font=q,e.ctx.font=q):c.font=q,a.active?c.fillStyle="node"===d("labelActiveColor")?a.active_color||d("defaultNodeActiveColor"):d("defaultLabelActiveColor"):c.fillStyle="node"===d("labelColor")?a.color||d("defaultNodeColor"):d("defaultLabelColor"),h=0,i=f/3,c.textAlign="center",p){case"bottom":i=+k+4*f/3;break;case"center":break;case"left":c.textAlign="right",h=-k-m-3;break;case"top":i=-k-2*f/3;break;case"constrained":g=sigma.utils.canvas.getTextWidth(c,d("approximateLabelWidth"),f,a.label),g>2*(k+f/3)&&(o=!1);break;case"inside":if(g=sigma.utils.canvas.getTextWidth(c,d("approximateLabelWidth"),f,a.label),2*(k+f/3)>=g)break;case"right":default:h=k+m+3,c.textAlign="left"}if(o)for(var r=b(a.label,n),s=a[j+"x"]+h,t=Math.round(a[j+"y"]+i),u=0;u<r.length;++u)c.fillText(r[u],s,t+u*(f+1))}}}.call(this),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var a=function(a,b,c,d,e){var f=a.cross&&a.cross.lineWeight||1;e.moveTo(b-d,c-f),e.lineTo(b-d,c+f),e.lineTo(b-f,c+f),e.lineTo(b-f,c+d),e.lineTo(b+f,c+d),e.lineTo(b+f,c+f),e.lineTo(b+d,c+f),e.lineTo(b+d,c-f),e.lineTo(b+f,c-f),e.lineTo(b+f,c-d),e.lineTo(b-f,c-d),e.lineTo(b-f,c-f)};sigma.canvas.nodes.cross=function(b,c,d,e){var f=e||{},g=d("prefix")||"",h=b[g+"size"]||1,i=b[g+"x"],j=b[g+"y"],k=d("defaultNodeColor"),l=d("imgCrossOrigin")||"anonymous",m=b.border_size||d("nodeBorderSize"),n=d("nodeOuterBorderSize"),o=b.border_size||d("nodeActiveBorderSize"),p=d("nodeActiveOuterBorderSize"),q=f.color||b.color||k,r="default"===d("nodeBorderColor")?d("defaultNodeBorderColor"):f.borderColor||b.border_color||k,s=b.active?d("nodeActiveLevel"):b.level;sigma.utils.canvas.setLevel(s,c),b.active?(q="node"===d("nodeActiveColor")?b.active_color||q:d("defaultNodeActiveColor")||q,p>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveOuterBorderColor")?q||k:d("defaultNodeActiveOuterBorderColor"),c.arc(i,j,h+o+p,0,2*Math.PI,!0),c.closePath(),c.fill()),o>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveBorderColor")?r:d("defaultNodeActiveBorderColor"),c.arc(i,j,h+o,0,2*Math.PI,!0),c.closePath(),c.fill())):(n>0&&(c.beginPath(),c.fillStyle="node"===d("nodeOuterBorderColor")?q||k:d("defaultNodeOuterBorderColor"),c.arc(i,j,h+m+n,0,2*Math.PI,!0),c.closePath(),c.fill()),m>0&&(c.beginPath(),c.fillStyle="node"===d("nodeBorderColor")?r:d("defaultNodeBorderColor"),c.arc(i,j,h+m,0,2*Math.PI,!0),c.closePath(),c.fill())),c.fillStyle=q,c.beginPath(),a(b,i,j,h,c),c.closePath(),c.fill(),sigma.utils.canvas.setLevel(s,c),b.image&&sigma.utils.canvas.drawImage(b,i,j,h,c,l,d("imageThreshold",a)),b.icon&&sigma.utils.canvas.drawIcon(b,i,j,h,c,d("iconThreshold"))}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var a=function(a,b,c,d,e,f){a.beginPath(),a.strokeStyle=e,a.lineWidth=f,a.arc(b,c,d,0,2*Math.PI,!0),a.closePath(),a.stroke()};sigma.canvas.nodes.def=function(b,c,d,e){var f=e||{},g=d("prefix")||"",h=b[g+"size"]||1,i=b[g+"x"],j=b[g+"y"],k=d("defaultNodeColor"),l=d("imgCrossOrigin")||"anonymous",m=b.border_size||d("nodeBorderSize"),n=d("nodeOuterBorderSize"),o=b.border_size||d("nodeActiveBorderSize"),p=d("nodeActiveOuterBorderSize"),q=f.color||b.color||k,r="default"===d("nodeBorderColor")?d("defaultNodeBorderColor"):f.borderColor||b.border_color||b.color||k,s=b.active?d("nodeActiveLevel"):b.level;if(sigma.utils.canvas.setLevel(s,c),b.active?(q="node"===d("nodeActiveColor")?b.active_color||q:d("defaultNodeActiveColor")||q,p>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveOuterBorderColor")?q||k:d("defaultNodeActiveOuterBorderColor"),c.arc(i,j,h+o+p,0,2*Math.PI,!0),c.closePath(),c.fill()),o>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveBorderColor")?r:d("defaultNodeActiveBorderColor"),c.arc(i,j,h+o,0,2*Math.PI,!0),c.closePath(),c.fill())):(n>0&&(c.beginPath(),c.fillStyle="node"===d("nodeOuterBorderColor")?q||k:d("defaultNodeOuterBorderColor"),c.arc(i,j,h+m+n,0,2*Math.PI,!0),c.closePath(),c.fill()),m>0&&(c.beginPath(),c.fillStyle="node"===d("nodeBorderColor")?r:d("defaultNodeBorderColor"),c.arc(i,j,h+m,0,2*Math.PI,!0),c.closePath(),c.fill())),(!b.active||b.active&&"node"===d("nodeActiveColor"))&&b.colors&&b.colors.length){var t,u=b.colors.length,v=1/u,w=0;for(t=0;u>t;t++)c.fillStyle=b.colors[t],c.beginPath(),c.moveTo(i,j),c.arc(i,j,h,w,w+2*Math.PI*v,!1),c.lineTo(i,j),c.closePath(),c.fill(),w+=2*Math.PI*v;sigma.utils.canvas.resetLevel(c)}else c.fillStyle=q,c.beginPath(),c.arc(i,j,h,0,2*Math.PI,!0),c.closePath(),c.fill(),sigma.utils.canvas.resetLevel(c),!b.active&&m>0&&h>2*m&&a(c,i,j,h,r,m);b.image&&sigma.utils.canvas.drawImage(b,i,j,h,c,l,d("imageThreshold")),b.icon&&sigma.utils.canvas.drawIcon(b,i,j,h,c,d("iconThreshold"))}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var a=function(a,b,c,d,e){e.moveTo(b-d,c),e.lineTo(b,c-d),e.lineTo(b+d,c),e.lineTo(b,c+d)};sigma.canvas.nodes.diamond=function(b,c,d,e){var f=e||{},g=d("prefix")||"",h=b[g+"size"]||1,i=b[g+"x"],j=b[g+"y"],k=d("defaultNodeColor"),l=d("imgCrossOrigin")||"anonymous",m=b.border_size||d("nodeBorderSize"),n=d("nodeOuterBorderSize"),o=b.border_size||d("nodeActiveBorderSize"),p=d("nodeActiveOuterBorderSize"),q=f.color||b.color||k,r="default"===d("nodeBorderColor")?d("defaultNodeBorderColor"):f.borderColor||b.border_color||k,s=b.active?d("nodeActiveLevel"):b.level;sigma.utils.canvas.setLevel(s,c),b.active?(q="node"===d("nodeActiveColor")?b.active_color||q:d("defaultNodeActiveColor")||q,p>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveOuterBorderColor")?q||k:d("defaultNodeActiveOuterBorderColor"),c.arc(i,j,h+o+p,0,2*Math.PI,!0),c.closePath(),c.fill()),o>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveBorderColor")?r:d("defaultNodeActiveBorderColor"),c.arc(i,j,h+o,0,2*Math.PI,!0),c.closePath(),c.fill())):(n>0&&(c.beginPath(),c.fillStyle="node"===d("nodeOuterBorderColor")?q||k:d("defaultNodeOuterBorderColor"),c.arc(i,j,h+m+n,0,2*Math.PI,!0),c.closePath(),c.fill()),m>0&&(c.beginPath(),c.fillStyle="node"===d("nodeBorderColor")?r:d("defaultNodeBorderColor"),c.arc(i,j,h+m,0,2*Math.PI,!0),c.closePath(),c.fill())),c.fillStyle=q,c.beginPath(),a(b,i,j,h,c),c.closePath(),c.fill(),s&&sigma.utils.canvas.resetLevel(c),b.image&&sigma.utils.canvas.drawImage(b,i,j,h,c,l,d("imageThreshold"),a),b.icon&&sigma.utils.canvas.drawIcon(b,i,j,h,c,d("iconThreshold"))}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var a=function(a,b,c,d,e){var f=a.equilateral&&a.equilateral.numPoints||5,g=a.equilateral&&a.equilateral.rotate||0,h=d;g+=Math.PI/f,e.moveTo(b+h*Math.sin(g),c-h*Math.cos(g));for(var i=1;f>i;i++)e.lineTo(b+Math.sin(g+2*Math.PI*i/f)*h,c-Math.cos(g+2*Math.PI*i/f)*h)};sigma.canvas.nodes.equilateral=function(b,c,d,e){var f=e||{},g=d("prefix")||"",h=b[g+"size"]||1,i=b[g+"x"],j=b[g+"y"],k=d("defaultNodeColor"),l=d("imgCrossOrigin")||"anonymous",m=b.border_size||d("nodeBorderSize"),n=d("nodeOuterBorderSize"),o=b.border_size||d("nodeActiveBorderSize"),p=d("nodeActiveOuterBorderSize"),q=f.color||b.color||k,r="default"===d("nodeBorderColor")?d("defaultNodeBorderColor"):f.borderColor||b.border_color||k,s=b.active?d("nodeActiveLevel"):b.level;sigma.utils.canvas.setLevel(s,c),b.active?(q="node"===d("nodeActiveColor")?b.active_color||q:d("defaultNodeActiveColor")||q,p>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveOuterBorderColor")?q||k:d("defaultNodeActiveOuterBorderColor"),c.arc(i,j,h+o+p,0,2*Math.PI,!0),c.closePath(),c.fill()),o>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveBorderColor")?r:d("defaultNodeActiveBorderColor"),c.arc(i,j,h+o,0,2*Math.PI,!0),c.closePath(),c.fill())):(n>0&&(c.beginPath(),c.fillStyle="node"===d("nodeOuterBorderColor")?q||k:d("defaultNodeOuterBorderColor"),c.arc(i,j,h+m+n,0,2*Math.PI,!0),c.closePath(),c.fill()),m>0&&(c.beginPath(),c.fillStyle="node"===d("nodeBorderColor")?r:d("defaultNodeBorderColor"),c.arc(i,j,h+m,0,2*Math.PI,!0),c.closePath(),c.fill())),c.fillStyle=q,c.beginPath(),a(b,i,j,h,c),c.closePath(),c.fill(),s&&sigma.utils.canvas.resetLevel(c),b.image&&sigma.utils.canvas.drawImage(b,i,j,h,c,l,d("imageThreshold"),a),b.icon&&sigma.utils.canvas.drawIcon(b,i,j,h,c,d("iconThreshold"))}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var a=function(a,b,c,d,e){var f=45*Math.PI/180;e.moveTo(b+d*Math.sin(f),c-d*Math.cos(f));for(var g=1;4>g;g++)e.lineTo(b+Math.sin(f+2*Math.PI*g/4)*d,c-Math.cos(f+2*Math.PI*g/4)*d)};sigma.canvas.nodes.square=function(b,c,d,e){var f=e||{},g=d("prefix")||"",h=b[g+"size"]||1,i=b[g+"x"],j=b[g+"y"],k=d("defaultNodeColor"),l=d("imgCrossOrigin")||"anonymous",m=b.border_size||d("nodeBorderSize"),n=d("nodeOuterBorderSize"),o=b.border_size||d("nodeActiveBorderSize"),p=d("nodeActiveOuterBorderSize"),q=f.color||b.color||k,r="default"===d("nodeBorderColor")?d("defaultNodeBorderColor"):f.borderColor||b.border_color||k,s=b.active?d("nodeActiveLevel"):b.level;sigma.utils.canvas.setLevel(s,c),b.active?(q="node"===d("nodeActiveColor")?b.active_color||q:d("defaultNodeActiveColor")||q,p>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveOuterBorderColor")?q||k:d("defaultNodeActiveOuterBorderColor"),c.arc(i,j,h+o+p,0,2*Math.PI,!0),c.closePath(),c.fill()),o>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveBorderColor")?r:d("defaultNodeActiveBorderColor"),c.arc(i,j,h+o,0,2*Math.PI,!0),c.closePath(),c.fill())):(n>0&&(c.beginPath(),c.fillStyle="node"===d("nodeOuterBorderColor")?q||k:d("defaultNodeOuterBorderColor"),c.arc(i,j,h+m+n,0,2*Math.PI,!0),c.closePath(),c.fill()),m>0&&(c.beginPath(),c.fillStyle="node"===d("nodeBorderColor")?r:d("defaultNodeBorderColor"),c.arc(i,j,h+m,0,2*Math.PI,!0),c.closePath(),c.fill())),c.fillStyle=q,c.beginPath(),a(b,i,j,h,c),c.closePath(),c.fill(),s&&sigma.utils.canvas.resetLevel(c),b.image&&sigma.utils.canvas.drawImage(b,i,j,h,c,l,d("imageThreshold"),a),b.icon&&sigma.utils.canvas.drawIcon(b,i,j,h,c,d("iconThreshold"))}}(),function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var a=function(a,b,c,d,e){var f=a.star&&a.star.numPoints||5,g=a.star&&a.star.innerRatio||.5,h=d,i=d*g,j=Math.PI/f;e.moveTo(b,c-d);for(var k=0;f>k;k++)e.lineTo(b+Math.sin(j+2*Math.PI*k/f)*i,c-Math.cos(j+2*Math.PI*k/f)*i),e.lineTo(b+Math.sin(2*Math.PI*(k+1)/f)*h,c-Math.cos(2*Math.PI*(k+1)/f)*h)};sigma.canvas.nodes.star=function(b,c,d,e){var f=e||{},g=d("prefix")||"",h=b[g+"size"]||1,i=b[g+"x"],j=b[g+"y"],k=d("defaultNodeColor"),l=d("imgCrossOrigin")||"anonymous",m=b.border_size||d("nodeBorderSize"),n=d("nodeOuterBorderSize"),o=b.border_size||d("nodeActiveBorderSize"),p=d("nodeActiveOuterBorderSize"),q=f.color||b.color||k,r="default"===d("nodeBorderColor")?d("defaultNodeBorderColor"):f.borderColor||b.border_color||k,s=b.active?d("nodeActiveLevel"):b.level;sigma.utils.canvas.setLevel(s,c),b.active?(q="node"===d("nodeActiveColor")?b.active_color||q:d("defaultNodeActiveColor")||q,p>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveOuterBorderColor")?q||k:d("defaultNodeActiveOuterBorderColor"),c.arc(i,j,h+o+p,0,2*Math.PI,!0),c.closePath(),c.fill()),o>0&&(c.beginPath(),c.fillStyle="node"===d("nodeActiveBorderColor")?r:d("defaultNodeActiveBorderColor"),c.arc(i,j,h+o,0,2*Math.PI,!0),c.closePath(),c.fill())):(n>0&&(c.beginPath(),c.fillStyle="node"===d("nodeOuterBorderColor")?q||k:d("defaultNodeOuterBorderColor"),c.arc(i,j,h+m+n,0,2*Math.PI,!0),c.closePath(),c.fill()),m>0&&(c.beginPath(),c.fillStyle="node"===d("nodeBorderColor")?r:d("defaultNodeBorderColor"),c.arc(i,j,h+m,0,2*Math.PI,!0),c.closePath(),c.fill())),c.fillStyle=q,c.beginPath(),a(b,i,j,h,c),c.closePath(),c.fill(),s&&sigma.utils.canvas.resetLevel(c),b.image&&sigma.utils.canvas.drawImage(b,i,j,h,c,l,d("imageThreshold"),a),b.icon&&sigma.utils.canvas.drawIcon(b,i,j,h,c,d("iconThreshold"))}}(),function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.settings");var b={nodeBorderColor:"node,",nodeOuterBorderColor:"",nodeOuterBorderSize:0,defaultNodeOuterBorderColor:"#000",nodeHoverBorderSize:0,nodeHoverBorderColor:"node,",defaultNodeHoverBorderColor:"#000",nodeActiveBorderSize:0,nodeActiveBorderColor:"node,",defaultNodeActiveBorderColor:"#000",nodeActiveOuterBorderColor:"",nodeActiveOuterBorderSize:0,defaultNodeActiveOuterBorderColor:"#000",defaultLabelActiveColor:"#000",activeFont:"",activeFontStyle:"",labelActiveColor:"default",nodeActiveColor:"node",defaultNodeActiveColor:"rgb(236, 81, 72)",edgeActiveColor:"edge",defaultEdgeActiveColor:"rgb(236, 81, 72)",nodeActiveLevel:0,nodeHoverLevel:0,edgeActiveLevel:0,edgeHoverLevel:0,iconThreshold:8,imageThreshold:8,imgCrossOrigin:"anonymous"};sigma.settings=sigma.utils.extend(sigma.settings||{},b)}.call(this),function(){"use strict";sigma.utils.pkg("sigma.svg.edges"),sigma.svg.edges.tapered={create:function(a,b,c,d){var e=a.color,f=(d("prefix")||"",d("edgeColor")),g=d("defaultNodeColor"),h=d("defaultEdgeColor");if(!e)switch(f){case"source":e=b.color||g;break;case"target":e=c.color||g;break;default:e=h}var i=document.createElementNS(d("xmlns"),"polygon");return i.setAttributeNS(null,"data-edge-id",a.id),i.setAttributeNS(null,"class",d("classPrefix")+"-edge"),i.setAttributeNS(null,"fill",e),i.setAttributeNS(null,"fill-opacity",.6),i.setAttributeNS(null,"stroke-width",0),i},update:function(a,b,c,d,e){var f,g,h=e("prefix")||"",i=c[h+"x"],j=c[h+"y"],k=d[h+"x"],l=d[h+"y"],m=a[h+"size"]||1,n=sigma.utils.getDistance(i,j,k,l);return n?(f=sigma.utils.getCircleIntersection(i,j,m,k,l,n),g=k+","+l+" "+f.xi+","+f.yi+" "+f.xi_prime+","+f.yi_prime,b.setAttributeNS(null,"points",g),b.style.display="",this):void 0}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.edges"),sigma.webgl.edges.arrow={POINTS:9,ATTRIBUTES:11,addEdge:function(a,b,c,d,e,f,g){var h=(a[f+"size"]||1)/2,i=b[f+"x"],j=b[f+"y"],k=c[f+"x"],l=c[f+"y"],m=c[f+"size"],n=a.active?a.active_color||g("defaultEdgeActiveColor"):a.color;if(!n)switch(g("edgeColor")){case"source":n=b.color||g("defaultNodeColor");break;case"target":n=c.color||g("defaultNodeColor");break;default:n=g("defaultEdgeColor")}a.active&&(n="edge"===g("edgeActiveColor")?n||defaultEdgeColor:g("defaultEdgeActiveColor")),n=sigma.utils.floatColor(n),d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=m,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=m,d[e++]=0,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=m,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=1,d[e++]=-1,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=1,d[e++]=0,d[e++]=n,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=m,d[e++]=1,d[e++]=0,d[e++]=1,d[e++]=1,d[e++]=n},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_pos1"),g=a.getAttribLocation(b,"a_pos2"),h=a.getAttribLocation(b,"a_thickness"),i=a.getAttribLocation(b,"a_tSize"),j=a.getAttribLocation(b,"a_delay"),k=a.getAttribLocation(b,"a_minus"),l=a.getAttribLocation(b,"a_head"),m=a.getAttribLocation(b,"a_headPosition"),n=a.getAttribLocation(b,"a_color"),o=a.getUniformLocation(b,"u_resolution"),p=a.getUniformLocation(b,"u_matrix"),q=a.getUniformLocation(b,"u_matrixHalfPi"),r=a.getUniformLocation(b,"u_matrixHalfPiMinus"),s=a.getUniformLocation(b,"u_ratio"),t=a.getUniformLocation(b,"u_nodeRatio"),u=a.getUniformLocation(b,"u_arrowHead"),v=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW),a.uniform2f(o,d.width,d.height),a.uniform1f(s,d.ratio/Math.pow(d.ratio,d.settings("edgesPowRatio"))),a.uniform1f(t,Math.pow(d.ratio,d.settings("nodesPowRatio"))/d.ratio),a.uniform1f(u,5),a.uniform1f(v,d.scalingRatio),a.uniformMatrix3fv(p,!1,d.matrix),a.uniformMatrix2fv(q,!1,sigma.utils.matrices.rotation(Math.PI/2,!0)),a.uniformMatrix2fv(r,!1,sigma.utils.matrices.rotation(-Math.PI/2,!0)),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.enableVertexAttribArray(i),a.enableVertexAttribArray(j),a.enableVertexAttribArray(k),a.enableVertexAttribArray(l),a.enableVertexAttribArray(m),a.enableVertexAttribArray(n),a.vertexAttribPointer(f,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(h,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16),a.vertexAttribPointer(i,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20),a.vertexAttribPointer(j,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,24),a.vertexAttribPointer(k,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,28),a.vertexAttribPointer(l,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,32),a.vertexAttribPointer(m,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,36),a.vertexAttribPointer(n,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,40),a.drawArrays(a.TRIANGLES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_pos1;","attribute vec2 a_pos2;","attribute float a_thickness;","attribute float a_tSize;","attribute float a_delay;","attribute float a_minus;","attribute float a_head;","attribute float a_headPosition;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_nodeRatio;","uniform float u_arrowHead;","uniform float u_scale;","uniform mat3 u_matrix;","uniform mat2 u_matrixHalfPi;","uniform mat2 u_matrixHalfPiMinus;","varying vec4 color;","void main() {","vec2 pos = normalize(a_pos2 - a_pos1);","mat2 matrix = (1.0 - a_head) *","(","a_minus * u_matrixHalfPiMinus +","(1.0 - a_minus) * u_matrixHalfPi",") + a_head * (","a_headPosition * u_matrixHalfPiMinus * 0.6 +","(a_headPosition * a_headPosition - 1.0) * mat2(1.0)",");","pos = a_pos1 + (","(1.0 - a_head) * a_thickness * u_ratio * matrix * pos +","a_head * u_arrowHead * a_thickness * u_ratio * matrix * pos +","a_delay * pos * (","a_tSize / u_nodeRatio +","u_arrowHead * a_thickness * u_ratio",")",");","gl_Position = vec4(","((u_matrix * vec3(pos, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.edges"),sigma.webgl.edges.def={POINTS:6,ATTRIBUTES:7,addEdge:function(a,b,c,d,e,f,g){var h=(a[f+"size"]||1)/2,i=b[f+"x"],j=b[f+"y"],k=c[f+"x"],l=c[f+"y"],m=a.active?a.active_color||g("defaultEdgeActiveColor"):a.color;if(!m)switch(g("edgeColor")){case"source":m=b.color||g("defaultNodeColor");break;case"target":m=c.color||g("defaultNodeColor");break;default:m=g("defaultEdgeColor")}a.active&&(m="edge"===g("edgeActiveColor")?m||defaultEdgeColor:g("defaultEdgeActiveColor")),m=sigma.utils.floatColor(m),d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=0,d[e++]=m,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=1,d[e++]=m,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=0,d[e++]=m,d[e++]=k,d[e++]=l,d[e++]=i,d[e++]=j,d[e++]=h,d[e++]=0,d[e++]=m,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=1,d[e++]=m,d[e++]=i,d[e++]=j,d[e++]=k,d[e++]=l,d[e++]=h,d[e++]=0,d[e++]=m},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_color"),g=a.getAttribLocation(b,"a_position1"),h=a.getAttribLocation(b,"a_position2"),i=a.getAttribLocation(b,"a_thickness"),j=a.getAttribLocation(b,"a_minus"),k=a.getUniformLocation(b,"u_resolution"),l=a.getUniformLocation(b,"u_matrix"),m=a.getUniformLocation(b,"u_matrixHalfPi"),n=a.getUniformLocation(b,"u_matrixHalfPiMinus"),o=a.getUniformLocation(b,"u_ratio"),p=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW),a.uniform2f(k,d.width,d.height),a.uniform1f(o,d.ratio/Math.pow(d.ratio,d.settings("edgesPowRatio"))),a.uniform1f(p,d.scalingRatio),a.uniformMatrix3fv(l,!1,d.matrix),a.uniformMatrix2fv(m,!1,sigma.utils.matrices.rotation(Math.PI/2,!0)),a.uniformMatrix2fv(n,!1,sigma.utils.matrices.rotation(-Math.PI/2,!0)),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.enableVertexAttribArray(i),a.enableVertexAttribArray(j),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(h,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(i,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16),a.vertexAttribPointer(j,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20),a.vertexAttribPointer(f,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,24),a.drawArrays(a.TRIANGLES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position1;","attribute vec2 a_position2;","attribute float a_thickness;","attribute float a_minus;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","uniform mat2 u_matrixHalfPi;","uniform mat2 u_matrixHalfPiMinus;","varying vec4 color;","void main() {","vec2 position = a_thickness * u_ratio *","normalize(a_position2 - a_position1);","mat2 matrix = a_minus * u_matrixHalfPiMinus +","(1.0 - a_minus) * u_matrixHalfPi;","position = matrix * position + a_position1;","gl_Position = vec4(","((u_matrix * vec3(position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.edges"),sigma.webgl.edges.fast={POINTS:2,ATTRIBUTES:3,addEdge:function(a,b,c,d,e,f,g){var h=((a[f+"size"]||1)/2,b[f+"x"]),i=b[f+"y"],j=c[f+"x"],k=c[f+"y"],l=a.active?a.active_color||g("defaultEdgeActiveColor"):a.color;if(!l)switch(g("edgeColor")){case"source":l=b.color||g("defaultNodeColor");break;case"target":l=c.color||g("defaultNodeColor");break;default:l=g("defaultEdgeColor")}a.active&&(l="edge"===g("edgeActiveColor")?l||defaultEdgeColor:g("defaultEdgeActiveColor")),l=sigma.utils.floatColor(l),d[e++]=h,d[e++]=i,d[e++]=l,d[e++]=j,d[e++]=k,d[e++]=l},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_color"),g=a.getAttribLocation(b,"a_position"),h=a.getUniformLocation(b,"u_resolution"),i=a.getUniformLocation(b,"u_matrix");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.DYNAMIC_DRAW),a.uniform2f(h,d.width,d.height),a.uniformMatrix3fv(i,!1,d.matrix),a.enableVertexAttribArray(g),a.enableVertexAttribArray(f),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(f,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.lineWidth(3),a.drawArrays(a.LINES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position;","attribute float a_color;","uniform vec2 u_resolution;","uniform mat3 u_matrix;","varying vec4 color;","void main() {","gl_Position = vec4(","((u_matrix * vec3(a_position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.nodes"),sigma.webgl.nodes.def={POINTS:3,ATTRIBUTES:12,addNode:function(a,b,c,d,e){var f=this,g=a.color||e("defaultNodeColor"),h=e("imgCrossOrigin")||"anonymous";a.active&&(g="node"===e("nodeActiveColor")?a.active_color||g:e("defaultNodeActiveColor")||g);var i=sigma.utils.floatColor(g||e("defaultNodeColor"));"undefined"==typeof f.spriteSheet&&f.createSpriteSheet(e);var j=-1,k=.7,l=999,m=1,n=1,o=1,p=0;switch(a.type||"circle"){case"circle":case"disc":case"disk":o=1,l=999,k=1;break;case"square":o=0,l=4,k=.7,"undefined"!=typeof a.square&&"number"==typeof a.square.rotate&&(p=a.square.rotate);break;case"diamond":o=0,l=4,k=.7,p=45*Math.PI/180,"undefined"!=typeof a.diamond&&"number"==typeof a.diamond.rotate&&(p=a.diamond.rotate);break;case"triangle":o=0,l=3,k=.5,p=Math.PI,"undefined"!=typeof a.triangle&&"number"==typeof a.triangle.rotate&&(p=a.triangle.rotate);break;case"star":o=1,k=.7,l=5,"undefined"!=typeof a.star&&("number"==typeof a.star.numPoints&&(l=a.star.numPoints),"number"==typeof a.star.rotate&&(p=a.star.rotate));break;case"seastar":o=2,k=.5,l=5,"undefined"!=typeof a.seastar&&("number"==typeof a.seastar.numPoints&&(l=a.seastar.numPoints),"number"==typeof a.seastar.rotate&&(p=a.seastar.rotate));
break;case"equilateral":o=0,l=7,k=.7,p=0,"undefined"!=typeof a.equilateral&&("number"==typeof a.equilateral.numPoints&&(l=a.equilateral.numPoints),"number"==typeof a.equilateral.rotate&&(p=a.equilateral.rotate));break;case"hexagon":o=0,l=6,k=.7,"undefined"!=typeof a.hexagon&&"number"==typeof a.hexagon.rotate&&(p=a.hexagon.rotate);break;case"polygon":o=1,l=5,k=.5,p=0,"undefined"!=typeof a.polygon&&("string"==typeof a.polygon.type&&(o="convex"==a.polygon.type?1:0),"number"==typeof a.polygon.angles&&(l=Math.round(Math.max(3,Math.min(8,a.polygon.angles)))),"number"==typeof a.polygon.scale&&(k=a.polygon.scale||(o?.5:.7)),"number"==typeof a.polygon.rotate&&(p=a.polygon.rotate));break;case"cross":o=0,l=9,k=.1,"undefined"!=typeof a.cross&&("number"==typeof a.cross.lineWeight&&(k=Math.max(.1,Math.min(.5,.1*a.cross.lineWeight))),"number"==typeof a.rotate&&(p=a.cross.rotate))}if("undefined"!=typeof a.image){var q=a.image.url||"";q.length>0&&(j=f.getImage(q,h),m=a.image.w||1,n=a.image.h||1)}if("undefined"!=typeof a.icon){var r="Arial";"string"==typeof a.icon.font&&(r=a.icon.font);var s="";"string"==typeof a.icon.content&&(s=a.icon.content);var t=.7;"number"==typeof a.icon.scale&&(t=.5*Math.abs(Math.max(.01,a.icon.scale)));var u=a.icon.color||g,v=a.color||g,w=.5,x=.5;"number"==typeof a.icon.x&&(w=a.icon.x),"number"==typeof a.icon.y&&(x=a.icon.y),j=f.getText(r,v,u,t,w,x,s)}b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=i,b[c++]=0,b[c++]=o,b[c++]=l,b[c++]=k,b[c++]=p,b[c++]=j,b[c++]=m,b[c++]=n,b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=i,b[c++]=2*Math.PI/3,b[c++]=o,b[c++]=l,b[c++]=k,b[c++]=p,b[c++]=j,b[c++]=m,b[c++]=n,b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"],b[c++]=i,b[c++]=4*Math.PI/3,b[c++]=o,b[c++]=l,b[c++]=k,b[c++]=p,b[c++]=j,b[c++]=m,b[c++]=n},render:function(a,b,c,d){var e,f=this;"undefined"==typeof f.spriteSheet&&f.createSpriteSheet();var g=a.getAttribLocation(b,"a_position"),h=a.getAttribLocation(b,"a_size"),i=a.getAttribLocation(b,"a_color"),j=a.getAttribLocation(b,"a_angle"),k=a.getAttribLocation(b,"a_image"),l=a.getAttribLocation(b,"a_shape"),m=a.getUniformLocation(b,"u_resolution"),n=a.getUniformLocation(b,"u_matrix"),o=a.getUniformLocation(b,"u_ratio"),p=a.getUniformLocation(b,"u_scale"),q=a.getUniformLocation(b,"u_sprite_dim"),r=a.getUniformLocation(b,"u_texture_dim");a.getUniformLocation(b,"u_sampler"),e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.DYNAMIC_DRAW),a.uniform2f(m,d.width,d.height),a.uniform1f(o,1/Math.pow(d.ratio,d.settings("nodesPowRatio"))),a.uniform1f(p,d.scalingRatio),a.uniformMatrix3fv(n,!1,d.matrix),a.uniform2f(q,f.spriteSheet.spriteWidth,f.spriteSheet.spriteHeight),a.uniform2f(r,f.spriteSheet.maxWidth,f.spriteSheet.maxHeight),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.enableVertexAttribArray(i),a.enableVertexAttribArray(j),a.enableVertexAttribArray(l),a.enableVertexAttribArray(k),a.vertexAttribPointer(g,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(h,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(i,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,12),a.vertexAttribPointer(j,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16),a.vertexAttribPointer(l,4,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20),a.vertexAttribPointer(k,3,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,36),"undefined"==typeof f.texture&&(f.texture=a.createTexture(),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,f.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f.spriteSheet.canvas),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),a.enable(a.BLEND),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.generateMipmap(a.TEXTURE_2D)),"undefined"!=typeof f.texture&&(a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,f.texture),f.updateNeeded&&(f.updateNeeded=!1,a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f.spriteSheet.canvas)),a.uniform1i(a.getUniformLocation(b,"u_sampler"),0)),a.drawArrays(a.TRIANGLES,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position;","attribute float a_size;","attribute float a_color;","attribute float a_angle;","attribute vec4 a_shape;","attribute vec3 a_image;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","uniform vec2 u_sprite_dim;","uniform vec2 u_texture_dim;","varying vec4 shape;","varying highp vec4 v_sprite;","varying vec4 color;","varying vec2 center;","varying float radius;","varying vec3 image;","void main() {","radius = a_size * u_ratio;","vec2 position = (u_matrix * vec3(a_position, 1)).xy;","center = position * u_scale;","center = vec2(center.x, u_scale * u_resolution.y - center.y);","position = position +","2.0 * radius * vec2(cos(a_angle), sin(a_angle));","position = (position / u_resolution * 2.0 - 1.0) * vec2(1, -1);","radius = radius * u_scale;","shape = a_shape;","image = a_image;","highp vec2 sp = ","vec2(mod((a_image.s * u_sprite_dim.x), u_texture_dim.x),","floor((a_image.s * u_sprite_dim.x) / u_texture_dim.y) * u_sprite_dim.y);","sp = vec2(sp.x + (u_sprite_dim.x * 0.5),"," sp.y + (u_sprite_dim.y * 0.5));","v_sprite = vec4(","sp.x / u_texture_dim.x,","sp.y / u_texture_dim.y,","u_sprite_dim.x / u_texture_dim.x,","- u_sprite_dim.y / u_texture_dim.y",");","gl_Position = vec4(position, 0, 1);","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["#ifdef GL_ES","precision mediump float;","#endif","#define PI_2 6.283185307179586","#define MAX_ANGLES 8","varying vec4 shape;","varying highp vec4 v_sprite;","varying vec4 color;","varying vec2 center;","varying float radius;","varying vec3 image;","uniform sampler2D u_sampler;","void main(void) {","int angles = int(shape.t);","int convex = int(shape.s);","vec2 m = gl_FragCoord.xy - center;","vec2 p = m.xy/radius;","float theta = atan(p.y,p.x);","vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);","vec4 color1 = (image.s >= 0.0) ?"," texture2D(u_sampler, ","vec2(","(v_sprite.s + v_sprite.p * p.x * 0.5 * image.t),","(v_sprite.t + v_sprite.q * p.y * 0.5 * image.p)","))"," : color",";","mat2 shapeRot = mat2(cos(shape.q),sin(shape.q),-sin(shape.q),cos(shape.q));","p = p * shapeRot;","if (angles > 9) {","gl_FragColor = ","((radius - sqrt(m.x * m.x + m.y * m.y)) > 0.0)","? color1 : color0;","} else if (angles > 8){","gl_FragColor = (","(abs(p.x) > 0.0 && abs(p.x) < (1.0 - sin(shape.p)) && abs(p.y) < shape.p)","|| (abs(p.y) > 0.0 && abs(p.y) < (1.0 - sin(shape.p)) && abs(p.x) < shape.p)",") ? color1 : color0;","} else {","float scale = (convex > 0) ? shape.p * 0.5 : shape.p;","float angle = PI_2 / shape.t;","mat2 t = mat2(cos(angle),sin(angle),-sin(angle),cos(angle));","int q = 0;","for (int i=0;i<MAX_ANGLES;i++) {","if (i >= angles) break;","if (p.y < scale) q++;","p *= t;","}","gl_FragColor =","((convex > 0)","? (q > angles - (angles - 1) / 2)",": (q > angles - 1))","? color1 : color0;","}","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])},createSpriteSheet:function(a){var b=this,c={maxWidth:a("spriteSheetResolution")||2048,maxHeight:a("spriteSheetResolution")||2048,maxSprites:a("spriteSheetMaxSprites")||256},d=c.maxWidth/Math.sqrt(c.maxSprites),e=c.maxHeight/Math.sqrt(c.maxSprites),f=document.createElement("canvas");f.width=c.maxWidth,f.height=c.maxHeight,f.getContext("2d"),b.spriteSheet={canvas:f,maxWidth:c.maxWidth,maxHeight:c.maxHeight,maxSprites:c.maxSprite,spriteWidth:d,spriteHeight:e,currentIndex:1,urlToIndex:{}}},getText:function(a,b,c,d,e,f,g){var h=this,i=Math.round(d*h.spriteSheet.spriteHeight),j=e*h.spriteSheet.spriteWidth,k=f*h.spriteSheet.spriteHeight,l=a+":"+b+":"+c+":"+i+":"+g+":"+j+":"+k;if(l in h.spriteSheet.urlToIndex)return h.spriteSheet.urlToIndex[l];var m=h.spriteSheet.currentIndex;h.spriteSheet.currentIndex+=1,h.spriteSheet.urlToIndex[l]=m;var n=m*h.spriteSheet.spriteWidth%h.spriteSheet.maxWidth,o=Math.floor(m*h.spriteSheet.spriteWidth/h.spriteSheet.maxWidth)*h.spriteSheet.spriteHeight,p=h.spriteSheet.canvas.getContext("2d");return p.beginPath(),p.rect(n,o,h.spriteSheet.spriteWidth,h.spriteSheet.spriteHeight),p.fillStyle=b,p.fill(),p.beginPath(),p.fillStyle=c,p.font=""+i+"px "+a,p.textAlign="center",p.textBaseline="middle",p.fillText(g,n+j,o+k),h.updateNeeded=!0,m},getImage:function(a,b){var c=this,d=c.spriteSheet.canvas.getContext("2d");if(a.length<1)return-1;if(a in c.spriteSheet.urlToIndex)return c.spriteSheet.urlToIndex[a];var e=c.spriteSheet.currentIndex;if(e>c.spriteSheet.maxSprites)return-1;c.spriteSheet.currentIndex+=1,c.spriteSheet.urlToIndex[a]=e;var f=new Image;return f.setAttribute("crossOrigin",b),f.onload=function(){var a=e*c.spriteSheet.spriteWidth%c.spriteSheet.maxWidth,b=Math.floor(e*c.spriteSheet.spriteWidth/c.spriteSheet.maxWidth)*c.spriteSheet.spriteHeight;d.drawImage(f,0,0,f.width,f.height,a,b,c.spriteSheet.spriteWidth,c.spriteSheet.spriteHeight),c.updateNeeded=!0},f.src=a,e}}}(),function(){"use strict";sigma.utils.pkg("sigma.webgl.nodes"),sigma.webgl.nodes.fast={POINTS:1,ATTRIBUTES:4,addNode:function(a,b,c,d,e){var f=a.color||e("defaultNodeColor");a.active&&(f="node"===e("nodeActiveColor")?a.active_color||f:e("defaultNodeActiveColor")||f),f=sigma.utils.floatColor(f||e("defaultNodeColor")),b[c++]=a[d+"x"],b[c++]=a[d+"y"],b[c++]=a[d+"size"]||1,b[c++]=sigma.utils.floatColor(f||e("defaultNodeColor"))},render:function(a,b,c,d){var e,f=a.getAttribLocation(b,"a_position"),g=a.getAttribLocation(b,"a_size"),h=a.getAttribLocation(b,"a_color"),i=a.getUniformLocation(b,"u_resolution"),j=a.getUniformLocation(b,"u_matrix"),k=a.getUniformLocation(b,"u_ratio"),l=a.getUniformLocation(b,"u_scale");e=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,c,a.DYNAMIC_DRAW),a.uniform2f(i,d.width,d.height),a.uniform1f(k,1/Math.pow(d.ratio,d.settings("nodesPowRatio"))),a.uniform1f(l,d.scalingRatio),a.uniformMatrix3fv(j,!1,d.matrix),a.enableVertexAttribArray(f),a.enableVertexAttribArray(g),a.enableVertexAttribArray(h),a.vertexAttribPointer(f,2,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0),a.vertexAttribPointer(g,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8),a.vertexAttribPointer(h,1,a.FLOAT,!1,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,12),a.drawArrays(a.POINTS,d.start||0,d.count||c.length/this.ATTRIBUTES)},initProgram:function(a){var b,c,d;return b=sigma.utils.loadShader(a,["attribute vec2 a_position;","attribute float a_size;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","varying vec4 color;","void main() {","gl_Position = vec4(","((u_matrix * vec3(a_position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","gl_PointSize = a_size * u_ratio * u_scale * 2.0;","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),a.VERTEX_SHADER),c=sigma.utils.loadShader(a,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),a.FRAGMENT_SHADER),d=sigma.utils.loadProgram(a,[b,c])}}}();